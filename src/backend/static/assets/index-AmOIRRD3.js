import{j as p,T as en,S as Rt,D as Ii,r as T,u as hr,a as ga,b as Ps,g as Tl,c as Qu,d as Ju,e as Li,f as Br,_ as Wi,m as ti,h as Zu,i as eh,k as th,l as nh,N as ih,n as rh,o as sh,R as Mt,L as Yt,p as mi,I as Kt,q as ie,B as xe,s as ah,t as _n,O as yt,v as tn,C as oh,w as Zt,Q as Pl,x as Ut,y as Sn,z as ni,A as rn,M as lh,E as ch,F as uh,P as hh,G as dh,H as fh,J as kn,K as ph,U as Xe,V as gh,W as dr,X as ma,Y as mh,Z as zt,$ as Hr,a0 as ya,a1 as yh,a2 as ii,a3 as bh,a4 as xh,a5 as wh,a6 as vh,a7 as ba,a8 as xa,a9 as Ah,aa as _h,ab as Di,ac as Mi,ad as Fi,ae as Ur,af as Oi,ag as Ni,ah as Bt,ai as Sh,aj as kh,ak as Eh,al as wa,am as Ch,an as Th,ao as fr,ap as Nt,aq as Ph,ar as Ct,as as pr,at as Rh,au as va,av as Ih,aw as Rl,ax as Il,ay as Ll,az as Dl,aA as Lh,aB as Dh,aC as Aa,aD as _a,aE as Mh,aF as Fh,aG as Oh,aH as Nh,aI as Sa,aJ as jh,aK as zh,aL as Bh,aM as Hh,aN as Uh,aO as $h,aP as qh,aQ as Vh,aR as Wh,aS as Gh,aT as Xh,aU as Yh,aV as Kh,aW as Qh,aX as Jh,aY as Zh,aZ as ed,a_ as td,a$ as nd,b0 as id,b1 as rd,b2 as sd}from"./fluent-BHNEXxaI.js";import{a as ad,g as Rs}from"./vendor-DavUf6mE.js";import{F as ka}from"./monaco-DHKgAnnO.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Ml="en",Is={},$r={};function Fl(){return Ml}function od(n){Ml=n}function ld(n){return Is[n]}function cd(n){if(!n)throw new Error("No locale data passed");Is[n.locale]=n,$r[n.locale.toLowerCase()]=n.locale}function Ea(n){if(Is[n])return n;if($r[n.toLowerCase()])return $r[n.toLowerCase()]}function Ol(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.localeMatcher||"lookup";switch(t){case"lookup":return Ca(n);case"best fit":return Ca(n);default:throw new RangeError('Invalid "localeMatcher" option: '.concat(t))}}function Ca(n){var e=Ea(n);if(e)return e;for(var t=n.split("-");n.length>1;){t.pop(),n=t.join("-");var i=Ea(n);if(i)return i}}var C={af:function(e){return e==1?"one":"other"},am:function(e){return e>=0&&e<=1?"one":"other"},ar:function(e){var t=String(e).split("."),i=Number(t[0])==e,r=i&&t[0].slice(-2);return e==0?"zero":e==1?"one":e==2?"two":r>=3&&r<=10?"few":r>=11&&r<=99?"many":"other"},ast:function(e){var t=String(e).split("."),i=!t[1];return e==1&&i?"one":"other"},be:function(e){var t=String(e).split("."),i=Number(t[0])==e,r=i&&t[0].slice(-1),s=i&&t[0].slice(-2);return r==1&&s!=11?"one":r>=2&&r<=4&&(s<12||s>14)?"few":i&&r==0||r>=5&&r<=9||s>=11&&s<=14?"many":"other"},br:function(e){var t=String(e).split("."),i=Number(t[0])==e,r=i&&t[0].slice(-1),s=i&&t[0].slice(-2),a=i&&t[0].slice(-6);return r==1&&s!=11&&s!=71&&s!=91?"one":r==2&&s!=12&&s!=72&&s!=92?"two":(r==3||r==4||r==9)&&(s<10||s>19)&&(s<70||s>79)&&(s<90||s>99)?"few":e!=0&&i&&a==0?"many":"other"},bs:function(e){var t=String(e).split("."),i=t[0],r=t[1]||"",s=!t[1],a=i.slice(-1),o=i.slice(-2),l=r.slice(-1),c=r.slice(-2);return s&&a==1&&o!=11||l==1&&c!=11?"one":s&&a>=2&&a<=4&&(o<12||o>14)||l>=2&&l<=4&&(c<12||c>14)?"few":"other"},ca:function(e){var t=String(e).split("."),i=t[0],r=!t[1],s=i.slice(-6);return e==1&&r?"one":i!=0&&s==0&&r?"many":"other"},ceb:function(e){var t=String(e).split("."),i=t[0],r=t[1]||"",s=!t[1],a=i.slice(-1),o=r.slice(-1);return s&&(i==1||i==2||i==3)||s&&a!=4&&a!=6&&a!=9||!s&&o!=4&&o!=6&&o!=9?"one":"other"},cs:function(e){var t=String(e).split("."),i=t[0],r=!t[1];return e==1&&r?"one":i>=2&&i<=4&&r?"few":r?"other":"many"},cy:function(e){return e==0?"zero":e==1?"one":e==2?"two":e==3?"few":e==6?"many":"other"},da:function(e){var t=String(e).split("."),i=t[0],r=Number(t[0])==e;return e==1||!r&&(i==0||i==1)?"one":"other"},dsb:function(e){var t=String(e).split("."),i=t[0],r=t[1]||"",s=!t[1],a=i.slice(-2),o=r.slice(-2);return s&&a==1||o==1?"one":s&&a==2||o==2?"two":s&&(a==3||a==4)||o==3||o==4?"few":"other"},dz:function(e){return"other"},es:function(e){var t=String(e).split("."),i=t[0],r=!t[1],s=i.slice(-6);return e==1?"one":i!=0&&s==0&&r?"many":"other"},ff:function(e){return e>=0&&e<2?"one":"other"},fr:function(e){var t=String(e).split("."),i=t[0],r=!t[1],s=i.slice(-6);return e>=0&&e<2?"one":i!=0&&s==0&&r?"many":"other"},ga:function(e){var t=String(e).split("."),i=Number(t[0])==e;return e==1?"one":e==2?"two":i&&e>=3&&e<=6?"few":i&&e>=7&&e<=10?"many":"other"},gd:function(e){var t=String(e).split("."),i=Number(t[0])==e;return e==1||e==11?"one":e==2||e==12?"two":i&&e>=3&&e<=10||i&&e>=13&&e<=19?"few":"other"},he:function(e){var t=String(e).split("."),i=t[0],r=!t[1];return i==1&&r||i==0&&!r?"one":i==2&&r?"two":"other"},is:function(e){var t=String(e).split("."),i=t[0],r=(t[1]||"").replace(/0+$/,""),s=Number(t[0])==e,a=i.slice(-1),o=i.slice(-2);return s&&a==1&&o!=11||r%10==1&&r%100!=11?"one":"other"},ksh:function(e){return e==0?"zero":e==1?"one":"other"},lt:function(e){var t=String(e).split("."),i=t[1]||"",r=Number(t[0])==e,s=r&&t[0].slice(-1),a=r&&t[0].slice(-2);return s==1&&(a<11||a>19)?"one":s>=2&&s<=9&&(a<11||a>19)?"few":i!=0?"many":"other"},lv:function(e){var t=String(e).split("."),i=t[1]||"",r=i.length,s=Number(t[0])==e,a=s&&t[0].slice(-1),o=s&&t[0].slice(-2),l=i.slice(-2),c=i.slice(-1);return s&&a==0||o>=11&&o<=19||r==2&&l>=11&&l<=19?"zero":a==1&&o!=11||r==2&&c==1&&l!=11||r!=2&&c==1?"one":"other"},mk:function(e){var t=String(e).split("."),i=t[0],r=t[1]||"",s=!t[1],a=i.slice(-1),o=i.slice(-2),l=r.slice(-1),c=r.slice(-2);return s&&a==1&&o!=11||l==1&&c!=11?"one":"other"},mt:function(e){var t=String(e).split("."),i=Number(t[0])==e,r=i&&t[0].slice(-2);return e==1?"one":e==2?"two":e==0||r>=3&&r<=10?"few":r>=11&&r<=19?"many":"other"},pa:function(e){return e==0||e==1?"one":"other"},pl:function(e){var t=String(e).split("."),i=t[0],r=!t[1],s=i.slice(-1),a=i.slice(-2);return e==1&&r?"one":r&&s>=2&&s<=4&&(a<12||a>14)?"few":r&&i!=1&&(s==0||s==1)||r&&s>=5&&s<=9||r&&a>=12&&a<=14?"many":"other"},pt:function(e){var t=String(e).split("."),i=t[0],r=!t[1],s=i.slice(-6);return i==0||i==1?"one":i!=0&&s==0&&r?"many":"other"},ro:function(e){var t=String(e).split("."),i=!t[1],r=Number(t[0])==e,s=r&&t[0].slice(-2);return e==1&&i?"one":!i||e==0||e!=1&&s>=1&&s<=19?"few":"other"},ru:function(e){var t=String(e).split("."),i=t[0],r=!t[1],s=i.slice(-1),a=i.slice(-2);return r&&s==1&&a!=11?"one":r&&s>=2&&s<=4&&(a<12||a>14)?"few":r&&s==0||r&&s>=5&&s<=9||r&&a>=11&&a<=14?"many":"other"},se:function(e){return e==1?"one":e==2?"two":"other"},si:function(e){var t=String(e).split("."),i=t[0],r=t[1]||"";return e==0||e==1||i==0&&r==1?"one":"other"},sl:function(e){var t=String(e).split("."),i=t[0],r=!t[1],s=i.slice(-2);return r&&s==1?"one":r&&s==2?"two":r&&(s==3||s==4)||!r?"few":"other"}};C.as=C.am;C.az=C.af;C.bg=C.af;C.bn=C.am;C.brx=C.af;C.ce=C.af;C.chr=C.af;C.de=C.ast;C.ee=C.af;C.el=C.af;C.en=C.ast;C.et=C.ast;C.eu=C.af;C.fa=C.am;C.fi=C.ast;C.fil=C.ceb;C.fo=C.af;C.fur=C.af;C.fy=C.ast;C.gl=C.ast;C.gu=C.am;C.ha=C.af;C.hi=C.am;C.hr=C.bs;C.hsb=C.dsb;C.hu=C.af;C.hy=C.ff;C.ia=C.ast;C.id=C.dz;C.ig=C.dz;C.it=C.ca;C.ja=C.dz;C.jgo=C.af;C.jv=C.dz;C.ka=C.af;C.kea=C.dz;C.kk=C.af;C.kl=C.af;C.km=C.dz;C.kn=C.am;C.ko=C.dz;C.ks=C.af;C.ku=C.af;C.ky=C.af;C.lb=C.af;C.lkt=C.dz;C.lo=C.dz;C.ml=C.af;C.mn=C.af;C.mr=C.af;C.ms=C.dz;C.my=C.dz;C.nb=C.af;C.ne=C.af;C.nl=C.ast;C.nn=C.af;C.no=C.af;C.or=C.af;C.pcm=C.am;C.ps=C.af;C.rm=C.af;C.sah=C.dz;C.sc=C.ast;C.sd=C.af;C.sk=C.cs;C.so=C.af;C.sq=C.af;C.sr=C.bs;C.su=C.dz;C.sv=C.ast;C.sw=C.ast;C.ta=C.af;C.te=C.af;C.th=C.dz;C.ti=C.pa;C.tk=C.af;C.to=C.dz;C.tr=C.af;C.ug=C.af;C.uk=C.ru;C.ur=C.ast;C.uz=C.af;C.vi=C.dz;C.wae=C.af;C.wo=C.dz;C.xh=C.af;C.yi=C.ast;C.yo=C.dz;C.yue=C.dz;C.zh=C.dz;C.zu=C.am;function Ta(n){return n==="pt-PT"?n:hd(n)}var ud=/^([a-z0-9]+)/i;function hd(n){var e=n.match(ud);if(!e)throw new TypeError("Invalid locale: ".concat(n));return e[1]}function dd(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Pa(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function fd(n,e,t){return e&&Pa(n.prototype,e),t&&Pa(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}var qr=function(){function n(e,t){dd(this,n);var i=n.supportedLocalesOf(e);if(i.length===0)throw new RangeError("Unsupported locale: "+e);if(t&&t.type!=="cardinal")throw new RangeError('Only "cardinal" "type" is supported');this.$=C[Ta(i[0])]}return fd(n,[{key:"select",value:function(t){return this.$(t)}}],[{key:"supportedLocalesOf",value:function(t){return typeof t=="string"&&(t=[t]),t.filter(function(i){return C[Ta(i)]})}}]),n}();function Vr(n){"@babel/helpers - typeof";return Vr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vr(n)}function Ra(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ia(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ra(Object(t),!0).forEach(function(i){pd(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ra(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function pd(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function La(n,e){return bd(n)||yd(n,e)||md(n,e)||gd()}function gd(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function md(n,e){if(n){if(typeof n=="string")return Da(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Da(n,e)}}function Da(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function yd(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],r=!0,s=!1,a,o;try{for(t=t.call(n);!(r=(a=t.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(l){s=!0,o=l}finally{try{!r&&t.return!=null&&t.return()}finally{if(s)throw o}}return i}}function bd(n){if(Array.isArray(n))return n}function xd(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function wd(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function vd(n,e,t){return e&&wd(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}var Ad=["second","minute","hour","day","week","month","quarter","year"],_d=["auto","always"],Sd=["long","short","narrow"],kd=["lookup","best fit"],$t=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};xd(this,n);var i=t.numeric,r=t.style,s=t.localeMatcher;if(this.numeric="always",this.style="long",this.localeMatcher="lookup",i!==void 0){if(_d.indexOf(i)<0)throw new RangeError('Invalid "numeric" option: '.concat(i));this.numeric=i}if(r!==void 0){if(Sd.indexOf(r)<0)throw new RangeError('Invalid "style" option: '.concat(r));this.style=r}if(s!==void 0){if(kd.indexOf(s)<0)throw new RangeError('Invalid "localeMatcher" option: '.concat(s));this.localeMatcher=s}if(typeof e=="string"&&(e=[e]),e.push(Fl()),this.locale=n.supportedLocalesOf(e,{localeMatcher:this.localeMatcher})[0],!this.locale)throw new Error("No supported locale was found");qr.supportedLocalesOf(this.locale).length>0?this.pluralRules=new qr(this.locale):console.warn('"'.concat(this.locale,'" locale is not supported')),typeof Intl<"u"&&Intl.NumberFormat?(this.numberFormat=new Intl.NumberFormat(this.locale),this.numberingSystem=this.numberFormat.resolvedOptions().numberingSystem):this.numberingSystem="latn",this.locale=Ol(this.locale,{localeMatcher:this.localeMatcher})}return vd(n,[{key:"format",value:function(){var t=Ma(arguments),i=La(t,2),r=i[0],s=i[1];return this.getRule(r,s).replace("{0}",this.formatNumber(Math.abs(r)))}},{key:"formatToParts",value:function(){var t=Ma(arguments),i=La(t,2),r=i[0],s=i[1],a=this.getRule(r,s),o=a.indexOf("{0}");if(o<0)return[{type:"literal",value:a}];var l=[];return o>0&&l.push({type:"literal",value:a.slice(0,o)}),l=l.concat(this.formatNumberToParts(Math.abs(r)).map(function(c){return Ia(Ia({},c),{},{unit:s})})),o+3<a.length-1&&l.push({type:"literal",value:a.slice(o+3)}),l}},{key:"getRule",value:function(t,i){var r=ld(this.locale)[this.style][i];if(typeof r=="string")return r;if(this.numeric==="auto"){if(t===-2||t===-1){var s=r["previous".concat(t===-1?"":"-"+Math.abs(t))];if(s)return s}else if(t===1||t===2){var a=r["next".concat(t===1?"":"-"+Math.abs(t))];if(a)return a}else if(t===0&&r.current)return r.current}var o=r[Rd(t)?"past":"future"];if(typeof o=="string")return o;var l=this.pluralRules&&this.pluralRules.select(Math.abs(t))||"other";return o[l]||o.other}},{key:"formatNumber",value:function(t){return this.numberFormat?this.numberFormat.format(t):String(t)}},{key:"formatNumberToParts",value:function(t){return this.numberFormat&&this.numberFormat.formatToParts?this.numberFormat.formatToParts(t):[{type:"integer",value:this.formatNumber(t)}]}},{key:"resolvedOptions",value:function(){return{locale:this.locale,style:this.style,numeric:this.numeric,numberingSystem:this.numberingSystem}}}]),n}();$t.supportedLocalesOf=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="string")n=[n];else if(!Array.isArray(n))throw new TypeError('Invalid "locales" argument');return n.filter(function(t){return Ol(t,e)})};$t.addLocale=cd;$t.setDefaultLocale=od;$t.getDefaultLocale=Fl;$t.PluralRules=qr;var gr='Invalid "unit" argument';function Ed(n){if(Vr(n)==="symbol")throw new TypeError(gr);if(typeof n!="string")throw new RangeError("".concat(gr,": ").concat(n));if(n[n.length-1]==="s"&&(n=n.slice(0,n.length-1)),Ad.indexOf(n)<0)throw new RangeError("".concat(gr,": ").concat(n));return n}var Cd='Invalid "number" argument';function Td(n){if(n=Number(n),Number.isFinite&&!Number.isFinite(n))throw new RangeError("".concat(Cd,": ").concat(n));return n}function Pd(n){return 1/n===-1/0}function Rd(n){return n<0||n===0&&Pd(n)}function Ma(n){if(n.length<2)throw new TypeError('"unit" argument is required');return[Td(n[0]),Ed(n[1])]}function ji(n){"@babel/helpers - typeof";return ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ji(n)}function Id(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Ld(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Dd(n,e,t){return e&&Ld(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}var Fa=function(){function n(){Id(this,n),this.cache={}}return Dd(n,[{key:"get",value:function(){for(var t=this.cache,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];for(var a=0,o=r;a<o.length;a++){var l=o[a];if(ji(t)!=="object")return;t=t[l]}return t}},{key:"put",value:function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];for(var s=i.pop(),a=i.pop(),o=this.cache,l=0,c=i;l<c.length;l++){var u=c[l];ji(o[u])!=="object"&&(o[u]={}),o=o[u]}return o[a]=s}}]),n}();function Wr(n){"@babel/helpers - typeof";return Wr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wr(n)}function Md(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=Fd(n))||e){t&&(n=t);var i=0;return function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fd(n,e){if(n){if(typeof n=="string")return Oa(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Oa(n,e)}}function Oa(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function Od(n,e){for(var t=Md(n),i;!(i=t()).done;){var r=i.value;if(e(r))return r;for(var s=r.split("-");s.length>1;)if(s.pop(),r=s.join("-"),e(r))return r}throw new Error("No locale data has been registered for any of the locales: ".concat(n.join(", ")))}function Nd(){var n=(typeof Intl>"u"?"undefined":Wr(Intl))==="object";return n&&typeof Intl.DateTimeFormat=="function"}function Gr(n){"@babel/helpers - typeof";return Gr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gr(n)}function jd(n){return Bd(n)&&(Array.isArray(n.steps)||Array.isArray(n.gradation)||Array.isArray(n.flavour)||typeof n.flavour=="string"||Array.isArray(n.labels)||typeof n.labels=="string"||Array.isArray(n.units)||typeof n.custom=="function")}var zd={}.constructor;function Bd(n){return Gr(n)!==void 0&&n!==null&&n.constructor===zd}var Dt=60,zi=60*Dt,sn=24*zi,Xr=7*sn,Yr=30.44*sn,Nl=146097/400*sn;function En(n){switch(n){case"second":return 1;case"minute":return Dt;case"hour":return zi;case"day":return sn;case"week":return Xr;case"month":return Yr;case"year":return Nl}}function jl(n){return n.factor!==void 0?n.factor:En(n.unit||n.formatAs)||1}function ri(n){switch(n){case"floor":return Math.floor;default:return Math.round}}function Ls(n){switch(n){case"floor":return 1;default:return .5}}function Kr(n){"@babel/helpers - typeof";return Kr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kr(n)}function zl(n,e){var t=e.prevStep,i=e.timestamp,r=e.now,s=e.future,a=e.round,o;return t&&(t.id||t.unit)&&(o=n["threshold_for_".concat(t.id||t.unit)]),o===void 0&&n.threshold!==void 0&&(o=n.threshold,typeof o=="function"&&(o=o(r,s))),o===void 0&&(o=n.minTime),Kr(o)==="object"&&(t&&t.id&&o[t.id]!==void 0?o=o[t.id]:o=o.default),typeof o=="function"&&(o=o(i,{future:s,getMinTimeForUnit:function(c,u){return Na(c,u||t&&t.formatAs,{round:a})}})),o===void 0&&n.test&&(n.test(i,{now:r,future:s})?o=0:o=9007199254740991),o===void 0&&(t?n.formatAs&&t.formatAs&&(o=Na(n.formatAs,t.formatAs,{round:a})):o=0),o===void 0&&console.warn("[javascript-time-ago] A step should specify `minTime`:\n"+JSON.stringify(n,null,2)),o}function Na(n,e,t){var i=t.round,r=En(n),s;if(e==="now"?s=En(n):s=En(e),r!==void 0&&s!==void 0)return r-s*(1-Ls(i))}function ja(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Hd(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ja(Object(t),!0).forEach(function(i){Ud(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ja(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Ud(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $d(n,e,t){var i=t.now,r=t.future,s=t.round,a=t.units;n=Vd(n,a);var o=qd(n,e,{now:i,future:r,round:s});{if(o){var l=n[n.indexOf(o)-1],c=n[n.indexOf(o)+1];return[l,o,c]}return[void 0,void 0,n[0]]}}function qd(n,e,t){var i=t.now,r=t.future,s=t.round;if(n.length!==0){var a=Bl(n,e,{now:i,future:r||e<0,round:s});if(a!==-1){var o=n[a];if(o.granularity){var l=ri(s)(Math.abs(e)/jl(o)/o.granularity)*o.granularity;if(l===0&&a>0)return n[a-1]}return o}}}function Bl(n,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=zl(n[i],Hd({prevStep:n[i-1],timestamp:t.now-e*1e3},t));return r===void 0||Math.abs(e)<r?i-1:i===n.length-1?i:Bl(n,e,t,i+1)}function Vd(n,e){return n.filter(function(t){var i=t.unit,r=t.formatAs;return i=i||r,i?e.indexOf(i)>=0:!0})}function Wd(n,e,t){var i=t.now,r=t.round;if(En(n)){var s=En(n)*1e3,a=e>i,o=Math.abs(e-i),l=ri(r)(o/s)*s;return a?l>0?o-l+Xd(r,s):o-l+1:-(o-l)+Gd(r,s)}}function Gd(n,e){return Ls(n)*e}function Xd(n,e){return(1-Ls(n))*e+1}var Yd=365*24*60*60*1e3,Hl=1e3*Yd;function Kd(n,e,t){var i=t.prevStep,r=t.nextStep,s=t.now,a=t.future,o=t.round,l=n.getTime?n.getTime():n,c=function(g){return Wd(g,l,{now:s,round:o})},u=Jd(a?e:r,l,{future:a,now:s,round:o,prevStep:a?i:e});if(u!==void 0){var h;if(e&&(e.getTimeToNextUpdate&&(h=e.getTimeToNextUpdate(l,{getTimeToNextUpdateForUnit:c,getRoundFunction:ri,now:s,future:a,round:o})),h===void 0)){var d=e.unit||e.formatAs;d&&(h=c(d))}return h===void 0?u:Math.min(h,u)}}function Qd(n,e,t){var i=t.now,r=t.future,s=t.round,a=t.prevStep,o=zl(n,{timestamp:e,now:i,future:r,round:s,prevStep:a});if(o!==void 0)return r?e-o*1e3+1:o===0&&e===i?Hl:e+o*1e3}function Jd(n,e,t){var i=t.now,r=t.future,s=t.round,a=t.prevStep;if(n){var o=Qd(n,e,{now:i,future:r,round:s,prevStep:a});return o===void 0?void 0:o-i}else return r?e-i+1:Hl}var Ul={};function vn(n){return Ul[n]}function $l(n){if(!n)throw new Error("[javascript-time-ago] No locale data passed.");Ul[n.locale]=n}const Zd=[{formatAs:"now"},{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"},{formatAs:"day"},{formatAs:"week"},{formatAs:"month"},{formatAs:"year"}],Qr={steps:Zd,labels:"long"};function za(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ba(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?za(Object(t),!0).forEach(function(i){ef(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):za(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function ef(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Jr=Ba(Ba({},Qr),{},{steps:Qr.steps.filter(function(n){return n.formatAs!=="second"})}),ql=[{factor:1,unit:"now"},{threshold:1,threshold_for_now:45.5,factor:1,unit:"second"},{threshold:45.5,factor:Dt,unit:"minute"},{threshold:2.5*Dt,granularity:5,factor:Dt,unit:"minute"},{threshold:22.5*Dt,factor:.5*zi,unit:"half-hour"},{threshold:42.5*Dt,threshold_for_minute:52.5*Dt,factor:zi,unit:"hour"},{threshold:20.5/24*sn,factor:sn,unit:"day"},{threshold:5.5*sn,factor:Xr,unit:"week"},{threshold:3.5*Xr,factor:Yr,unit:"month"},{threshold:10.5*Yr,factor:Nl,unit:"year"}],Ha={gradation:ql,flavour:"long",units:["now","minute","hour","day","week","month","year"]},tf={gradation:ql,flavour:"long-time",units:["now","minute","hour","day","week","month","year"]};function Vl(n){return n instanceof Date?n:new Date(n)}var Zr=[{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"}],At={},nf={minTime:function(e,t){t.future;var i=t.getMinTimeForUnit;return i("day")},format:function(e,t){return At[t]||(At[t]={}),At[t].dayMonth||(At[t].dayMonth=new Intl.DateTimeFormat(t,{month:"short",day:"numeric"})),At[t].dayMonth.format(Vl(e))}},rf={minTime:function(e,t){var i=t.future;if(i){var r=new Date(new Date(e).getFullYear(),0).getTime()-1;return(e-r)/1e3}else{var s=new Date(new Date(e).getFullYear()+1,0).getTime();return(s-e)/1e3}},format:function(e,t){return At[t]||(At[t]={}),At[t].dayMonthYear||(At[t].dayMonthYear=new Intl.DateTimeFormat(t,{year:"numeric",month:"short",day:"numeric"})),At[t].dayMonthYear.format(Vl(e))}};Nd()?Zr.push(nf,rf):Zr.push({formatAs:"day"},{formatAs:"week"},{formatAs:"month"},{formatAs:"year"});const on={steps:Zr,labels:["mini","short-time","narrow","short"]};function Ua(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function $a(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ua(Object(t),!0).forEach(function(i){sf(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ua(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function sf(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const af=$a($a({},on),{},{steps:[{formatAs:"now"}].concat(on.steps)});function qa(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Va(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qa(Object(t),!0).forEach(function(i){of(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qa(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function of(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const es=Va(Va({},on),{},{steps:on.steps.filter(function(n){return n.formatAs!=="second"})});function Wa(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ga(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wa(Object(t),!0).forEach(function(i){lf(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Wa(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function lf(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const cf=Ga(Ga({},es),{},{steps:[{formatAs:"now"}].concat(es.steps)});function Xa(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function yi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Xa(Object(t),!0).forEach(function(i){uf(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Xa(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function uf(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const hf=yi(yi({},on),{},{steps:on.steps.filter(function(n){return n.formatAs!=="second"}).map(function(n){return n.formatAs==="minute"?yi(yi({},n),{},{minTime:Dt}):n})}),si={steps:[{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"},{formatAs:"day"},{formatAs:"month"},{formatAs:"year"}],labels:["mini","short-time","narrow","short"]};function Ya(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ka(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ya(Object(t),!0).forEach(function(i){df(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ya(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function df(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const ff=Ka(Ka({},si),{},{steps:[{formatAs:"now"}].concat(si.steps)});function Qa(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ja(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qa(Object(t),!0).forEach(function(i){pf(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Qa(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function pf(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const ts=Ja(Ja({},si),{},{steps:si.steps.filter(function(n){return n.formatAs!=="second"})});function Za(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function eo(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Za(Object(t),!0).forEach(function(i){gf(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Za(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function gf(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const mf=eo(eo({},ts),{},{steps:[{formatAs:"now"}].concat(ts.steps)});function yf(n){switch(n){case"default":case"round":return Qr;case"round-minute":return Jr;case"approximate":return Ha;case"time":case"approximate-time":return tf;case"mini":return si;case"mini-now":return ff;case"mini-minute":return ts;case"mini-minute-now":return mf;case"twitter":return on;case"twitter-now":return af;case"twitter-minute":return es;case"twitter-minute-now":return cf;case"twitter-first-minute":return hf;default:return Ha}}function Bi(n){"@babel/helpers - typeof";return Bi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bi(n)}function bf(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=Wl(n))||e){t&&(n=t);var i=0;return function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xf(n,e){return Af(n)||vf(n,e)||Wl(n,e)||wf()}function wf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wl(n,e){if(n){if(typeof n=="string")return to(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return to(n,e)}}function to(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function vf(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],r=!0,s=!1,a,o;try{for(t=t.call(n);!(r=(a=t.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(l){s=!0,o=l}finally{try{!r&&t.return!=null&&t.return()}finally{if(s)throw o}}return i}}function Af(n){if(Array.isArray(n))return n}function _f(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Sf(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function kf(n,e,t){return e&&Sf(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}var _t=function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.polyfill;_f(this,n),typeof e=="string"&&(e=[e]),this.locale=Od(e.concat(n.getDefaultLocale()),vn),typeof Intl<"u"&&Intl.NumberFormat&&(this.numberFormat=new Intl.NumberFormat(this.locale)),i===!1?(this.IntlRelativeTimeFormat=Intl.RelativeTimeFormat,this.IntlPluralRules=Intl.PluralRules):(this.IntlRelativeTimeFormat=$t,this.IntlPluralRules=$t.PluralRules),this.relativeTimeFormatCache=new Fa,this.pluralRulesCache=new Fa}return kf(n,[{key:"format",value:function(t,i,r){r||(i&&!Rf(i)?(r=i,i=void 0):r={}),i||(i=Jr),typeof i=="string"&&(i=yf(i));var s=Ef(t),a=this.getLabels(i.flavour||i.labels),o=a.labels,l=a.labelsType,c;i.now!==void 0&&(c=i.now),c===void 0&&r.now!==void 0&&(c=r.now),c===void 0&&(c=Date.now());var u=(c-s)/1e3,h=r.future||u<0,d=Pf(o,vn(this.locale).now,vn(this.locale).long,h);if(i.custom){var f=i.custom({now:c,date:new Date(s),time:s,elapsed:u,locale:this.locale});if(f!==void 0)return f}var g=Tf(i.units,o,d),m=r.round||i.round,b=$d(i.gradation||i.steps||Jr.steps,u,{now:c,units:g,round:m,future:h}),y=xf(b,3),x=y[0],A=y[1],k=y[2],E=this.formatDateForStep(s,A,u,{labels:o,labelsType:l,nowLabel:d,now:c,future:h,round:m})||"";if(r.getTimeToNextUpdate){var _=Kd(s,A,{nextStep:k,prevStep:x,now:c,future:h,round:m});return[E,_]}return E}},{key:"formatDateForStep",value:function(t,i,r,s){var a=this,o=s.labels,l=s.labelsType,c=s.nowLabel,u=s.now,h=s.future,d=s.round;if(i){if(i.format)return i.format(t,this.locale,{formatAs:function(y,x){return a.formatValue(x,y,{labels:o,future:h})},now:u,future:h});var f=i.unit||i.formatAs;if(!f)throw new Error("[javascript-time-ago] Each step must define either `formatAs` or `format()`. Step: ".concat(JSON.stringify(i)));if(f==="now")return c;var g=Math.abs(r)/jl(i);i.granularity&&(g=ri(d)(g/i.granularity)*i.granularity);var m=-1*Math.sign(r)*ri(d)(g);switch(m===0&&(h?m=0:m=-0),l){case"long":case"short":case"narrow":return this.getFormatter(l).format(m,f);default:return this.formatValue(m,f,{labels:o,future:h})}}}},{key:"formatValue",value:function(t,i,r){var s=r.labels,a=r.future;return this.getFormattingRule(s,i,t,{future:a}).replace("{0}",this.formatNumber(Math.abs(t)))}},{key:"getFormattingRule",value:function(t,i,r,s){var a=s.future;if(this.locale,t=t[i],typeof t=="string")return t;var o=r===0?a?"future":"past":r<0?"past":"future",l=t[o]||t;if(typeof l=="string")return l;var c=this.getPluralRules().select(Math.abs(r));return l[c]||l.other}},{key:"formatNumber",value:function(t){return this.numberFormat?this.numberFormat.format(t):String(t)}},{key:"getFormatter",value:function(t){return this.relativeTimeFormatCache.get(this.locale,t)||this.relativeTimeFormatCache.put(this.locale,t,new this.IntlRelativeTimeFormat(this.locale,{style:t}))}},{key:"getPluralRules",value:function(){return this.pluralRulesCache.get(this.locale)||this.pluralRulesCache.put(this.locale,new this.IntlPluralRules(this.locale))}},{key:"getLabels",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];typeof t=="string"&&(t=[t]),t=t.map(function(o){switch(o){case"tiny":case"mini-time":return"mini";default:return o}}),t=t.concat("long");for(var i=vn(this.locale),r=bf(t),s;!(s=r()).done;){var a=s.value;if(i[a])return{labelsType:a,labels:i[a]}}}}]),n}(),Gl="en";_t.getDefaultLocale=function(){return Gl};_t.setDefaultLocale=function(n){return Gl=n};_t.addDefaultLocale=function(n){if(no)return console.error("[javascript-time-ago] `TimeAgo.addDefaultLocale()` can only be called once. To add other locales, use `TimeAgo.addLocale()`.");no=!0,_t.setDefaultLocale(n.locale),_t.addLocale(n)};var no;_t.addLocale=function(n){$l(n),$t.addLocale(n)};_t.locale=_t.addLocale;_t.addLabels=function(n,e,t){var i=vn(n);i||($l({locale:n}),i=vn(n)),i[e]=t};function Ef(n){if(n.constructor===Date||Cf(n))return n.getTime();if(typeof n=="number")return n;throw new Error("Unsupported relative time formatter input: ".concat(Bi(n),", ").concat(n))}function Cf(n){return Bi(n)==="object"&&typeof n.getTime=="function"}function Tf(n,e,t){var i=Object.keys(e);return t&&i.push("now"),n&&(i=n.filter(function(r){return r==="now"||i.indexOf(r)>=0})),i}function Pf(n,e,t,i){var r=n.now||e&&e.now;if(r)return typeof r=="string"?r:i?r.future:r.past;if(t&&t.second&&t.second.current)return t.second.current}function Rf(n){return typeof n=="string"||jd(n)}const If={locale:"en",long:{year:{previous:"last year",current:"this year",next:"next year",past:{one:"{0} year ago",other:"{0} years ago"},future:{one:"in {0} year",other:"in {0} years"}},quarter:{previous:"last quarter",current:"this quarter",next:"next quarter",past:{one:"{0} quarter ago",other:"{0} quarters ago"},future:{one:"in {0} quarter",other:"in {0} quarters"}},month:{previous:"last month",current:"this month",next:"next month",past:{one:"{0} month ago",other:"{0} months ago"},future:{one:"in {0} month",other:"in {0} months"}},week:{previous:"last week",current:"this week",next:"next week",past:{one:"{0} week ago",other:"{0} weeks ago"},future:{one:"in {0} week",other:"in {0} weeks"}},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"{0} day ago",other:"{0} days ago"},future:{one:"in {0} day",other:"in {0} days"}},hour:{current:"this hour",past:{one:"{0} hour ago",other:"{0} hours ago"},future:{one:"in {0} hour",other:"in {0} hours"}},minute:{current:"this minute",past:{one:"{0} minute ago",other:"{0} minutes ago"},future:{one:"in {0} minute",other:"in {0} minutes"}},second:{current:"now",past:{one:"{0} second ago",other:"{0} seconds ago"},future:{one:"in {0} second",other:"in {0} seconds"}}},short:{year:{previous:"last yr.",current:"this yr.",next:"next yr.",past:"{0} yr. ago",future:"in {0} yr."},quarter:{previous:"last qtr.",current:"this qtr.",next:"next qtr.",past:{one:"{0} qtr. ago",other:"{0} qtrs. ago"},future:{one:"in {0} qtr.",other:"in {0} qtrs."}},month:{previous:"last mo.",current:"this mo.",next:"next mo.",past:"{0} mo. ago",future:"in {0} mo."},week:{previous:"last wk.",current:"this wk.",next:"next wk.",past:"{0} wk. ago",future:"in {0} wk."},day:{previous:"yesterday",current:"today",next:"tomorrow",past:{one:"{0} day ago",other:"{0} days ago"},future:{one:"in {0} day",other:"in {0} days"}},hour:{current:"this hour",past:"{0} hr. ago",future:"in {0} hr."},minute:{current:"this minute",past:"{0} min. ago",future:"in {0} min."},second:{current:"now",past:"{0} sec. ago",future:"in {0} sec."}},narrow:{year:{previous:"last yr.",current:"this yr.",next:"next yr.",past:"{0}y ago",future:"in {0}y"},quarter:{previous:"last qtr.",current:"this qtr.",next:"next qtr.",past:"{0}q ago",future:"in {0}q"},month:{previous:"last mo.",current:"this mo.",next:"next mo.",past:"{0}mo ago",future:"in {0}mo"},week:{previous:"last wk.",current:"this wk.",next:"next wk.",past:"{0}w ago",future:"in {0}w"},day:{previous:"yesterday",current:"today",next:"tomorrow",past:"{0}d ago",future:"in {0}d"},hour:{current:"this hour",past:"{0}h ago",future:"in {0}h"},minute:{current:"this minute",past:"{0}m ago",future:"in {0}m"},second:{current:"now",past:"{0}s ago",future:"in {0}s"}},now:{now:{current:"now",future:"in a moment",past:"just now"}},mini:{year:"{0}yr",month:"{0}mo",week:"{0}wk",day:"{0}d",hour:"{0}h",minute:"{0}m",second:"{0}s",now:"now"},"short-time":{year:"{0} yr.",month:"{0} mo.",week:"{0} wk.",day:{one:"{0} day",other:"{0} days"},hour:"{0} hr.",minute:"{0} min.",second:"{0} sec."},"long-time":{year:{one:"{0} year",other:"{0} years"},month:{one:"{0} month",other:"{0} months"},week:{one:"{0} week",other:"{0} weeks"},day:{one:"{0} day",other:"{0} days"},hour:{one:"{0} hour",other:"{0} hours"},minute:{one:"{0} minute",other:"{0} minutes"},second:{one:"{0} second",other:"{0} seconds"}}};var bi={},io;function Lf(){if(io)return bi;io=1;var n=ad();return bi.createRoot=n.createRoot,bi.hydrateRoot=n.hydrateRoot,bi}var Df=Lf();const Mf=({toggleMode:n,darkMode:e})=>p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"header",children:[p.jsx(en,{children:" Multimodal RAG"}),p.jsx("div",{className:"header-right",children:p.jsx(Rt,{checked:e,label:"Dark Mode",onChange:()=>{n(!e)}})})]}),p.jsx(Ii,{})]});function Ff({defaultOpenCategories:n,multiple:e}){if(n!==void 0)return Array.isArray(n)?e?n:[n[0]]:[n]}const Of=(n,e,t)=>t?e.includes(n)?e.filter(i=>i!==n):[...e,n]:e[0]===n?[]:[n],Nf=(n,e)=>{const{onNavItemSelect:t,onNavCategoryItemToggle:i,multiple:r=!0,density:s="medium",openCategories:a,selectedCategoryValue:o,selectedValue:l,defaultOpenCategories:c,defaultSelectedValue:u,defaultSelectedCategoryValue:h}=n,d=T.useRef(null),[f,g]=hr({state:a,defaultState:Ff({defaultOpenCategories:c,multiple:r}),initialState:[]}),[m,b]=hr({state:o,defaultState:h,initialState:void 0}),[y,x]=hr({state:l,defaultState:u,initialState:void 0}),A=T.useRef(void 0),k=T.useRef(void 0),E=T.useRef(void 0),_=T.useRef(void 0);A.current!==y&&(k.current=A.current,A.current=y),E.current!==m&&(_.current=E.current,E.current=m);const P=ga((F,M)=>{x(M.value),b(M.categoryValue?M.categoryValue:""),t?.(F,M)}),D=ga((F,M)=>{if(M.categoryValue!==void 0){const N=Of(M.categoryValue,f??[],r);i?.(F,M),g(N)}}),O=T.useRef({}),S=T.useCallback(F=>{O.current[JSON.stringify(F.value)]=F},[]),R=T.useCallback(F=>{delete O.current[JSON.stringify(F.value)]},[]),I=T.useCallback(()=>({selectedValue:A.current,previousSelectedValue:k.current,selectedCategoryValue:E.current,previousSelectedCategoryValue:_.current,registeredNavItems:O.current}),[]);return{components:{root:"div"},root:Ps(Tl("div",{ref:Qu(e,d),...n}),{elementType:"div"}),openCategories:f,selectedValue:y,selectedCategoryValue:m,onRegister:S,onUnregister:R,onSelect:P,getRegisteredNavItems:I,onRequestNavCategoryItemToggle:D,multiple:r,density:s}},jf=T.createContext(void 0),zf=jf.Provider;function Bf(n){const{selectedValue:e,selectedCategoryValue:t,onRegister:i,onUnregister:r,onSelect:s,getRegisteredNavItems:a,onRequestNavCategoryItemToggle:o,openCategories:l,multiple:c,density:u}=n;return{nav:T.useMemo(()=>({selectedValue:e,selectedCategoryValue:t,onSelect:s,onRegister:i,onUnregister:r,getRegisteredNavItems:a,onRequestNavCategoryItemToggle:o,openCategories:l,multiple:c,density:u}),[e,t,s,i,r,a,o,l,c,u])}}const Hf=(n,e)=>{const{tabbable:t=!1,size:i=void 0}=n,r=Ju({axis:"vertical",circular:!0,tabbable:t});return{...Nf({role:"navigation",...n},e),size:i,components:{root:Li},root:Ps({ref:e,...n,...r},{elementType:Li})}},Uf=(n,e)=>Br(zf,{value:e.nav,children:Br(n.root,{})}),$f={root:"fui-NavDrawer"},qf=Wi({root:{De3pzq:"f1ctqxl6",Bt984gj:"f3gca8"},defaultWidth:{a9b677:"f12j6lm0"}},{d:[".f1ctqxl6{background-color:var(--colorNeutralBackground4);}",".f3gca8{align-items:unset;}",".f12j6lm0{width:260px;}"]}),Vf=n=>{"use no memo";const{size:e}=n,t=qf();return n.root.className=ti($f.root,t.root,!e&&t.defaultWidth,n.root.className),n},Xl=T.forwardRef((n,e)=>{const t=Hf(n,e),i=Bf(t);return Vf(t),Uf(t,i)});Xl.displayName="NavDrawer";const Wf=(n,e)=>Zu(n,e),Gf={root:"fui-NavDrawerHeader"},Xf=Wi({root:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1r2n0t9",B1hrpyx:"f80d8h0",Dbcxam:0,rjzwhg:0,Bblux5w:"fesrmp8"}},{d:[[".f1r2n0t9{margin:unset;}",{p:-1}],".f80d8h0{-webkit-padding-start:14px;padding-inline-start:14px;}",[".fesrmp8{padding-block:5px;}",{p:-1}]]}),Yf=n=>{"use no memo";eh(n);const e=Xf();return n.root.className=ti(Gf.root,e.root,n.root.className),n},Yl=T.forwardRef((n,e)=>{const t=Wf(n,e);return Yf(t),th(t)});Yl.displayName="NavDrawerHeader";const Kf=(n,e)=>nh({icon:T.createElement(ih,null),appearance:"transparent",...n},e),ro={root:"fui-Hamburger",icon:"fui-Hamburger__icon"},Qf=Wi({root:{w71qe1:"f1iuv45f",De3pzq:"f1ctqxl6",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"],Jwef8y:"f11oyicx",ecr2s2:"f9fof1w"}},{d:[".f1iuv45f{text-decoration-line:none;}",".f1ctqxl6{background-color:var(--colorNeutralBackground4);}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}"],h:[".f11oyicx:hover{background-color:var(--colorNeutralBackground4Hover);}"],a:[".f9fof1w:active{background-color:var(--colorNeutralBackground4Pressed);}"]}),Jf=n=>{"use no memo";rh(n);const e=Qf();return n.root.className=ti(ro.root,e.root,n.root.className),n.icon&&(n.icon.className=ti(ro.icon,n.icon.className)),n},Kl=T.forwardRef((n,e)=>{const t=Kf(n,e);return Jf(t),sh(t)});Kl.displayName="Hamburger";const Zf=(n,e)=>({components:{root:"h3"},root:Ps(Tl("h3",{ref:e,...n}),{elementType:"h3"})}),ep=n=>Br(n.root,{}),tp={root:"fui-NavSectionHeader"},np=Wi({root:{Jyy4pa:"f1gr6hdk",Bo78w4l:0,Cgygva:0,yil37a:"f1ulrxyd",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"fl43uef",Bg96gwp:"fwrc4pm"}},{d:[".f1gr6hdk{-webkit-margin-start:10px;margin-inline-start:10px;}",[".f1ulrxyd{margin-block:8px;}",{p:-1}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".fwrc4pm{line-height:var(--lineHeightBase200);}"]}),ip=n=>{"use no memo";const e=np();return n.root.className=ti(tp.root,e.root,n.root.className),n},Ql=T.forwardRef((n,e)=>{const t=Zf(n,e);return ip(t),ep(t)});Ql.displayName="NavSectionHeader";const rp=()=>window.__RUNTIME_CONFIG__?.API_BASE_URL?window.__RUNTIME_CONFIG__.API_BASE_URL:window.location.origin,De=n=>{const e=rp(),t=n.startsWith("/")?n.slice(1):n;return e===window.location.origin?`/${t}`:`${e}/${t}`},sp=({config:n,setConfig:e})=>{const[t,i]=Mt.useState([{key:"quarterly_report",text:"Quarterly Report"},{key:"newsletter",text:"Newsletter"},{key:"articles",text:"Articles"},{key:"annual_report",text:"Annual Report"},{key:"financial_statement",text:"Financial Statement"},{key:"presentation",text:"Presentation"},{key:"whitepaper",text:"Whitepaper"},{key:"research_report",text:"Research Report"},{key:"policy_document",text:"Policy Document"},{key:"manual",text:"Manual"},{key:"guide",text:"Guide"},{key:"client_reviews",text:"Client Reviews"},{key:"nyp_columns",text:"NYP Columns"},{key:"otq",text:"Only Three Questions"},{key:"other",text:"Other"}]);Mt.useEffect(()=>{(async()=>{try{const f=await fetch(De("get_document_types"));if(f.ok){const g=await f.json();g.success&&g.document_types&&i(g.document_types)}}catch(f){console.warn("Could not load document types from server, using defaults:",f)}})()},[]);const r=(d,f)=>{e(g=>{const m={...g,[d]:f};return d==="use_knowledge_agent"&&f&&(m.use_semantic_ranker=!0,m.use_hybrid_search=!1,m.use_query_rewriting=!1,m.use_scoring_profile=!1,m.enable_vector_filters=!1),d==="use_hybrid_search"&&f&&(m.use_semantic_ranker=!0),m})},s=(d,f)=>{e(g=>({...g,[d]:f}))},a=(d,f)=>{e(g=>({...g,[d]:f}))},o=d=>{const f=l(d);e(g=>({...g,preferred_document_types:f}))},l=d=>{const f=["otq","nyp_columns","client_reviews"],g=[];for(const m of f)d.includes(m)&&g.push(m);for(const m of d)!f.includes(m)&&!g.includes(m)&&g.push(m);return g},c=d=>{if(d.trim()&&!n.preferred_document_types?.includes(d.trim())){const f=n.preferred_document_types||[];o([...f,d.trim()])}},u=d=>{const f=n.preferred_document_types||[];o(f.filter(g=>g!==d))},h=d=>{if(d&&!n.preferred_document_types?.includes(d)){const f=n.preferred_document_types||[];o([...f,d])}};return Mt.useEffect(()=>{(!n.preferred_document_types||n.preferred_document_types.length===0)&&o(["otq","nyp_columns","client_reviews"])},[]),p.jsxs("div",{className:"input-container",children:[p.jsxs("div",{className:"input-group",children:[p.jsxs(Yt,{htmlFor:"ChunkCountSlider",children:["Top chunks count [",n.chunk_count,"]"]}),p.jsx(mi,{id:"chunkCountSlider",className:"weightSlider",value:n.chunk_count,onChange:(d,f)=>s("chunk_count",f.value),min:5,max:50,step:5})]}),p.jsx(Rt,{id:"useSemanticRankerSwitch",checked:n.use_semantic_ranker,disabled:n.use_knowledge_agent||n.use_hybrid_search,onChange:(d,f)=>r("use_semantic_ranker",f.checked),label:p.jsx(Kt,{label:"Use semantic ranker",info:p.jsx(p.Fragment,{children:"Enable semantic ranker for improved results especially if your data is indexed using image verbalization technique. Automatically enabled with Knowledge Agent and Hybrid Search."})})}),p.jsx(Rt,{id:"useKnowledgeAgentSwitch",checked:n.use_knowledge_agent,onChange:(d,f)=>r("use_knowledge_agent",f.checked),label:p.jsx(Kt,{label:"Use Knowledge Agent",info:p.jsx(p.Fragment,{children:"Enable knowledge agent for grounding answers"})})}),p.jsxs("div",{className:"input-group",children:[p.jsxs(Yt,{htmlFor:"RecencySlider",children:["Recency preference (days) [",n.recency_preference_days||90,"]"]}),p.jsx(mi,{id:"recencySlider",className:"weightSlider",value:n.recency_preference_days||90,onChange:(d,f)=>s("recency_preference_days",f.value),min:0,max:1095,step:30}),p.jsx(ie,{size:200,style:{fontSize:"11px",color:"var(--colorNeutralForeground3)",marginTop:"4px"},children:n.use_knowledge_agent?"Boost documents published within this timeframe":"Filter and boost documents published within this timeframe"})]}),p.jsxs("div",{className:"input-group",children:[p.jsx(Yt,{htmlFor:"DocumentTypesDropdown",children:"Preferred document types"}),p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px",marginBottom:"8px"},children:(n.preferred_document_types||[]).map((d,f)=>{const g=t.find(b=>b.key===d),m=g?g.text:d;return p.jsxs("div",{style:{display:"inline-flex",alignItems:"center",padding:"2px 8px",backgroundColor:"var(--colorNeutralBackground1Selected)",borderRadius:"12px",fontSize:"12px",border:"1px solid var(--colorNeutralStroke2)"},children:[p.jsx("span",{children:m}),p.jsx(xe,{appearance:"transparent",size:"small",icon:p.jsx(ah,{}),onClick:()=>u(d),style:{marginLeft:"4px",minWidth:"16px",height:"16px"}})]},f)})}),p.jsx(_n,{id:"documentTypesDropdown",placeholder:"Select document type to add",onOptionSelect:(d,f)=>{f.optionValue&&h(f.optionValue)},children:t.filter(d=>!(n.preferred_document_types||[]).includes(d.key)).map(d=>p.jsx(yt,{value:d.key,children:d.text},d.key))}),p.jsx(ie,{size:200,style:{fontSize:"11px",color:"var(--colorNeutralForeground3)",marginTop:"4px"},children:n.use_knowledge_agent?"Select document types to prioritize in search results. Defaults to: Only Three Questions, NYP Columns, Client Reviews.":"Select document types to filter and prioritize in search results. Defaults to: Only Three Questions, NYP Columns, Client Reviews."}),p.jsx(tn,{placeholder:"Or type custom document type and press Enter",onKeyDown:d=>{if(d.key==="Enter"){d.preventDefault();const f=d.target;c(f.value),f.value=""}},style:{marginTop:"8px"}})]}),n.use_knowledge_agent&&p.jsxs(p.Fragment,{children:[p.jsx(Ii,{style:{margin:"16px 0"}}),p.jsx(ie,{size:300,weight:"semibold",style:{display:"block",marginBottom:"12px",color:"var(--colorNeutralForeground2)"},children:"Knowledge Agent Options"}),p.jsxs("div",{className:"input-group",children:[p.jsx(Yt,{htmlFor:"QueryComplexityDropdown",children:"Query complexity"}),p.jsxs(_n,{id:"queryComplexityDropdown",value:n.query_complexity||"medium",selectedOptions:[n.query_complexity||"medium"],onOptionSelect:(d,f)=>{f.optionValue&&a("query_complexity",f.optionValue)},children:[p.jsx(yt,{value:"low",children:"Low - Simple queries (faster)"}),p.jsx(yt,{value:"medium",children:"Medium - Balanced performance"}),p.jsx(yt,{value:"high",children:"High - Complex queries (comprehensive)"})]}),p.jsxs(ie,{size:200,style:{fontSize:"11px",color:"var(--colorNeutralForeground3)",marginTop:"4px"},children:['Adjusts reranker thresholds and document count for retrieval. Final results will be limited to your "Top chunks count" setting (',n.chunk_count,")."]})]}),p.jsx(Rt,{id:"postProcessingBoostSwitch",checked:n.enable_post_processing_boost!==!1,onChange:(d,f)=>r("enable_post_processing_boost",f.checked),label:p.jsx(Kt,{label:"Enable post-processing boost",info:p.jsx(p.Fragment,{children:"Apply additional prioritization logic after retrieval based on recency and document type"})})})]}),!n.use_knowledge_agent&&p.jsxs(p.Fragment,{children:[p.jsx(Ii,{style:{margin:"16px 0"}}),p.jsx(ie,{size:300,weight:"semibold",style:{display:"block",marginBottom:"12px",color:"var(--colorNeutralForeground2)"},children:"Advanced Search Options"}),p.jsx(Rt,{id:"useHybridSearchSwitch",checked:n.use_hybrid_search||!1,onChange:(d,f)=>r("use_hybrid_search",f.checked),label:p.jsx(Kt,{label:"Use Hybrid Search",info:p.jsx(p.Fragment,{children:"Enable hybrid search combining text and vector search with Reciprocal Rank Fusion (RRF) for better relevance"})})}),n.use_hybrid_search&&p.jsxs("div",{className:"input-group",style:{marginLeft:"20px",paddingLeft:"10px",borderLeft:"2px solid var(--colorNeutralStroke2)"},children:[p.jsxs("div",{className:"input-group",children:[p.jsxs(Yt,{htmlFor:"VectorWeightSlider",children:["Vector Weight [",(n.vector_weight||.5).toFixed(1),"]"]}),p.jsx(mi,{id:"vectorWeightSlider",className:"weightSlider",value:n.vector_weight||.5,onChange:(d,f)=>s("vector_weight",f.value),min:.1,max:1,step:.1}),p.jsx(ie,{size:200,style:{fontSize:"11px",color:"var(--colorNeutralForeground3)",marginTop:"4px"},children:"Balance between text search (lower values) and vector search (higher values)"})]}),p.jsx(Rt,{id:"enableVectorFiltersSwitch",checked:n.enable_vector_filters||!1,onChange:(d,f)=>r("enable_vector_filters",f.checked),label:p.jsx(Kt,{label:"Enable Vector Filters",info:p.jsx(p.Fragment,{children:"Apply filtering to vector queries for better performance with large datasets"})})}),n.enable_vector_filters&&p.jsxs("div",{className:"input-group",style:{marginLeft:"20px"},children:[p.jsx(Yt,{htmlFor:"VectorFilterModeDropdown",children:"Vector Filter Mode"}),p.jsxs(_n,{id:"vectorFilterModeDropdown",value:n.vector_filter_mode||"preFilter",selectedOptions:[n.vector_filter_mode||"preFilter"],onOptionSelect:(d,f)=>{f.optionValue&&a("vector_filter_mode",f.optionValue)},children:[p.jsx(yt,{value:"preFilter",children:"Pre-filter (Better recall, slower)"}),p.jsx(yt,{value:"postFilter",children:"Post-filter (Faster, may return fewer results)"})]}),p.jsx(ie,{size:200,style:{fontSize:"11px",color:"var(--colorNeutralForeground3)",marginTop:"4px"},children:"Pre-filtering guarantees k results but is slower. Post-filtering is faster but may return fewer results."})]})]}),p.jsx(Rt,{id:"useScoringProfileSwitch",checked:n.use_scoring_profile||!1,onChange:(d,f)=>r("use_scoring_profile",f.checked),label:p.jsx(Kt,{label:"Use Scoring Profile",info:p.jsx(p.Fragment,{children:"Apply scoring profile to boost relevance based on document freshness and type after semantic reranking"})})}),n.use_scoring_profile&&p.jsxs("div",{className:"input-group",style:{marginLeft:"20px",paddingLeft:"10px",borderLeft:"2px solid var(--colorNeutralStroke2)"},children:[p.jsx(tn,{placeholder:"Enter scoring profile name (e.g., freshness_and_type_boost)",value:n.scoring_profile_name||"",onChange:(d,f)=>e(g=>({...g,scoring_profile_name:f.value}))}),p.jsx(ie,{size:200,style:{fontSize:"11px",color:"var(--colorNeutralForeground3)",marginTop:"4px"},children:"Name of the scoring profile defined in your search index"})]}),p.jsx(Rt,{id:"useQueryRewritingSwitch",checked:n.use_query_rewriting||!1,onChange:(d,f)=>r("use_query_rewriting",f.checked),label:p.jsx(Kt,{label:"Use Query Rewriting",info:p.jsx(p.Fragment,{children:"Enable AI-powered query rewriting to improve search results by generating alternative query formulations"})})}),n.use_query_rewriting&&p.jsxs("div",{className:"input-group",style:{marginLeft:"20px",paddingLeft:"10px",borderLeft:"2px solid var(--colorNeutralStroke2)"},children:[p.jsxs(Yt,{htmlFor:"QueryRewriteCountSlider",children:["Query Rewrite Count [",n.query_rewrite_count||3,"]"]}),p.jsx(mi,{id:"queryRewriteCountSlider",className:"weightSlider",value:n.query_rewrite_count||3,onChange:(d,f)=>s("query_rewrite_count",f.value),min:1,max:10,step:1}),p.jsx(ie,{size:200,style:{fontSize:"11px",color:"var(--colorNeutralForeground3)",marginTop:"4px"},children:"Number of alternative query formulations to generate for better results"})]})]}),p.jsx(Rt,{id:"useStreamingSwitch",checked:n.use_streaming,onChange:(d,f)=>r("use_streaming",f.checked),label:"Use Streaming Response"})]})},ap=({setConfig:n,onNewChat:e,config:t})=>{const[i,r]=T.useState(!0),s=()=>i?"Close Settings":"Open Settings";return p.jsxs(p.Fragment,{children:[p.jsx(Xl,{open:i,type:"inline",className:"menu",children:p.jsxs("div",{className:"menu-items",children:[p.jsx(xe,{appearance:"secondary",icon:p.jsx(oh,{}),className:"custom-menu-item new-chat",onClick:e,children:"New Chat"}),p.jsxs("div",{className:"menu-item-settings",children:[p.jsx(Ql,{children:"Search Settings"}),p.jsx("div",{className:"custom-menu-item",children:p.jsx(sp,{config:t,setConfig:n})})]})]})}),p.jsx(Yl,{style:{width:"25px"},children:p.jsx(Zt,{content:s(),relationship:"label",children:p.jsx(Kl,{onClick:()=>r(!i)})})})]})},op=["What is the value of investing globally? Why shouldn’t I just invest in the US? What not invest just in the S&P 500?","Why do you invest my money all at once instead of dollar cost averaging?","Why don’t you sell a stock when it is down? How much does a stock have to fall for you guys to sell it? Why don’t you guys sell stocks that have been down for months?","Does Fisher use AI in the research process? How do you use AI? Does Fisher use AI to makeinvestment decisions?","Are Republicans or Democrats better for stocks?","Are high oil prices bad for stocks? Aren’t rising oil prices bad for the market?","How do wars impact markets? If this conflict escalates, will markets fall?"," Why doesn’t Fisher invest in IPOs?","Does Fisher use ESG to pick stocks?"," What are your thoughts on China challenging the US for global supremacy? What is China invades Taiwan?","How did US ranked in ACWI constituent nations as far as returns and how does it compare to Taiwan?"],lp={queries:op},so="New query...",cp=n=>{const e=n.toLowerCase();return e.includes("invest")||e.includes("money")||e.includes("dollar")?{icon:p.jsx(lh,{}),category:"Investment Strategy",color:"success"}:e.includes("stock")||e.includes("market")?{icon:p.jsx(ch,{}),category:"Market Analysis",color:"important"}:e.includes("ai")||e.includes("research")?{icon:p.jsx(uh,{}),category:"AI & Research",color:"brand"}:e.includes("republican")||e.includes("democrat")||e.includes("politic")?{icon:p.jsx(hh,{}),category:"Politics & Markets",color:"warning"}:e.includes("oil")||e.includes("war")||e.includes("china")?{icon:p.jsx(dh,{}),category:"Global Events",color:"danger"}:e.includes("global")||e.includes("us")||e.includes("s&p")?{icon:p.jsx(fh,{}),category:"Global Markets",color:"informative"}:{icon:p.jsx(Pl,{}),category:"General",color:"subtle"}},up=({handleQuery:n})=>{const e=lp.queries;return p.jsxs("div",{className:"samples-container",children:[p.jsx("div",{className:"samples-header",children:p.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center",marginBottom:"8px"},children:[p.jsx(Pl,{style:{fontSize:"20px",color:"var(--colorBrandForeground1)"}}),p.jsx(ie,{as:"h2",size:500,weight:"semibold",children:"Popular Questions"}),p.jsx(ie,{size:300,className:"samples-subtitle",children:"Click on any question to start exploring your financial data"})]})}),p.jsx("div",{className:"samples-wrapper",children:e&&e.map((t,i)=>{const r=cp(t);return p.jsxs(Ut,{className:"sample-card",onClick:()=>n(t,t===so),role:"button",tabIndex:0,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&n(t,t===so)},children:[p.jsx(Sn,{children:p.jsxs("div",{className:"sample-header",children:[p.jsx("div",{className:"sample-icon",children:r.icon}),p.jsx(ni,{appearance:"tint",size:"small",children:r.category})]})}),p.jsx(rn,{children:p.jsx("div",{className:"sample-content",children:p.jsx(ie,{size:300,weight:"medium",className:"sample-question",children:t})})})]},i)})})]})},hp=({isLoading:n,onSearch:e})=>{const[t,i]=T.useState(""),r=o=>{i(o.target.value)},s=()=>{t.trim()&&(e(t.trim()),i(""))},a=o=>{o.key==="Enter"&&s()};return p.jsxs(p.Fragment,{children:[n&&p.jsx("div",{className:"loading",children:"Generating answer, please wait..."}),p.jsxs("div",{className:"search-container",style:{boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.1)"},children:[p.jsx("input",{disabled:n,className:"input",type:"text",placeholder:"Ask about your data...",value:t,onChange:r,onKeyDown:a}),p.jsx("div",{className:"search-controls",children:p.jsx(xe,{disabled:n,shape:"circular",size:"large",appearance:"primary",icon:n?p.jsx(kn,{size:"extra-small"}):p.jsx(ph,{}),onClick:s})})]}),p.jsx(Xe,{style:{marginTop:"5px",color:"lightgray"},block:!0,align:"center",italic:!0,children:"AI-generated content may be incorrect"})]})},dp=({selectedTab:n,onTabSelect:e})=>{const t=(i,r)=>{e(r.value)};return p.jsx("div",{className:"tab-navigation",children:p.jsxs(gh,{selectedValue:n,onTabSelect:t,children:[p.jsx(dr,{value:"chat",children:"Chat"}),p.jsx(dr,{value:"upload",children:"Upload Documents"}),p.jsx(dr,{value:"admin",children:"Admin"})]})})};async function fp(n,e){const t=n.getReader();let i;for(;!(i=await t.read()).done;)e(i.value)}function pp(n){let e,t,i,r=!1;return function(a){e===void 0?(e=a,t=0,i=-1):e=mp(e,a);const o=e.length;let l=0;for(;t<o;){r&&(e[t]===10&&(l=++t),r=!1);let c=-1;for(;t<o&&c===-1;++t)switch(e[t]){case 58:i===-1&&(i=t-l);break;case 13:r=!0;case 10:c=t;break}if(c===-1)break;n(e.subarray(l,c),i),l=t,i=-1}l===o?e=void 0:l!==0&&(e=e.subarray(l),t-=l)}}function gp(n,e,t){let i=ao();const r=new TextDecoder;return function(a,o){if(a.length===0)t?.(i),i=ao();else if(o>0){const l=r.decode(a.subarray(0,o)),c=o+(a[o+1]===32?2:1),u=r.decode(a.subarray(c));switch(l){case"data":i.data=i.data?i.data+`
`+u:u;break;case"event":i.event=u;break;case"id":n(i.id=u);break;case"retry":const h=parseInt(u,10);isNaN(h)||e(i.retry=h);break}}}}function mp(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function ao(){return{data:"",event:"",id:"",retry:void 0}}var yp=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};const ns="text/event-stream",bp=1e3,oo="last-event-id";function xp(n,e){var{signal:t,headers:i,onopen:r,onmessage:s,onclose:a,onerror:o,openWhenHidden:l,fetch:c}=e,u=yp(e,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((h,d)=>{const f=Object.assign({},i);f.accept||(f.accept=ns);let g;function m(){g.abort(),document.hidden||E()}l||document.addEventListener("visibilitychange",m);let b=bp,y=0;function x(){document.removeEventListener("visibilitychange",m),window.clearTimeout(y),g.abort()}t?.addEventListener("abort",()=>{x(),h()});const A=c??window.fetch,k=r??wp;async function E(){var _;g=new AbortController;try{const P=await A(n,Object.assign(Object.assign({},u),{headers:f,signal:g.signal}));await k(P),await fp(P.body,pp(gp(D=>{D?f[oo]=D:delete f[oo]},D=>{b=D},s))),a?.(),x(),h()}catch(P){if(!g.signal.aborted)try{const D=(_=o?.(P))!==null&&_!==void 0?_:b;window.clearTimeout(y),y=window.setTimeout(E,D)}catch(D){x(),d(D)}}}E()})}function wp(n){const e=n.headers.get("content-type");if(!e?.startsWith(ns))throw new Error(`Expected content-type to be ${ns}, Actual: ${e}`)}const vp="Chat with Your Data (Text + Images)";De("chat"),De("list_indexes"),De("get_citation_doc"),De("upload"),De("upload_status"),De("process_document"),De("delete_index"),De("api/admin");const Cn={API_REQUEST:3e4,UPLOAD:6e5,PROCESSING:12e5},Ap=async(n,e,t,i,r,s)=>{const a=De("chat"),o=new AbortController,l=setTimeout(()=>{o.abort()},Cn.PROCESSING),c=h=>{if(clearTimeout(l),o.signal.aborted){const d=new Error("Chat request timed out. Large document processing may need more time.");console.error("Chat API Timeout:",d),s?.(d)}else console.error("Chat API Stream Error:",h),s?.(h)},u=h=>{h.event==="[END]"&&clearTimeout(l),r(h)};await xp(a,{openWhenHidden:!0,method:"POST",body:JSON.stringify({query:n,request_id:e,chatThread:t,config:i}),signal:o.signal,onerror:c,onmessage:u})},_p=async()=>await(await fetch(De("list_indexes"))).json(),Sp=async n=>await(await fetch(De("get_citation_doc"),{method:"POST",body:JSON.stringify({fileName:n})})).json(),kp=async()=>{const n=async i=>{const r=await fetch(De(i),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cascade:!0})}),s=await r.text();let a={};try{a=s?JSON.parse(s):{}}catch{a={error:s}}return{res:r,out:a}};let{res:e,out:t}=await n("api/delete_index").catch(()=>({res:void 0,out:{error:"network"}}));if((!e||e.status===404||e.status===405)&&({res:e,out:t}=await n("delete_index")),!e.ok)throw new Error(t?.error||`Failed to delete index (HTTP ${e.status})`);return t},Ep=()=>{const[n,e]=T.useState(null),[t,i]=T.useState(!1),[r,s]=T.useState(null),[a,o]=T.useState(null),[l,c]=T.useState(!1),[u,h]=T.useState(!1),d=T.useRef(null),[f,g]=T.useState(!1),[m,b]=T.useState(!1),[y,x]=T.useState(!1),[A,k]=T.useState(""),[E,_]=T.useState(""),[P,D]=T.useState(""),[O,S]=T.useState(null),[R,I]=T.useState(!0),[F,M]=T.useState([{key:"quarterly_report",text:"Quarterly Report"},{key:"newsletter",text:"Newsletter"},{key:"articles",text:"Articles"},{key:"annual_report",text:"Annual Report"},{key:"financial_statement",text:"Financial Statement"},{key:"presentation",text:"Presentation"},{key:"whitepaper",text:"Whitepaper"},{key:"research_report",text:"Research Report"},{key:"policy_document",text:"Policy Document"},{key:"manual",text:"Manual"},{key:"guide",text:"Guide"},{key:"client_reviews",text:"Client Reviews"},{key:"nyp_columns",text:"NYP Columns"},{key:"otq",text:"Only Three Questions"},{key:"other",text:"Other"}]),[N,V]=T.useState(500),[B,q]=T.useState(50),[U,v]=T.useState("markdown"),[G,X]=T.useState("document_layout");Mt.useEffect(()=>{(async()=>{try{const W=await fetch(De("get_document_types"));if(W.ok){const ye=await W.json();ye.success&&ye.document_types&&M(ye.document_types)}}catch(W){console.warn("Could not load document types from server, using defaults:",W)}})()},[]);const w=async j=>{try{o({type:"info",text:"Extracting metadata from PDF..."});const W=new FormData;W.append("file",j);const ye=await fetch(De("extract_metadata"),{method:"POST",body:W}),be=await ye.json();if(!ye.ok)throw new Error(be.error||"Failed to extract metadata");if(be.success&&be.metadata){const ge=be.metadata;ge.published_date&&k(ge.published_date),ge.document_type&&_(ge.document_type),ge.expiry_date&&D(ge.expiry_date),S(ge);const Me=[];ge.published_date&&Me.push("Published Date"),ge.document_type&&Me.push("Document Type"),ge.expiry_date&&Me.push("Expiry Date"),Me.length>0?o({type:"success",text:`PDF metadata extracted: ${Me.join(", ")}. Please verify the values before uploading.`}):o(null)}else o(null);I(!0)}catch(W){console.warn("Could not extract metadata from PDF:",W),o({type:"warning",text:"Could not extract metadata from PDF. Please fill in the information manually."}),I(!0),S(null)}},ne=T.useCallback(async j=>{const W=j.target.files?.[0];W&&(W.type==="application/pdf"?(e(W),o(null),await w(W)):o({type:"error",text:"Please select a PDF file."}))},[]),$=T.useCallback(async j=>{j.preventDefault(),c(!1);const W=j.dataTransfer.files[0];W&&W.type==="application/pdf"?(e(W),o(null),await w(W)):o({type:"error",text:"Please select a PDF file."})},[]),Q=T.useCallback(j=>{j.preventDefault(),c(!0)},[]),Y=T.useCallback(j=>{j.preventDefault(),c(!1)},[]),Ae=async j=>{let ye=0;const be=async()=>{try{const ge=new AbortController,Me=setTimeout(()=>ge.abort(),Cn.API_REQUEST);try{const ct=await fetch(De(`upload_status?upload_id=${j}`),{signal:ge.signal});clearTimeout(Me);const Ze=await ct.json();if(ct.ok){if(s(Ze),Ze.status==="completed"){o({type:"success",text:"Document processed successfully!"}),i(!1);return}else if(Ze.status==="error"){o({type:"error",text:Ze.message||"Processing failed"}),i(!1);return}}ye++,ye<120&&(Ze.status==="uploading"||Ze.status==="processing"||Ze.status==="analyzing")?setTimeout(be,1e3):ye>=120&&(o({type:"error",text:"Processing timeout"}),i(!1))}catch(ct){throw clearTimeout(Me),ct instanceof DOMException&&ct.name==="AbortError"&&console.error("Status polling timeout"),ct}}catch(ge){console.error("Status polling error:",ge),ye++,ye<120?setTimeout(be,1e3):(o({type:"error",text:"Failed to get processing status"}),i(!1))}};be()},Ee=async()=>{try{x(!0);const j=await kp();o({type:"success",text:`Index deleted: ${j.deleted||"unknown"}`})}catch(j){o({type:"error",text:j instanceof Error?j.message:"Failed to delete index"})}finally{x(!1),b(!1)}},he=j=>{switch(j){case"document_analysis":return p.jsx(ba,{});case"content_extraction":return p.jsx(ma,{});case"image_processing":return p.jsx(Eh,{});case"embedding_generation":return p.jsx(xa,{});case"indexing_complete":return p.jsx(kh,{});default:return p.jsx(Sh,{})}},se=j=>{switch(j){case"document_analysis":return"Document Analysis";case"content_extraction":return"Content Extraction";case"image_processing":return"Image Processing";case"embedding_generation":return"Embedding Generation";case"indexing_complete":return"Search Indexing";default:return j.replace(/_/g," ").replace(/\b\w/g,W=>W.toUpperCase())}},Je=j=>{try{const W=(j.match(/Error code:\s*(\d{3})/)||[])[1],ye=(j.match(/'code':\s*'([^']+)'/)||[])[1],be=(j.match(/'message':\s*'([^']+)'/)||[])[1],ge=[];return ye==="DeploymentNotFound"&&ge.push("Embedding deployment not found."),be&&ge.push(be),W&&!ge.length&&ge.push(`Error ${W}`),{summary:ge.join(" ")||"Processing failed",details:j}}catch{return{summary:j,details:j}}},de=async()=>{if(n){if(!A){o({type:"error",text:"Please select a published date."});return}if(!E){o({type:"error",text:"Please select a document type."});return}i(!0),o(null),s(null);try{const j=new FormData;j.append("file",n);const W=new AbortController,ye=setTimeout(()=>W.abort(),Cn.UPLOAD),be=await fetch(De("upload"),{method:"POST",body:j,signal:W.signal});clearTimeout(ye);const ge=await be.json();if(!be.ok)throw new Error(ge.error||"Upload failed");const Me=new AbortController,ct=setTimeout(()=>Me.abort(),Cn.PROCESSING),Ze=await fetch(De("process_document"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({upload_id:ge.upload_id,published_date:A,document_type:E,expiry_date:P||null,chunk_size:N,chunk_overlap:B,output_format:U,chunking_strategy:G}),signal:Me.signal});clearTimeout(ct);const Nn=await Ze.json();if(!Ze.ok)throw new Error(Nn.error||"Processing failed");Ae(ge.upload_id)}catch(j){if(i(!1),j instanceof DOMException&&j.name==="AbortError"){const be="Operation timed out. Large documents may need more time to process.";o({type:"error",text:be}),s(ge=>ge||{status:"error",message:be,progress:100});return}const W=j instanceof Error?j.message:"Upload failed",ye=Je(W);o({type:"error",text:ye.summary}),s(be=>be||{status:"error",message:W,progress:100})}}},_e=()=>{e(null),i(!1),s(null),o(null),k(""),_(""),D(""),S(null),I(!0),V(500),q(50),v("markdown"),X("document_layout"),d.current&&(d.current.value="")},Te=j=>{if(j===0)return"0 Bytes";const W=1024,ye=["Bytes","KB","MB","GB"],be=Math.floor(Math.log(j)/Math.log(W));return parseFloat((j/Math.pow(W,be)).toFixed(2))+" "+ye[be]};return p.jsx("div",{className:"professional-upload-container",children:p.jsx("div",{className:"upload-workspace",children:p.jsxs("div",{className:"upload-layout",children:[p.jsxs(Ut,{className:"upload-card",role:"region","aria-label":"Upload document",children:[p.jsx(Sn,{header:p.jsxs("div",{className:"card-header",children:[p.jsx(en,{children:"Upload Document"}),p.jsx(Xe,{children:"Supported formats: PDF (up to 50MB)"})]})}),p.jsxs(rn,{children:[p.jsx("div",{className:`drop-zone ${l?"drag-over":""} ${n?"has-file":""}`,onDragOver:Q,onDragLeave:Y,onDrop:$,onClick:()=>d.current?.click(),children:n?p.jsxs("div",{className:"file-preview",children:[p.jsx(ma,{className:"file-icon"}),p.jsxs("div",{className:"file-info",children:[p.jsx(ie,{weight:"semibold",children:n.name}),p.jsx(Xe,{children:Te(n.size)})]}),p.jsx("div",{className:"file-badge",children:"PDF"})]}):p.jsxs("div",{className:"drop-prompt",children:[p.jsx(mh,{className:"upload-icon"}),p.jsx(ie,{size:500,weight:"medium",children:"Drop your PDF here"}),p.jsx(Xe,{children:"or click to browse files"})]})}),p.jsx("input",{ref:d,type:"file",accept:".pdf",className:"visually-hidden",onChange:ne}),p.jsxs("div",{className:"metadata-form",children:[p.jsxs("div",{className:"form-grid",children:[p.jsx("div",{className:"form-row",children:p.jsx(zt,{label:"Published Date",required:!0,children:p.jsx(tn,{type:"date",value:A,onChange:j=>k(j.target.value),placeholder:"Select published date",disabled:t})})}),p.jsx("div",{className:"form-row",children:p.jsx(zt,{label:"Expiry Date",hint:"Optional - leave blank if document doesn't expire",children:p.jsx(tn,{type:"date",value:P,onChange:j=>D(j.target.value),placeholder:"Select expiry date (optional)",disabled:t})})}),p.jsx("div",{className:"form-row form-row-span-2",children:p.jsx(zt,{label:"Document Type",required:!0,children:p.jsx(_n,{placeholder:"Select document type",value:E,selectedOptions:E?[E]:[],onOptionSelect:(j,W)=>{W.optionValue&&_(W.optionValue)},disabled:t,children:F.map(j=>p.jsx(yt,{value:j.key,children:j.text},j.key))})})})]}),p.jsxs("div",{className:"form-section",children:[p.jsx(en,{style:{marginTop:"20px",marginBottom:"10px"},children:"Processing Options"}),p.jsxs("div",{className:"form-grid",children:[p.jsx("div",{className:"form-row form-row-span-2",children:p.jsx(zt,{label:"Chunking Strategy",hint:"Document Layout uses AI to preserve document structure. Custom allows manual token-based chunking.",children:p.jsxs(_n,{placeholder:"Select chunking strategy",value:G,selectedOptions:[G],onOptionSelect:(j,W)=>{W.optionValue&&X(W.optionValue)},disabled:t,children:[p.jsx(yt,{value:"document_layout",children:"Document Layout (Recommended)"}),p.jsx(yt,{value:"custom",children:"Custom Chunking"})]})})}),p.jsx("div",{className:"form-row form-row-span-2",children:p.jsx(zt,{label:"Output Format",hint:"Choose how the document content is stored",children:p.jsxs(_n,{placeholder:"Select output format",value:U,selectedOptions:[U],onOptionSelect:(j,W)=>{W.optionValue&&v(W.optionValue)},disabled:t,children:[p.jsx(yt,{value:"markdown",children:"Markdown (Structured)"}),p.jsx(yt,{value:"text",children:"Plain Text"})]})})}),G==="custom"&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"form-row",children:p.jsx(zt,{label:"Chunk Size",hint:"Number of tokens per text chunk (100-2000)",children:p.jsx(tn,{type:"number",value:N.toString(),onChange:j=>{const W=parseInt(j.target.value)||500;V(Math.max(100,Math.min(2e3,W)))},min:"100",max:"2000",step:"50",disabled:t})})}),p.jsx("div",{className:"form-row",children:p.jsx(zt,{label:"Chunk Overlap",hint:"Number of overlapping tokens between chunks (0-200)",children:p.jsx(tn,{type:"number",value:B.toString(),onChange:j=>{const W=parseInt(j.target.value)||50;q(Math.max(0,Math.min(200,W)))},min:"0",max:"200",step:"10",disabled:t})})})]})]})]})]})]}),p.jsx(Hr,{children:p.jsxs("div",{className:"card-actions",children:[p.jsx(xe,{appearance:"primary",size:"large",disabled:!n||!A||!E||t,onClick:de,icon:p.jsx(ya,{}),children:t?"Processing...":"Upload & Process"}),n&&!t&&p.jsx(xe,{appearance:"subtle",onClick:_e,icon:p.jsx(yh,{}),children:"Clear"}),p.jsx(xe,{appearance:"secondary",onClick:()=>b(!0),disabled:t||y,children:y?"Deleting…":"Delete Index"})]})})]}),a&&p.jsxs("div",{className:"status-message",role:"status","aria-live":"polite",children:[p.jsxs(ii,{intent:a.type,children:[a.type==="success"&&p.jsx(bh,{}),a.type==="error"&&p.jsx(xh,{}),p.jsx("span",{children:a.text}),a.type==="error"&&r?.message&&p.jsxs(p.Fragment,{children:[" ",p.jsx(wh,{appearance:"subtle",onClick:()=>h(j=>!j),children:u?"Hide details":"Show technical details"})]})]}),u&&r?.message&&p.jsx("pre",{className:"error-raw","aria-label":"Error details",children:r.message})]}),r&&p.jsxs(Ut,{className:"progress-card",role:"region","aria-label":"Processing progress",children:[p.jsx(Sn,{header:p.jsxs("div",{className:"progress-header",children:[p.jsxs("div",{className:"progress-title",children:[p.jsx(en,{children:"Processing Document"}),p.jsx(Xe,{className:"progress-message",children:r.message})]}),p.jsxs("div",{className:"progress-actions",children:[t&&p.jsx(kn,{size:"medium"}),r?.details&&p.jsx(xe,{appearance:"secondary",size:"small",onClick:()=>g(!0),children:"View details"})]})]})}),p.jsx(rn,{children:p.jsxs("div",{className:"progress-content",children:[p.jsxs("div",{className:"progress-bar-section",children:[p.jsxs("div",{className:"progress-info",children:[p.jsxs(ie,{size:300,children:[r.progress,"% Complete"]}),p.jsxs(Xe,{children:["Status: ",r.status]})]}),p.jsx(vh,{value:r.progress/100,className:"main-progress-bar"})]}),p.jsxs("div",{className:"processing-steps",children:[p.jsxs("div",{className:`step ${r.progress>0?"completed":"pending"}`,children:[p.jsx(ya,{}),p.jsx("span",{children:"Upload"})]}),p.jsxs("div",{className:`step ${r.progress>25?"completed":r.progress>0?"active":"pending"}`,children:[p.jsx(ba,{}),p.jsx("span",{children:"Analysis"})]}),p.jsxs("div",{className:`step ${r.progress>50?"completed":r.progress>25?"active":"pending"}`,children:[p.jsx(xa,{}),p.jsx("span",{children:"Processing"})]}),p.jsxs("div",{className:`step ${r.progress>75?"completed":r.progress>50?"active":"pending"}`,children:[p.jsx(Ah,{}),p.jsx("span",{children:"Indexing"})]}),p.jsxs("div",{className:`step ${r.progress>=100?"completed":r.progress>75?"active":"pending"}`,children:[p.jsx(_h,{}),p.jsx("span",{children:"Complete"})]})]}),r.details&&p.jsxs("div",{className:"stats-grid compact",children:[p.jsxs("div",{className:"stat-card",children:[p.jsx("div",{className:"stat-value",children:r.details.pages_processed||0}),p.jsx("div",{className:"stat-label",children:"Pages"})]}),p.jsxs("div",{className:"stat-card",children:[p.jsx("div",{className:"stat-value",children:r.details.images_extracted||0}),p.jsx("div",{className:"stat-label",children:"Images"})]}),p.jsxs("div",{className:"stat-card",children:[p.jsx("div",{className:"stat-value",children:r.details.figures_processed||0}),p.jsx("div",{className:"stat-label",children:"Figures"})]}),p.jsxs("div",{className:"stat-card",children:[p.jsx("div",{className:"stat-value",children:r.details.chunks_created||0}),p.jsx("div",{className:"stat-label",children:"Chunks"})]})]})]})})]}),p.jsx(Di,{open:f,onOpenChange:(j,W)=>g(!!W.open),children:p.jsx(Mi,{children:p.jsxs(Fi,{children:[p.jsx(Ur,{children:"Processing Details"}),p.jsx(Oi,{children:r?.details?p.jsxs("div",{className:"processing-details",children:[p.jsxs("div",{className:"stats-grid",children:[p.jsxs("div",{className:"stat-card",children:[p.jsx("div",{className:"stat-value",children:r.details.pages_processed||0}),p.jsx("div",{className:"stat-label",children:"Pages Processed"})]}),p.jsxs("div",{className:"stat-card",children:[p.jsx("div",{className:"stat-value",children:r.details.images_extracted||0}),p.jsx("div",{className:"stat-label",children:"Images Extracted"})]}),p.jsxs("div",{className:"stat-card",children:[p.jsx("div",{className:"stat-value",children:r.details.figures_processed||0}),p.jsx("div",{className:"stat-label",children:"Figures Processed"})]}),p.jsxs("div",{className:"stat-card",children:[p.jsx("div",{className:"stat-value",children:r.details.chunks_created||0}),p.jsx("div",{className:"stat-label",children:"Text Chunks"})]})]}),r.details.steps&&r.details.steps.length>0&&p.jsxs("div",{className:"processing-timeline",children:[p.jsx(en,{children:"Processing Timeline"}),p.jsx("div",{className:"timeline",children:r.details.steps.map((j,W)=>p.jsxs("div",{className:`timeline-item ${j.status}`,children:[p.jsx("div",{className:"timeline-marker",children:he(j.step)}),p.jsxs("div",{className:"timeline-content",children:[p.jsx(ie,{weight:"semibold",className:"break-words",children:se(j.step)}),p.jsx(Xe,{className:"break-words",children:j.message||j.status}),p.jsx(Xe,{className:"timestamp",children:new Date(j.timestamp).toLocaleTimeString()}),j.error&&p.jsx(ii,{intent:"error",className:"error-details break-words",children:j.error})]})]},W))})]})]}):p.jsx(Xe,{children:"No details available yet."})}),p.jsx(Ni,{children:p.jsx(xe,{appearance:"primary",onClick:()=>g(!1),children:"Close"})})]})})}),p.jsx(Di,{open:m,onOpenChange:(j,W)=>b(!!W.open),children:p.jsx(Mi,{children:p.jsxs(Fi,{children:[p.jsx(Ur,{children:"Delete Search Index"}),p.jsx(Oi,{children:p.jsx(Bt,{children:"This will delete the configured search index and cannot be undone. Continue?"})}),p.jsxs(Ni,{children:[p.jsx(xe,{appearance:"secondary",onClick:()=>b(!1),disabled:y,children:"Cancel"}),p.jsx(xe,{appearance:"primary",onClick:Ee,disabled:y,children:"Delete"})]})]})})})]})})})},Cp=()=>{const[n,e]=T.useState(null),[t,i]=T.useState(!0),[r,s]=T.useState(null),[a,o]=T.useState(!1),[l,c]=T.useState(null),[u,h]=T.useState(!1),[d,f]=T.useState(""),[g,m]=T.useState(null),[b,y]=T.useState([]),[x,A]=T.useState(!1),k=async()=>{try{i(!0),s(null);const S=new AbortController,R=setTimeout(()=>S.abort(),Cn.API_REQUEST),I=await fetch(De("api/admin/documents"),{signal:S.signal});if(clearTimeout(R),!I.ok)throw new Error(`Failed to fetch statistics: ${I.statusText}`);const F=await I.json();e(F)}catch(S){S instanceof DOMException&&S.name==="AbortError"?s("Request timed out while fetching document statistics"):s(S instanceof Error?S.message:"Failed to fetch statistics")}finally{i(!1)}};T.useEffect(()=>{k()},[]);const E=async S=>{c({type:"document",id:S,title:S}),o(!0)},_=async S=>{try{A(!0),s(null);const R=new AbortController,I=setTimeout(()=>R.abort(),Cn.API_REQUEST),F=await fetch(De(`api/admin/document_chunks?document_title=${encodeURIComponent(S)}`),{signal:R.signal});if(clearTimeout(I),!F.ok)throw new Error(`Failed to fetch document chunks: ${F.statusText}`);const M=await F.json(),N=Array.isArray(M)?M:M.chunks||[];y(N),m(S)}catch(R){R instanceof DOMException&&R.name==="AbortError"?s("Request timed out while fetching document chunks"):s(R instanceof Error?R.message:"Failed to fetch document chunks"),y([])}finally{A(!1)}},P=S=>{g===S?(m(null),y([])):_(S)},D=async()=>{if(l)try{h(!0);const S=l.type==="document"?"/api/admin/delete_document":"/api/admin/delete_chunk",R=l.type==="document"?{document_title:l.id}:{content_id:l.id},I=await fetch(S,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!I.ok)throw new Error(`Delete failed: ${I.statusText}`);await k(),o(!1),c(null)}catch(S){s(S instanceof Error?S.message:"Delete operation failed")}finally{h(!1)}},O=n?.documents.filter(S=>S.document_title.toLowerCase().includes(d.toLowerCase()))||[];return t?p.jsx("div",{className:"admin-container",children:p.jsxs("div",{className:"admin-loading",children:[p.jsx(kn,{size:"large"}),p.jsx(ie,{children:"Loading document statistics..."})]})}):r?p.jsx("div",{className:"admin-container",children:p.jsxs(ii,{intent:"error",children:[p.jsx(ie,{children:r}),p.jsx(xe,{onClick:k,children:"Retry"})]})}):p.jsxs("div",{className:"admin-container",children:[p.jsxs("div",{className:"admin-header",children:[p.jsx(ie,{as:"h1",size:600,weight:"semibold",children:"Document Administration"}),p.jsx(xe,{onClick:k,disabled:t,children:"Refresh"})]}),p.jsxs("div",{className:"admin-summary",children:[p.jsxs(Ut,{className:"summary-card",children:[p.jsx(Sn,{children:p.jsx(ie,{weight:"semibold",children:"Total Documents"})}),p.jsx(rn,{children:p.jsxs("div",{className:"summary-value",children:[p.jsx(wa,{className:"summary-icon"}),p.jsxs("div",{className:"summary-text",children:[p.jsx(ie,{size:800,weight:"bold",children:n?.total_documents||0}),p.jsx(ie,{size:200,children:"Documents"})]})]})})]}),p.jsxs(Ut,{className:"summary-card",children:[p.jsx(Sn,{children:p.jsx(ie,{weight:"semibold",children:"Total Chunks"})}),p.jsx(rn,{children:p.jsx("div",{className:"summary-value",children:p.jsxs("div",{className:"summary-text",children:[p.jsx(ie,{size:800,weight:"bold",children:n?.total_chunks||0}),p.jsx(ie,{size:200,children:"Chunks"})]})})})]})]}),p.jsx("div",{className:"admin-filter",children:p.jsx(zt,{label:"Filter documents",children:p.jsx(tn,{placeholder:"Search by document title...",value:d,onChange:(S,R)=>f(R.value)})})}),p.jsxs("div",{className:"admin-table-container",children:[p.jsxs(Ch,{children:[p.jsx(Th,{children:p.jsxs(fr,{children:[p.jsx(Nt,{children:"Document Title"}),p.jsx(Nt,{children:"Type"}),p.jsx(Nt,{children:"Text Chunks"}),p.jsx(Nt,{children:"Image Chunks"}),p.jsx(Nt,{children:"Total Chunks"}),p.jsx(Nt,{children:"Published Date"}),p.jsx(Nt,{children:"Expiry Date"}),p.jsx(Nt,{children:"Actions"})]})}),p.jsx(Ph,{children:O.map((S,R)=>p.jsxs(Mt.Fragment,{children:[p.jsxs(fr,{children:[p.jsx(Ct,{children:p.jsx(xe,{appearance:"subtle",onClick:()=>P(S.document_title),style:{padding:0,minWidth:"auto"},children:p.jsx(ie,{weight:"semibold",style:{color:"var(--colorBrandForeground1)",cursor:"pointer"},children:S.document_title})})}),p.jsx(Ct,{children:p.jsx(ni,{appearance:"filled",children:S.document_type})}),p.jsx(Ct,{children:p.jsxs("div",{className:"chunk-count",children:[p.jsx(wa,{}),p.jsx(pr,{count:S.text_chunks,appearance:"filled"})]})}),p.jsx(Ct,{children:p.jsxs("div",{className:"chunk-count",children:[p.jsx(Rh,{}),p.jsx(pr,{count:S.image_chunks,appearance:"filled"})]})}),p.jsx(Ct,{children:p.jsx(pr,{count:S.total_chunks,appearance:"filled",color:"important"})}),p.jsx(Ct,{children:p.jsx(ie,{size:200,children:S.published_date?new Date(S.published_date).toLocaleDateString():"N/A"})}),p.jsx(Ct,{children:p.jsx(ie,{size:200,children:S.expiry_date?new Date(S.expiry_date).toLocaleDateString():"N/A"})}),p.jsx(Ct,{children:p.jsx(xe,{appearance:"subtle",icon:p.jsx(va,{}),onClick:()=>E(S.document_title),title:"Delete entire document",children:"Delete Document"})})]}),g===S.document_title&&p.jsx(fr,{children:p.jsx(Ct,{colSpan:8,children:p.jsx("div",{className:"document-chunks-container",children:x?p.jsxs("div",{className:"chunks-loading",children:[p.jsx(kn,{size:"small"}),p.jsx(ie,{children:"Loading chunks..."})]}):p.jsxs("div",{className:"document-chunks",children:[p.jsxs(ie,{weight:"semibold",size:400,style:{marginBottom:"12px"},children:["Document Chunks (",Array.isArray(b)?b.length:0,")"]}),p.jsxs("div",{className:"chunks-grid",children:[Array.isArray(b)&&b.map((I,F)=>p.jsxs(Ut,{className:"chunk-card",children:[p.jsx(Sn,{children:p.jsxs("div",{className:"chunk-header",children:[p.jsx(ie,{weight:"semibold",size:300,children:I.text_document_id?"Text Chunk":"Image Chunk"}),p.jsxs(ni,{appearance:"outline",size:"small",children:["ID: ",I.content_id]})]})}),p.jsx(rn,{children:p.jsxs("div",{className:"chunk-content",children:[I.content_text&&p.jsxs("div",{className:"chunk-content-preview",children:[p.jsx(ie,{size:200,weight:"semibold",style:{marginBottom:"4px"},children:"Content Preview:"}),p.jsx(ie,{size:200,className:"chunk-text",children:I.content_text.length>150?`${I.content_text.substring(0,150)}...`:I.content_text})]}),I.content_path&&p.jsxs("div",{className:"chunk-content-preview",children:[p.jsx(ie,{size:200,weight:"semibold",children:"Image Path:"}),p.jsx(ie,{size:200,style:{fontStyle:"italic"},children:I.content_path})]}),p.jsxs("table",{className:"chunk-metadata-table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Property"}),p.jsx("th",{children:"Value"})]})}),p.jsxs("tbody",{children:[p.jsxs("tr",{children:[p.jsx("td",{children:"Content ID"}),p.jsx("td",{children:I.content_id||"N/A"})]}),p.jsxs("tr",{children:[p.jsx("td",{children:"Document Type"}),p.jsx("td",{children:I.document_type||"N/A"})]}),p.jsxs("tr",{children:[p.jsx("td",{children:"Text Document ID"}),p.jsx("td",{children:I.text_document_id||"N/A"})]}),p.jsxs("tr",{children:[p.jsx("td",{children:"Image Document ID"}),p.jsx("td",{children:I.image_document_id||"N/A"})]}),p.jsxs("tr",{children:[p.jsx("td",{children:"Published Date"}),p.jsx("td",{children:I.published_date?new Date(I.published_date).toLocaleDateString():"N/A"})]}),p.jsxs("tr",{children:[p.jsx("td",{children:"Expiry Date"}),p.jsx("td",{children:I.expiry_date?new Date(I.expiry_date).toLocaleDateString():"N/A"})]}),p.jsxs("tr",{children:[p.jsx("td",{children:"Page Number"}),p.jsx("td",{children:I.locationMetadata?.pageNumber||"N/A"})]}),I.locationMetadata&&Object.keys(I.locationMetadata).length>1&&p.jsxs("tr",{children:[p.jsx("td",{children:"Location Metadata"}),p.jsx("td",{children:p.jsx("pre",{style:{fontSize:"10px",margin:0,whiteSpace:"pre-wrap"},children:JSON.stringify(I.locationMetadata,null,2)})})]})]})]})]})})]},F)),(!Array.isArray(b)||b.length===0)&&p.jsx("div",{style:{padding:"20px",textAlign:"center"},children:p.jsx(ie,{children:"No chunks found for this document."})})]})]})})})})]},R))})]}),O.length===0&&p.jsx("div",{className:"no-documents",children:p.jsx(ie,{children:"No documents found matching your search criteria."})})]}),p.jsx(Di,{open:a,onOpenChange:(S,R)=>o(R.open),children:p.jsxs(Mi,{children:[p.jsx(Ur,{children:"Confirm Deletion"}),p.jsxs(Oi,{children:[p.jsx(Fi,{children:p.jsxs("div",{className:"delete-warning",children:[p.jsx(Ih,{className:"warning-icon"}),p.jsxs("div",{children:[p.jsxs(ie,{weight:"semibold",children:["Are you sure you want to delete ",l?.type==="document"?"the entire document":"this chunk","?"]}),p.jsx(ie,{children:l?.type==="document"?`This will permanently delete all chunks for "${l.title}".`:`This will permanently delete the selected chunk from "${l?.title}".`}),p.jsx(ie,{weight:"semibold",style:{color:"red"},children:"This action cannot be undone."})]})]})}),p.jsxs(Ni,{children:[p.jsx(xe,{appearance:"secondary",onClick:()=>o(!1),disabled:u,children:"Cancel"}),p.jsx(xe,{appearance:"primary",onClick:D,disabled:u,icon:u?p.jsx(kn,{size:"tiny"}):p.jsx(va,{}),children:u?"Deleting...":"Delete"})]})]})]})})]})};function Tp(n,e){const t={};return(n[n.length-1]===""?[...n,""]:n).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const Pp=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Rp=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Ip={};function lo(n,e){return(Ip.jsx?Rp:Pp).test(n)}const Lp=/[ \t\n\f\r]/g;function Dp(n){return typeof n=="object"?n.type==="text"?co(n.value):!1:co(n)}function co(n){return n.replace(Lp,"")===""}class ci{constructor(e,t,i){this.normal=t,this.property=e,i&&(this.space=i)}}ci.prototype.normal={};ci.prototype.property={};ci.prototype.space=void 0;function Jl(n,e){const t={},i={};for(const r of n)Object.assign(t,r.property),Object.assign(i,r.normal);return new ci(t,i,e)}function is(n){return n.toLowerCase()}class it{constructor(e,t){this.attribute=t,this.property=e}}it.prototype.attribute="";it.prototype.booleanish=!1;it.prototype.boolean=!1;it.prototype.commaOrSpaceSeparated=!1;it.prototype.commaSeparated=!1;it.prototype.defined=!1;it.prototype.mustUseProperty=!1;it.prototype.number=!1;it.prototype.overloadedBoolean=!1;it.prototype.property="";it.prototype.spaceSeparated=!1;it.prototype.space=void 0;let Mp=0;const ae=dn(),Le=dn(),rs=dn(),z=dn(),Se=dn(),Tn=dn(),at=dn();function dn(){return 2**++Mp}const ss=Object.freeze(Object.defineProperty({__proto__:null,boolean:ae,booleanish:Le,commaOrSpaceSeparated:at,commaSeparated:Tn,number:z,overloadedBoolean:rs,spaceSeparated:Se},Symbol.toStringTag,{value:"Module"})),mr=Object.keys(ss);class Ds extends it{constructor(e,t,i,r){let s=-1;if(super(e,t),uo(this,"space",r),typeof i=="number")for(;++s<mr.length;){const a=mr[s];uo(this,mr[s],(i&ss[a])===ss[a])}}}Ds.prototype.defined=!0;function uo(n,e,t){t&&(n[e]=t)}function Fn(n){const e={},t={};for(const[i,r]of Object.entries(n.properties)){const s=new Ds(i,n.transform(n.attributes||{},i),r,n.space);n.mustUseProperty&&n.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),e[i]=s,t[is(i)]=i,t[is(s.attribute)]=i}return new ci(e,t,n.space)}const Zl=Fn({properties:{ariaActiveDescendant:null,ariaAtomic:Le,ariaAutoComplete:null,ariaBusy:Le,ariaChecked:Le,ariaColCount:z,ariaColIndex:z,ariaColSpan:z,ariaControls:Se,ariaCurrent:null,ariaDescribedBy:Se,ariaDetails:null,ariaDisabled:Le,ariaDropEffect:Se,ariaErrorMessage:null,ariaExpanded:Le,ariaFlowTo:Se,ariaGrabbed:Le,ariaHasPopup:null,ariaHidden:Le,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Se,ariaLevel:z,ariaLive:null,ariaModal:Le,ariaMultiLine:Le,ariaMultiSelectable:Le,ariaOrientation:null,ariaOwns:Se,ariaPlaceholder:null,ariaPosInSet:z,ariaPressed:Le,ariaReadOnly:Le,ariaRelevant:null,ariaRequired:Le,ariaRoleDescription:Se,ariaRowCount:z,ariaRowIndex:z,ariaRowSpan:z,ariaSelected:Le,ariaSetSize:z,ariaSort:null,ariaValueMax:z,ariaValueMin:z,ariaValueNow:z,ariaValueText:null,role:null},transform(n,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function ec(n,e){return e in n?n[e]:e}function tc(n,e){return ec(n,e.toLowerCase())}const Fp=Fn({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Tn,acceptCharset:Se,accessKey:Se,action:null,allow:null,allowFullScreen:ae,allowPaymentRequest:ae,allowUserMedia:ae,alt:null,as:null,async:ae,autoCapitalize:null,autoComplete:Se,autoFocus:ae,autoPlay:ae,blocking:Se,capture:null,charSet:null,checked:ae,cite:null,className:Se,cols:z,colSpan:null,content:null,contentEditable:Le,controls:ae,controlsList:Se,coords:z|Tn,crossOrigin:null,data:null,dateTime:null,decoding:null,default:ae,defer:ae,dir:null,dirName:null,disabled:ae,download:rs,draggable:Le,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:ae,formTarget:null,headers:Se,height:z,hidden:rs,high:z,href:null,hrefLang:null,htmlFor:Se,httpEquiv:Se,id:null,imageSizes:null,imageSrcSet:null,inert:ae,inputMode:null,integrity:null,is:null,isMap:ae,itemId:null,itemProp:Se,itemRef:Se,itemScope:ae,itemType:Se,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:ae,low:z,manifest:null,max:null,maxLength:z,media:null,method:null,min:null,minLength:z,multiple:ae,muted:ae,name:null,nonce:null,noModule:ae,noValidate:ae,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:ae,optimum:z,pattern:null,ping:Se,placeholder:null,playsInline:ae,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:ae,referrerPolicy:null,rel:Se,required:ae,reversed:ae,rows:z,rowSpan:z,sandbox:Se,scope:null,scoped:ae,seamless:ae,selected:ae,shadowRootClonable:ae,shadowRootDelegatesFocus:ae,shadowRootMode:null,shape:null,size:z,sizes:null,slot:null,span:z,spellCheck:Le,src:null,srcDoc:null,srcLang:null,srcSet:null,start:z,step:null,style:null,tabIndex:z,target:null,title:null,translate:null,type:null,typeMustMatch:ae,useMap:null,value:Le,width:z,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Se,axis:null,background:null,bgColor:null,border:z,borderColor:null,bottomMargin:z,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:ae,declare:ae,event:null,face:null,frame:null,frameBorder:null,hSpace:z,leftMargin:z,link:null,longDesc:null,lowSrc:null,marginHeight:z,marginWidth:z,noResize:ae,noHref:ae,noShade:ae,noWrap:ae,object:null,profile:null,prompt:null,rev:null,rightMargin:z,rules:null,scheme:null,scrolling:Le,standby:null,summary:null,text:null,topMargin:z,valueType:null,version:null,vAlign:null,vLink:null,vSpace:z,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:ae,disableRemotePlayback:ae,prefix:null,property:null,results:z,security:null,unselectable:null},space:"html",transform:tc}),Op=Fn({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:at,accentHeight:z,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:z,amplitude:z,arabicForm:null,ascent:z,attributeName:null,attributeType:null,azimuth:z,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:z,by:null,calcMode:null,capHeight:z,className:Se,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:z,diffuseConstant:z,direction:null,display:null,dur:null,divisor:z,dominantBaseline:null,download:ae,dx:null,dy:null,edgeMode:null,editable:null,elevation:z,enableBackground:null,end:null,event:null,exponent:z,externalResourcesRequired:null,fill:null,fillOpacity:z,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Tn,g2:Tn,glyphName:Tn,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:z,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:z,horizOriginX:z,horizOriginY:z,id:null,ideographic:z,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:z,k:z,k1:z,k2:z,k3:z,k4:z,kernelMatrix:at,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:z,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:z,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:z,overlineThickness:z,paintOrder:null,panose1:null,path:null,pathLength:z,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Se,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:z,pointsAtY:z,pointsAtZ:z,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:at,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:at,rev:at,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:at,requiredFeatures:at,requiredFonts:at,requiredFormats:at,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:z,specularExponent:z,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:z,strikethroughThickness:z,string:null,stroke:null,strokeDashArray:at,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:z,strokeOpacity:z,strokeWidth:null,style:null,surfaceScale:z,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:at,tabIndex:z,tableValues:null,target:null,targetX:z,targetY:z,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:at,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:z,underlineThickness:z,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:z,values:null,vAlphabetic:z,vMathematical:z,vectorEffect:null,vHanging:z,vIdeographic:z,version:null,vertAdvY:z,vertOriginX:z,vertOriginY:z,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:z,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:ec}),nc=Fn({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(n,e){return"xlink:"+e.slice(5).toLowerCase()}}),ic=Fn({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:tc}),rc=Fn({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(n,e){return"xml:"+e.slice(3).toLowerCase()}}),Np={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},jp=/[A-Z]/g,ho=/-[a-z]/g,zp=/^data[-\w.:]+$/i;function Bp(n,e){const t=is(e);let i=e,r=it;if(t in n.normal)return n.property[n.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&zp.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(ho,Up);i="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!ho.test(s)){let a=s.replace(jp,Hp);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}r=Ds}return new r(i,e)}function Hp(n){return"-"+n.toLowerCase()}function Up(n){return n.charAt(1).toUpperCase()}const $p=Jl([Zl,Fp,nc,ic,rc],"html"),Ms=Jl([Zl,Op,nc,ic,rc],"svg");function qp(n){return n.join(" ").trim()}var yn={},yr,fo;function Vp(){if(fo)return yr;fo=1;var n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,t=/^\s*/,i=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,r=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,o=/^\s+|\s+$/g,l=`
`,c="/",u="*",h="",d="comment",f="declaration";yr=function(m,b){if(typeof m!="string")throw new TypeError("First argument must be a string");if(!m)return[];b=b||{};var y=1,x=1;function A(F){var M=F.match(e);M&&(y+=M.length);var N=F.lastIndexOf(l);x=~N?F.length-N:x+F.length}function k(){var F={line:y,column:x};return function(M){return M.position=new E(F),D(),M}}function E(F){this.start=F,this.end={line:y,column:x},this.source=b.source}E.prototype.content=m;function _(F){var M=new Error(b.source+":"+y+":"+x+": "+F);if(M.reason=F,M.filename=b.source,M.line=y,M.column=x,M.source=m,!b.silent)throw M}function P(F){var M=F.exec(m);if(M){var N=M[0];return A(N),m=m.slice(N.length),M}}function D(){P(t)}function O(F){var M;for(F=F||[];M=S();)M!==!1&&F.push(M);return F}function S(){var F=k();if(!(c!=m.charAt(0)||u!=m.charAt(1))){for(var M=2;h!=m.charAt(M)&&(u!=m.charAt(M)||c!=m.charAt(M+1));)++M;if(M+=2,h===m.charAt(M-1))return _("End of comment missing");var N=m.slice(2,M-2);return x+=2,A(N),m=m.slice(M),x+=2,F({type:d,comment:N})}}function R(){var F=k(),M=P(i);if(M){if(S(),!P(r))return _("property missing ':'");var N=P(s),V=F({type:f,property:g(M[0].replace(n,h)),value:N?g(N[0].replace(n,h)):h});return P(a),V}}function I(){var F=[];O(F);for(var M;M=R();)M!==!1&&(F.push(M),O(F));return F}return D(),I()};function g(m){return m?m.replace(o,h):h}return yr}var po;function Wp(){if(po)return yn;po=1;var n=yn&&yn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(yn,"__esModule",{value:!0}),yn.default=t;var e=n(Vp());function t(i,r){var s=null;if(!i||typeof i!="string")return s;var a=(0,e.default)(i),o=typeof r=="function";return a.forEach(function(l){if(l.type==="declaration"){var c=l.property,u=l.value;o?r(c,u,l):u&&(s=s||{},s[c]=u)}}),s}return yn}var Bn={},go;function Gp(){if(go)return Bn;go=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,t=/^[^-]+$/,i=/^-(webkit|moz|ms|o|khtml)-/,r=/^-(ms)-/,s=function(c){return!c||t.test(c)||n.test(c)},a=function(c,u){return u.toUpperCase()},o=function(c,u){return"".concat(u,"-")},l=function(c,u){return u===void 0&&(u={}),s(c)?c:(c=c.toLowerCase(),u.reactCompat?c=c.replace(r,o):c=c.replace(i,o),c.replace(e,a))};return Bn.camelCase=l,Bn}var Hn,mo;function Xp(){if(mo)return Hn;mo=1;var n=Hn&&Hn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},e=n(Wp()),t=Gp();function i(r,s){var a={};return!r||typeof r!="string"||(0,e.default)(r,function(o,l){o&&l&&(a[(0,t.camelCase)(o,s)]=l)}),a}return i.default=i,Hn=i,Hn}var Yp=Xp();const Kp=Rs(Yp),sc=ac("end"),Fs=ac("start");function ac(n){return e;function e(t){const i=t&&t.position&&t.position[n]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function Qp(n){const e=Fs(n),t=sc(n);if(e&&t)return{start:e,end:t}}function Yn(n){return!n||typeof n!="object"?"":"position"in n||"type"in n?yo(n.position):"start"in n||"end"in n?yo(n):"line"in n||"column"in n?as(n):""}function as(n){return bo(n&&n.line)+":"+bo(n&&n.column)}function yo(n){return as(n&&n.start)+"-"+as(n&&n.end)}function bo(n){return n&&typeof n=="number"?n:1}class Ge extends Error{constructor(e,t,i){super(),typeof t=="string"&&(i=t,t=void 0);let r="",s={},a=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof e=="string"?r=e:!s.cause&&e&&(a=!0,r=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof i=="string"){const l=i.indexOf(":");l===-1?s.ruleId=i:(s.source=i.slice(0,l),s.ruleId=i.slice(l+1))}if(!s.place&&s.ancestors&&s.ancestors){const l=s.ancestors[s.ancestors.length-1];l&&(s.place=l.position)}const o=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=r,this.line=o?o.line:void 0,this.name=Yn(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=a&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual,this.expected,this.note,this.url}}Ge.prototype.file="";Ge.prototype.name="";Ge.prototype.reason="";Ge.prototype.message="";Ge.prototype.stack="";Ge.prototype.column=void 0;Ge.prototype.line=void 0;Ge.prototype.ancestors=void 0;Ge.prototype.cause=void 0;Ge.prototype.fatal=void 0;Ge.prototype.place=void 0;Ge.prototype.ruleId=void 0;Ge.prototype.source=void 0;const Os={}.hasOwnProperty,Jp=new Map,Zp=/[A-Z]/g,eg=new Set(["table","tbody","thead","tfoot","tr"]),tg=new Set(["td","th"]),oc="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function ng(n,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=e.filePath||void 0;let i;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=ug(t,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=cg(t,e.jsx,e.jsxs)}const r={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:i,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?Ms:$p,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=lc(r,n,void 0);return s&&typeof s!="string"?s:r.create(n,r.Fragment,{children:s||void 0},void 0)}function lc(n,e,t){if(e.type==="element")return ig(n,e,t);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return rg(n,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return ag(n,e,t);if(e.type==="mdxjsEsm")return sg(n,e);if(e.type==="root")return og(n,e,t);if(e.type==="text")return lg(n,e)}function ig(n,e,t){const i=n.schema;let r=i;e.tagName.toLowerCase()==="svg"&&i.space==="html"&&(r=Ms,n.schema=r),n.ancestors.push(e);const s=uc(n,e.tagName,!1),a=hg(n,e);let o=js(n,e);return eg.has(e.tagName)&&(o=o.filter(function(l){return typeof l=="string"?!Dp(l):!0})),cc(n,a,s,e),Ns(a,o),n.ancestors.pop(),n.schema=i,n.create(e,s,a,t)}function rg(n,e){if(e.data&&e.data.estree&&n.evaluater){const i=e.data.estree.body[0];return i.type,n.evaluater.evaluateExpression(i.expression)}ai(n,e.position)}function sg(n,e){if(e.data&&e.data.estree&&n.evaluater)return n.evaluater.evaluateProgram(e.data.estree);ai(n,e.position)}function ag(n,e,t){const i=n.schema;let r=i;e.name==="svg"&&i.space==="html"&&(r=Ms,n.schema=r),n.ancestors.push(e);const s=e.name===null?n.Fragment:uc(n,e.name,!0),a=dg(n,e),o=js(n,e);return cc(n,a,s,e),Ns(a,o),n.ancestors.pop(),n.schema=i,n.create(e,s,a,t)}function og(n,e,t){const i={};return Ns(i,js(n,e)),n.create(e,n.Fragment,i,t)}function lg(n,e){return e.value}function cc(n,e,t,i){typeof t!="string"&&t!==n.Fragment&&n.passNode&&(e.node=i)}function Ns(n,e){if(e.length>0){const t=e.length>1?e:e[0];t&&(n.children=t)}}function cg(n,e,t){return i;function i(r,s,a,o){const c=Array.isArray(a.children)?t:e;return o?c(s,a,o):c(s,a)}}function ug(n,e){return t;function t(i,r,s,a){const o=Array.isArray(s.children),l=Fs(i);return e(r,s,a,o,{columnNumber:l?l.column-1:void 0,fileName:n,lineNumber:l?l.line:void 0},void 0)}}function hg(n,e){const t={};let i,r;for(r in e.properties)if(r!=="children"&&Os.call(e.properties,r)){const s=fg(n,r,e.properties[r]);if(s){const[a,o]=s;n.tableCellAlignToStyle&&a==="align"&&typeof o=="string"&&tg.has(e.tagName)?i=o:t[a]=o}}if(i){const s=t.style||(t.style={});s[n.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return t}function dg(n,e){const t={};for(const i of e.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&n.evaluater){const s=i.data.estree.body[0];s.type;const a=s.expression;a.type;const o=a.properties[0];o.type,Object.assign(t,n.evaluater.evaluateExpression(o.argument))}else ai(n,e.position);else{const r=i.name;let s;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&n.evaluater){const o=i.value.data.estree.body[0];o.type,s=n.evaluater.evaluateExpression(o.expression)}else ai(n,e.position);else s=i.value===null?!0:i.value;t[r]=s}return t}function js(n,e){const t=[];let i=-1;const r=n.passKeys?new Map:Jp;for(;++i<e.children.length;){const s=e.children[i];let a;if(n.passKeys){const l=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(l){const c=r.get(l)||0;a=l+"-"+c,r.set(l,c+1)}}const o=lc(n,s,a);o!==void 0&&t.push(o)}return t}function fg(n,e,t){const i=Bp(n.schema,e);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=i.commaSeparated?Tp(t):qp(t)),i.property==="style"){let r=typeof t=="object"?t:pg(n,String(t));return n.stylePropertyNameCase==="css"&&(r=gg(r)),["style",r]}return[n.elementAttributeNameCase==="react"&&i.space?Np[i.property]||i.property:i.attribute,t]}}function pg(n,e){try{return Kp(e,{reactCompat:!0})}catch(t){if(n.ignoreInvalidStyle)return{};const i=t,r=new Ge("Cannot parse `style` attribute",{ancestors:n.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw r.file=n.filePath||void 0,r.url=oc+"#cannot-parse-style-attribute",r}}function uc(n,e,t){let i;if(!t)i={type:"Literal",value:e};else if(e.includes(".")){const r=e.split(".");let s=-1,a;for(;++s<r.length;){const o=lo(r[s])?{type:"Identifier",name:r[s]}:{type:"Literal",value:r[s]};a=a?{type:"MemberExpression",object:a,property:o,computed:!!(s&&o.type==="Literal"),optional:!1}:o}i=a}else i=lo(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(i.type==="Literal"){const r=i.value;return Os.call(n.components,r)?n.components[r]:r}if(n.evaluater)return n.evaluater.evaluateExpression(i);ai(n)}function ai(n,e){const t=new Ge("Cannot handle MDX estrees without `createEvaluater`",{ancestors:n.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=n.filePath||void 0,t.url=oc+"#cannot-handle-mdx-estrees-without-createevaluater",t}function gg(n){const e={};let t;for(t in n)Os.call(n,t)&&(e[mg(t)]=n[t]);return e}function mg(n){let e=n.replace(Zp,yg);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function yg(n){return"-"+n.toLowerCase()}const br={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},bg={};function zs(n,e){const t=bg,i=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,r=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return hc(n,i,r)}function hc(n,e,t){if(xg(n)){if("value"in n)return n.type==="html"&&!t?"":n.value;if(e&&"alt"in n&&n.alt)return n.alt;if("children"in n)return xo(n.children,e,t)}return Array.isArray(n)?xo(n,e,t):""}function xo(n,e,t){const i=[];let r=-1;for(;++r<n.length;)i[r]=hc(n[r],e,t);return i.join("")}function xg(n){return!!(n&&typeof n=="object")}const wo=document.createElement("i");function Bs(n){const e="&"+n+";";wo.innerHTML=e;const t=wo.textContent;return t.charCodeAt(t.length-1)===59&&n!=="semi"||t===e?!1:t}function lt(n,e,t,i){const r=n.length;let s=0,a;if(e<0?e=-e>r?0:r+e:e=e>r?r:e,t=t>0?t:0,i.length<1e4)a=Array.from(i),a.unshift(e,t),n.splice(...a);else for(t&&n.splice(e,t);s<i.length;)a=i.slice(s,s+1e4),a.unshift(e,0),n.splice(...a),s+=1e4,e+=1e4}function ft(n,e){return n.length>0?(lt(n,n.length,0,e),n):e}const vo={}.hasOwnProperty;function dc(n){const e={};let t=-1;for(;++t<n.length;)wg(e,n[t]);return e}function wg(n,e){let t;for(t in e){const r=(vo.call(n,t)?n[t]:void 0)||(n[t]={}),s=e[t];let a;if(s)for(a in s){vo.call(r,a)||(r[a]=[]);const o=s[a];vg(r[a],Array.isArray(o)?o:o?[o]:[])}}}function vg(n,e){let t=-1;const i=[];for(;++t<e.length;)(e[t].add==="after"?n:i).push(e[t]);lt(n,0,0,i)}function fc(n,e){const t=Number.parseInt(n,e);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"�":String.fromCodePoint(t)}function bt(n){return n.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Ke=Wt(/[A-Za-z]/),Ve=Wt(/[\dA-Za-z]/),Ag=Wt(/[#-'*+\--9=?A-Z^-~]/);function Hi(n){return n!==null&&(n<32||n===127)}const os=Wt(/\d/),_g=Wt(/[\dA-Fa-f]/),Sg=Wt(/[!-/:-@[-`{-~]/);function J(n){return n!==null&&n<-2}function ve(n){return n!==null&&(n<0||n===32)}function ue(n){return n===-2||n===-1||n===32}const Gi=Wt(/\p{P}|\p{S}/u),ln=Wt(/\s/);function Wt(n){return e;function e(t){return t!==null&&t>-1&&n.test(String.fromCharCode(t))}}function On(n){const e=[];let t=-1,i=0,r=0;for(;++t<n.length;){const s=n.charCodeAt(t);let a="";if(s===37&&Ve(n.charCodeAt(t+1))&&Ve(n.charCodeAt(t+2)))r=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(a=String.fromCharCode(s));else if(s>55295&&s<57344){const o=n.charCodeAt(t+1);s<56320&&o>56319&&o<57344?(a=String.fromCharCode(s,o),r=1):a="�"}else a=String.fromCharCode(s);a&&(e.push(n.slice(i,t),encodeURIComponent(a)),i=t+r+1,a=""),r&&(t+=r,r=0)}return e.join("")+n.slice(i)}function pe(n,e,t,i){const r=i?i-1:Number.POSITIVE_INFINITY;let s=0;return a;function a(l){return ue(l)?(n.enter(t),o(l)):e(l)}function o(l){return ue(l)&&s++<r?(n.consume(l),o):(n.exit(t),e(l))}}const kg={tokenize:Eg};function Eg(n){const e=n.attempt(this.parser.constructs.contentInitial,i,r);let t;return e;function i(o){if(o===null){n.consume(o);return}return n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),pe(n,e,"linePrefix")}function r(o){return n.enter("paragraph"),s(o)}function s(o){const l=n.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=l),t=l,a(o)}function a(o){if(o===null){n.exit("chunkText"),n.exit("paragraph"),n.consume(o);return}return J(o)?(n.consume(o),n.exit("chunkText"),s):(n.consume(o),a)}}const Cg={tokenize:Tg},Ao={tokenize:Pg};function Tg(n){const e=this,t=[];let i=0,r,s,a;return o;function o(A){if(i<t.length){const k=t[i];return e.containerState=k[1],n.attempt(k[0].continuation,l,c)(A)}return c(A)}function l(A){if(i++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,r&&x();const k=e.events.length;let E=k,_;for(;E--;)if(e.events[E][0]==="exit"&&e.events[E][1].type==="chunkFlow"){_=e.events[E][1].end;break}y(i);let P=k;for(;P<e.events.length;)e.events[P][1].end={..._},P++;return lt(e.events,E+1,0,e.events.slice(k)),e.events.length=P,c(A)}return o(A)}function c(A){if(i===t.length){if(!r)return d(A);if(r.currentConstruct&&r.currentConstruct.concrete)return g(A);e.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return e.containerState={},n.check(Ao,u,h)(A)}function u(A){return r&&x(),y(i),d(A)}function h(A){return e.parser.lazy[e.now().line]=i!==t.length,a=e.now().offset,g(A)}function d(A){return e.containerState={},n.attempt(Ao,f,g)(A)}function f(A){return i++,t.push([e.currentConstruct,e.containerState]),d(A)}function g(A){if(A===null){r&&x(),y(0),n.consume(A);return}return r=r||e.parser.flow(e.now()),n.enter("chunkFlow",{_tokenizer:r,contentType:"flow",previous:s}),m(A)}function m(A){if(A===null){b(n.exit("chunkFlow"),!0),y(0),n.consume(A);return}return J(A)?(n.consume(A),b(n.exit("chunkFlow")),i=0,e.interrupt=void 0,o):(n.consume(A),m)}function b(A,k){const E=e.sliceStream(A);if(k&&E.push(null),A.previous=s,s&&(s.next=A),s=A,r.defineSkip(A.start),r.write(E),e.parser.lazy[A.start.line]){let _=r.events.length;for(;_--;)if(r.events[_][1].start.offset<a&&(!r.events[_][1].end||r.events[_][1].end.offset>a))return;const P=e.events.length;let D=P,O,S;for(;D--;)if(e.events[D][0]==="exit"&&e.events[D][1].type==="chunkFlow"){if(O){S=e.events[D][1].end;break}O=!0}for(y(i),_=P;_<e.events.length;)e.events[_][1].end={...S},_++;lt(e.events,D+1,0,e.events.slice(P)),e.events.length=_}}function y(A){let k=t.length;for(;k-- >A;){const E=t[k];e.containerState=E[1],E[0].exit.call(e,n)}t.length=A}function x(){r.write([null]),s=void 0,r=void 0,e.containerState._closeFlow=void 0}}function Pg(n,e,t){return pe(n,n.attempt(this.parser.constructs.document,e,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Ln(n){if(n===null||ve(n)||ln(n))return 1;if(Gi(n))return 2}function Xi(n,e,t){const i=[];let r=-1;for(;++r<n.length;){const s=n[r].resolveAll;s&&!i.includes(s)&&(e=s(e,t),i.push(s))}return e}const ls={name:"attention",resolveAll:Rg,tokenize:Ig};function Rg(n,e){let t=-1,i,r,s,a,o,l,c,u;for(;++t<n.length;)if(n[t][0]==="enter"&&n[t][1].type==="attentionSequence"&&n[t][1]._close){for(i=t;i--;)if(n[i][0]==="exit"&&n[i][1].type==="attentionSequence"&&n[i][1]._open&&e.sliceSerialize(n[i][1]).charCodeAt(0)===e.sliceSerialize(n[t][1]).charCodeAt(0)){if((n[i][1]._close||n[t][1]._open)&&(n[t][1].end.offset-n[t][1].start.offset)%3&&!((n[i][1].end.offset-n[i][1].start.offset+n[t][1].end.offset-n[t][1].start.offset)%3))continue;l=n[i][1].end.offset-n[i][1].start.offset>1&&n[t][1].end.offset-n[t][1].start.offset>1?2:1;const h={...n[i][1].end},d={...n[t][1].start};_o(h,-l),_o(d,l),a={type:l>1?"strongSequence":"emphasisSequence",start:h,end:{...n[i][1].end}},o={type:l>1?"strongSequence":"emphasisSequence",start:{...n[t][1].start},end:d},s={type:l>1?"strongText":"emphasisText",start:{...n[i][1].end},end:{...n[t][1].start}},r={type:l>1?"strong":"emphasis",start:{...a.start},end:{...o.end}},n[i][1].end={...a.start},n[t][1].start={...o.end},c=[],n[i][1].end.offset-n[i][1].start.offset&&(c=ft(c,[["enter",n[i][1],e],["exit",n[i][1],e]])),c=ft(c,[["enter",r,e],["enter",a,e],["exit",a,e],["enter",s,e]]),c=ft(c,Xi(e.parser.constructs.insideSpan.null,n.slice(i+1,t),e)),c=ft(c,[["exit",s,e],["enter",o,e],["exit",o,e],["exit",r,e]]),n[t][1].end.offset-n[t][1].start.offset?(u=2,c=ft(c,[["enter",n[t][1],e],["exit",n[t][1],e]])):u=0,lt(n,i-1,t-i+3,c),t=i+c.length-u-2;break}}for(t=-1;++t<n.length;)n[t][1].type==="attentionSequence"&&(n[t][1].type="data");return n}function Ig(n,e){const t=this.parser.constructs.attentionMarkers.null,i=this.previous,r=Ln(i);let s;return a;function a(l){return s=l,n.enter("attentionSequence"),o(l)}function o(l){if(l===s)return n.consume(l),o;const c=n.exit("attentionSequence"),u=Ln(l),h=!u||u===2&&r||t.includes(l),d=!r||r===2&&u||t.includes(i);return c._open=!!(s===42?h:h&&(r||!d)),c._close=!!(s===42?d:d&&(u||!h)),e(l)}}function _o(n,e){n.column+=e,n.offset+=e,n._bufferIndex+=e}const Lg={name:"autolink",tokenize:Dg};function Dg(n,e,t){let i=0;return r;function r(f){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(f),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),s}function s(f){return Ke(f)?(n.consume(f),a):f===64?t(f):c(f)}function a(f){return f===43||f===45||f===46||Ve(f)?(i=1,o(f)):c(f)}function o(f){return f===58?(n.consume(f),i=0,l):(f===43||f===45||f===46||Ve(f))&&i++<32?(n.consume(f),o):(i=0,c(f))}function l(f){return f===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(f),n.exit("autolinkMarker"),n.exit("autolink"),e):f===null||f===32||f===60||Hi(f)?t(f):(n.consume(f),l)}function c(f){return f===64?(n.consume(f),u):Ag(f)?(n.consume(f),c):t(f)}function u(f){return Ve(f)?h(f):t(f)}function h(f){return f===46?(n.consume(f),i=0,u):f===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(f),n.exit("autolinkMarker"),n.exit("autolink"),e):d(f)}function d(f){if((f===45||Ve(f))&&i++<63){const g=f===45?d:h;return n.consume(f),g}return t(f)}}const ui={partial:!0,tokenize:Mg};function Mg(n,e,t){return i;function i(s){return ue(s)?pe(n,r,"linePrefix")(s):r(s)}function r(s){return s===null||J(s)?e(s):t(s)}}const pc={continuation:{tokenize:Og},exit:Ng,name:"blockQuote",tokenize:Fg};function Fg(n,e,t){const i=this;return r;function r(a){if(a===62){const o=i.containerState;return o.open||(n.enter("blockQuote",{_container:!0}),o.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(a),n.exit("blockQuoteMarker"),s}return t(a)}function s(a){return ue(a)?(n.enter("blockQuotePrefixWhitespace"),n.consume(a),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),e):(n.exit("blockQuotePrefix"),e(a))}}function Og(n,e,t){const i=this;return r;function r(a){return ue(a)?pe(n,s,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):s(a)}function s(a){return n.attempt(pc,e,t)(a)}}function Ng(n){n.exit("blockQuote")}const gc={name:"characterEscape",tokenize:jg};function jg(n,e,t){return i;function i(s){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(s),n.exit("escapeMarker"),r}function r(s){return Sg(s)?(n.enter("characterEscapeValue"),n.consume(s),n.exit("characterEscapeValue"),n.exit("characterEscape"),e):t(s)}}const mc={name:"characterReference",tokenize:zg};function zg(n,e,t){const i=this;let r=0,s,a;return o;function o(h){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(h),n.exit("characterReferenceMarker"),l}function l(h){return h===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(h),n.exit("characterReferenceMarkerNumeric"),c):(n.enter("characterReferenceValue"),s=31,a=Ve,u(h))}function c(h){return h===88||h===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(h),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),s=6,a=_g,u):(n.enter("characterReferenceValue"),s=7,a=os,u(h))}function u(h){if(h===59&&r){const d=n.exit("characterReferenceValue");return a===Ve&&!Bs(i.sliceSerialize(d))?t(h):(n.enter("characterReferenceMarker"),n.consume(h),n.exit("characterReferenceMarker"),n.exit("characterReference"),e)}return a(h)&&r++<s?(n.consume(h),u):t(h)}}const So={partial:!0,tokenize:Hg},ko={concrete:!0,name:"codeFenced",tokenize:Bg};function Bg(n,e,t){const i=this,r={partial:!0,tokenize:E};let s=0,a=0,o;return l;function l(_){return c(_)}function c(_){const P=i.events[i.events.length-1];return s=P&&P[1].type==="linePrefix"?P[2].sliceSerialize(P[1],!0).length:0,o=_,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),u(_)}function u(_){return _===o?(a++,n.consume(_),u):a<3?t(_):(n.exit("codeFencedFenceSequence"),ue(_)?pe(n,h,"whitespace")(_):h(_))}function h(_){return _===null||J(_)?(n.exit("codeFencedFence"),i.interrupt?e(_):n.check(So,m,k)(_)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),d(_))}function d(_){return _===null||J(_)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),h(_)):ue(_)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),pe(n,f,"whitespace")(_)):_===96&&_===o?t(_):(n.consume(_),d)}function f(_){return _===null||J(_)?h(_):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),g(_))}function g(_){return _===null||J(_)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),h(_)):_===96&&_===o?t(_):(n.consume(_),g)}function m(_){return n.attempt(r,k,b)(_)}function b(_){return n.enter("lineEnding"),n.consume(_),n.exit("lineEnding"),y}function y(_){return s>0&&ue(_)?pe(n,x,"linePrefix",s+1)(_):x(_)}function x(_){return _===null||J(_)?n.check(So,m,k)(_):(n.enter("codeFlowValue"),A(_))}function A(_){return _===null||J(_)?(n.exit("codeFlowValue"),x(_)):(n.consume(_),A)}function k(_){return n.exit("codeFenced"),e(_)}function E(_,P,D){let O=0;return S;function S(N){return _.enter("lineEnding"),_.consume(N),_.exit("lineEnding"),R}function R(N){return _.enter("codeFencedFence"),ue(N)?pe(_,I,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):I(N)}function I(N){return N===o?(_.enter("codeFencedFenceSequence"),F(N)):D(N)}function F(N){return N===o?(O++,_.consume(N),F):O>=a?(_.exit("codeFencedFenceSequence"),ue(N)?pe(_,M,"whitespace")(N):M(N)):D(N)}function M(N){return N===null||J(N)?(_.exit("codeFencedFence"),P(N)):D(N)}}}function Hg(n,e,t){const i=this;return r;function r(a){return a===null?t(a):(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),s)}function s(a){return i.parser.lazy[i.now().line]?t(a):e(a)}}const xr={name:"codeIndented",tokenize:$g},Ug={partial:!0,tokenize:qg};function $g(n,e,t){const i=this;return r;function r(c){return n.enter("codeIndented"),pe(n,s,"linePrefix",5)(c)}function s(c){const u=i.events[i.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?a(c):t(c)}function a(c){return c===null?l(c):J(c)?n.attempt(Ug,a,l)(c):(n.enter("codeFlowValue"),o(c))}function o(c){return c===null||J(c)?(n.exit("codeFlowValue"),a(c)):(n.consume(c),o)}function l(c){return n.exit("codeIndented"),e(c)}}function qg(n,e,t){const i=this;return r;function r(a){return i.parser.lazy[i.now().line]?t(a):J(a)?(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),r):pe(n,s,"linePrefix",5)(a)}function s(a){const o=i.events[i.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?e(a):J(a)?r(a):t(a)}}const Vg={name:"codeText",previous:Gg,resolve:Wg,tokenize:Xg};function Wg(n){let e=n.length-4,t=3,i,r;if((n[t][1].type==="lineEnding"||n[t][1].type==="space")&&(n[e][1].type==="lineEnding"||n[e][1].type==="space")){for(i=t;++i<e;)if(n[i][1].type==="codeTextData"){n[t][1].type="codeTextPadding",n[e][1].type="codeTextPadding",t+=2,e-=2;break}}for(i=t-1,e++;++i<=e;)r===void 0?i!==e&&n[i][1].type!=="lineEnding"&&(r=i):(i===e||n[i][1].type==="lineEnding")&&(n[r][1].type="codeTextData",i!==r+2&&(n[r][1].end=n[i-1][1].end,n.splice(r+2,i-r-2),e-=i-r-2,i=r+2),r=void 0);return n}function Gg(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Xg(n,e,t){let i=0,r,s;return a;function a(h){return n.enter("codeText"),n.enter("codeTextSequence"),o(h)}function o(h){return h===96?(n.consume(h),i++,o):(n.exit("codeTextSequence"),l(h))}function l(h){return h===null?t(h):h===32?(n.enter("space"),n.consume(h),n.exit("space"),l):h===96?(s=n.enter("codeTextSequence"),r=0,u(h)):J(h)?(n.enter("lineEnding"),n.consume(h),n.exit("lineEnding"),l):(n.enter("codeTextData"),c(h))}function c(h){return h===null||h===32||h===96||J(h)?(n.exit("codeTextData"),l(h)):(n.consume(h),c)}function u(h){return h===96?(n.consume(h),r++,u):r===i?(n.exit("codeTextSequence"),n.exit("codeText"),e(h)):(s.type="codeTextData",c(h))}}class Yg{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const i=t??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(e,i):e>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(e,t,i){const r=t||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return i&&Un(this.left,i),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Un(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Un(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);Un(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Un(this.left,t.reverse())}}}function Un(n,e){let t=0;if(e.length<1e4)n.push(...e);else for(;t<e.length;)n.push(...e.slice(t,t+1e4)),t+=1e4}function yc(n){const e={};let t=-1,i,r,s,a,o,l,c;const u=new Yg(n);for(;++t<u.length;){for(;t in e;)t=e[t];if(i=u.get(t),t&&i[1].type==="chunkFlow"&&u.get(t-1)[1].type==="listItemPrefix"&&(l=i[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(i[0]==="enter")i[1].contentType&&(Object.assign(e,Kg(u,t)),t=e[t],c=!0);else if(i[1]._container){for(s=t,r=void 0;s--;)if(a=u.get(s),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(r&&(u.get(r)[1].type="lineEndingBlank"),a[1].type="lineEnding",r=s);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;r&&(i[1].end={...u.get(r)[1].start},o=u.slice(r,t),o.unshift(i),u.splice(r,t-r+1,o))}}return lt(n,0,Number.POSITIVE_INFINITY,u.slice(0)),!c}function Kg(n,e){const t=n.get(e)[1],i=n.get(e)[2];let r=e-1;const s=[];let a=t._tokenizer;a||(a=i.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const o=a.events,l=[],c={};let u,h,d=-1,f=t,g=0,m=0;const b=[m];for(;f;){for(;n.get(++r)[1]!==f;);s.push(r),f._tokenizer||(u=i.sliceStream(f),f.next||u.push(null),h&&a.defineSkip(f.start),f._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(u),f._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),h=f,f=f.next}for(f=t;++d<o.length;)o[d][0]==="exit"&&o[d-1][0]==="enter"&&o[d][1].type===o[d-1][1].type&&o[d][1].start.line!==o[d][1].end.line&&(m=d+1,b.push(m),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(a.events=[],f?(f._tokenizer=void 0,f.previous=void 0):b.pop(),d=b.length;d--;){const y=o.slice(b[d],b[d+1]),x=s.pop();l.push([x,x+y.length-1]),n.splice(x,2,y)}for(l.reverse(),d=-1;++d<l.length;)c[g+l[d][0]]=g+l[d][1],g+=l[d][1]-l[d][0]-1;return c}const Qg={resolve:Zg,tokenize:em},Jg={partial:!0,tokenize:tm};function Zg(n){return yc(n),n}function em(n,e){let t;return i;function i(o){return n.enter("content"),t=n.enter("chunkContent",{contentType:"content"}),r(o)}function r(o){return o===null?s(o):J(o)?n.check(Jg,a,s)(o):(n.consume(o),r)}function s(o){return n.exit("chunkContent"),n.exit("content"),e(o)}function a(o){return n.consume(o),n.exit("chunkContent"),t.next=n.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,r}}function tm(n,e,t){const i=this;return r;function r(a){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),pe(n,s,"linePrefix")}function s(a){if(a===null||J(a))return t(a);const o=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?e(a):n.interrupt(i.parser.constructs.flow,t,e)(a)}}function bc(n,e,t,i,r,s,a,o,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return h;function h(y){return y===60?(n.enter(i),n.enter(r),n.enter(s),n.consume(y),n.exit(s),d):y===null||y===32||y===41||Hi(y)?t(y):(n.enter(i),n.enter(a),n.enter(o),n.enter("chunkString",{contentType:"string"}),m(y))}function d(y){return y===62?(n.enter(s),n.consume(y),n.exit(s),n.exit(r),n.exit(i),e):(n.enter(o),n.enter("chunkString",{contentType:"string"}),f(y))}function f(y){return y===62?(n.exit("chunkString"),n.exit(o),d(y)):y===null||y===60||J(y)?t(y):(n.consume(y),y===92?g:f)}function g(y){return y===60||y===62||y===92?(n.consume(y),f):f(y)}function m(y){return!u&&(y===null||y===41||ve(y))?(n.exit("chunkString"),n.exit(o),n.exit(a),n.exit(i),e(y)):u<c&&y===40?(n.consume(y),u++,m):y===41?(n.consume(y),u--,m):y===null||y===32||y===40||Hi(y)?t(y):(n.consume(y),y===92?b:m)}function b(y){return y===40||y===41||y===92?(n.consume(y),m):m(y)}}function xc(n,e,t,i,r,s){const a=this;let o=0,l;return c;function c(f){return n.enter(i),n.enter(r),n.consume(f),n.exit(r),n.enter(s),u}function u(f){return o>999||f===null||f===91||f===93&&!l||f===94&&!o&&"_hiddenFootnoteSupport"in a.parser.constructs?t(f):f===93?(n.exit(s),n.enter(r),n.consume(f),n.exit(r),n.exit(i),e):J(f)?(n.enter("lineEnding"),n.consume(f),n.exit("lineEnding"),u):(n.enter("chunkString",{contentType:"string"}),h(f))}function h(f){return f===null||f===91||f===93||J(f)||o++>999?(n.exit("chunkString"),u(f)):(n.consume(f),l||(l=!ue(f)),f===92?d:h)}function d(f){return f===91||f===92||f===93?(n.consume(f),o++,h):h(f)}}function wc(n,e,t,i,r,s){let a;return o;function o(d){return d===34||d===39||d===40?(n.enter(i),n.enter(r),n.consume(d),n.exit(r),a=d===40?41:d,l):t(d)}function l(d){return d===a?(n.enter(r),n.consume(d),n.exit(r),n.exit(i),e):(n.enter(s),c(d))}function c(d){return d===a?(n.exit(s),l(a)):d===null?t(d):J(d)?(n.enter("lineEnding"),n.consume(d),n.exit("lineEnding"),pe(n,c,"linePrefix")):(n.enter("chunkString",{contentType:"string"}),u(d))}function u(d){return d===a||d===null||J(d)?(n.exit("chunkString"),c(d)):(n.consume(d),d===92?h:u)}function h(d){return d===a||d===92?(n.consume(d),u):u(d)}}function Kn(n,e){let t;return i;function i(r){return J(r)?(n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),t=!0,i):ue(r)?pe(n,i,t?"linePrefix":"lineSuffix")(r):e(r)}}const nm={name:"definition",tokenize:rm},im={partial:!0,tokenize:sm};function rm(n,e,t){const i=this;let r;return s;function s(f){return n.enter("definition"),a(f)}function a(f){return xc.call(i,n,o,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(f)}function o(f){return r=bt(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),f===58?(n.enter("definitionMarker"),n.consume(f),n.exit("definitionMarker"),l):t(f)}function l(f){return ve(f)?Kn(n,c)(f):c(f)}function c(f){return bc(n,u,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(f)}function u(f){return n.attempt(im,h,h)(f)}function h(f){return ue(f)?pe(n,d,"whitespace")(f):d(f)}function d(f){return f===null||J(f)?(n.exit("definition"),i.parser.defined.push(r),e(f)):t(f)}}function sm(n,e,t){return i;function i(o){return ve(o)?Kn(n,r)(o):t(o)}function r(o){return wc(n,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function s(o){return ue(o)?pe(n,a,"whitespace")(o):a(o)}function a(o){return o===null||J(o)?e(o):t(o)}}const am={name:"hardBreakEscape",tokenize:om};function om(n,e,t){return i;function i(s){return n.enter("hardBreakEscape"),n.consume(s),r}function r(s){return J(s)?(n.exit("hardBreakEscape"),e(s)):t(s)}}const lm={name:"headingAtx",resolve:cm,tokenize:um};function cm(n,e){let t=n.length-2,i=3,r,s;return n[i][1].type==="whitespace"&&(i+=2),t-2>i&&n[t][1].type==="whitespace"&&(t-=2),n[t][1].type==="atxHeadingSequence"&&(i===t-1||t-4>i&&n[t-2][1].type==="whitespace")&&(t-=i+1===t?2:4),t>i&&(r={type:"atxHeadingText",start:n[i][1].start,end:n[t][1].end},s={type:"chunkText",start:n[i][1].start,end:n[t][1].end,contentType:"text"},lt(n,i,t-i+1,[["enter",r,e],["enter",s,e],["exit",s,e],["exit",r,e]])),n}function um(n,e,t){let i=0;return r;function r(u){return n.enter("atxHeading"),s(u)}function s(u){return n.enter("atxHeadingSequence"),a(u)}function a(u){return u===35&&i++<6?(n.consume(u),a):u===null||ve(u)?(n.exit("atxHeadingSequence"),o(u)):t(u)}function o(u){return u===35?(n.enter("atxHeadingSequence"),l(u)):u===null||J(u)?(n.exit("atxHeading"),e(u)):ue(u)?pe(n,o,"whitespace")(u):(n.enter("atxHeadingText"),c(u))}function l(u){return u===35?(n.consume(u),l):(n.exit("atxHeadingSequence"),o(u))}function c(u){return u===null||u===35||ve(u)?(n.exit("atxHeadingText"),o(u)):(n.consume(u),c)}}const hm=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Eo=["pre","script","style","textarea"],dm={concrete:!0,name:"htmlFlow",resolveTo:gm,tokenize:mm},fm={partial:!0,tokenize:bm},pm={partial:!0,tokenize:ym};function gm(n){let e=n.length;for(;e--&&!(n[e][0]==="enter"&&n[e][1].type==="htmlFlow"););return e>1&&n[e-2][1].type==="linePrefix"&&(n[e][1].start=n[e-2][1].start,n[e+1][1].start=n[e-2][1].start,n.splice(e-2,2)),n}function mm(n,e,t){const i=this;let r,s,a,o,l;return c;function c(w){return u(w)}function u(w){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(w),h}function h(w){return w===33?(n.consume(w),d):w===47?(n.consume(w),s=!0,m):w===63?(n.consume(w),r=3,i.interrupt?e:v):Ke(w)?(n.consume(w),a=String.fromCharCode(w),b):t(w)}function d(w){return w===45?(n.consume(w),r=2,f):w===91?(n.consume(w),r=5,o=0,g):Ke(w)?(n.consume(w),r=4,i.interrupt?e:v):t(w)}function f(w){return w===45?(n.consume(w),i.interrupt?e:v):t(w)}function g(w){const ne="CDATA[";return w===ne.charCodeAt(o++)?(n.consume(w),o===ne.length?i.interrupt?e:I:g):t(w)}function m(w){return Ke(w)?(n.consume(w),a=String.fromCharCode(w),b):t(w)}function b(w){if(w===null||w===47||w===62||ve(w)){const ne=w===47,$=a.toLowerCase();return!ne&&!s&&Eo.includes($)?(r=1,i.interrupt?e(w):I(w)):hm.includes(a.toLowerCase())?(r=6,ne?(n.consume(w),y):i.interrupt?e(w):I(w)):(r=7,i.interrupt&&!i.parser.lazy[i.now().line]?t(w):s?x(w):A(w))}return w===45||Ve(w)?(n.consume(w),a+=String.fromCharCode(w),b):t(w)}function y(w){return w===62?(n.consume(w),i.interrupt?e:I):t(w)}function x(w){return ue(w)?(n.consume(w),x):S(w)}function A(w){return w===47?(n.consume(w),S):w===58||w===95||Ke(w)?(n.consume(w),k):ue(w)?(n.consume(w),A):S(w)}function k(w){return w===45||w===46||w===58||w===95||Ve(w)?(n.consume(w),k):E(w)}function E(w){return w===61?(n.consume(w),_):ue(w)?(n.consume(w),E):A(w)}function _(w){return w===null||w===60||w===61||w===62||w===96?t(w):w===34||w===39?(n.consume(w),l=w,P):ue(w)?(n.consume(w),_):D(w)}function P(w){return w===l?(n.consume(w),l=null,O):w===null||J(w)?t(w):(n.consume(w),P)}function D(w){return w===null||w===34||w===39||w===47||w===60||w===61||w===62||w===96||ve(w)?E(w):(n.consume(w),D)}function O(w){return w===47||w===62||ue(w)?A(w):t(w)}function S(w){return w===62?(n.consume(w),R):t(w)}function R(w){return w===null||J(w)?I(w):ue(w)?(n.consume(w),R):t(w)}function I(w){return w===45&&r===2?(n.consume(w),V):w===60&&r===1?(n.consume(w),B):w===62&&r===4?(n.consume(w),G):w===63&&r===3?(n.consume(w),v):w===93&&r===5?(n.consume(w),U):J(w)&&(r===6||r===7)?(n.exit("htmlFlowData"),n.check(fm,X,F)(w)):w===null||J(w)?(n.exit("htmlFlowData"),F(w)):(n.consume(w),I)}function F(w){return n.check(pm,M,X)(w)}function M(w){return n.enter("lineEnding"),n.consume(w),n.exit("lineEnding"),N}function N(w){return w===null||J(w)?F(w):(n.enter("htmlFlowData"),I(w))}function V(w){return w===45?(n.consume(w),v):I(w)}function B(w){return w===47?(n.consume(w),a="",q):I(w)}function q(w){if(w===62){const ne=a.toLowerCase();return Eo.includes(ne)?(n.consume(w),G):I(w)}return Ke(w)&&a.length<8?(n.consume(w),a+=String.fromCharCode(w),q):I(w)}function U(w){return w===93?(n.consume(w),v):I(w)}function v(w){return w===62?(n.consume(w),G):w===45&&r===2?(n.consume(w),v):I(w)}function G(w){return w===null||J(w)?(n.exit("htmlFlowData"),X(w)):(n.consume(w),G)}function X(w){return n.exit("htmlFlow"),e(w)}}function ym(n,e,t){const i=this;return r;function r(a){return J(a)?(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),s):t(a)}function s(a){return i.parser.lazy[i.now().line]?t(a):e(a)}}function bm(n,e,t){return i;function i(r){return n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),n.attempt(ui,e,t)}}const xm={name:"htmlText",tokenize:wm};function wm(n,e,t){const i=this;let r,s,a;return o;function o(v){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(v),l}function l(v){return v===33?(n.consume(v),c):v===47?(n.consume(v),E):v===63?(n.consume(v),A):Ke(v)?(n.consume(v),D):t(v)}function c(v){return v===45?(n.consume(v),u):v===91?(n.consume(v),s=0,g):Ke(v)?(n.consume(v),x):t(v)}function u(v){return v===45?(n.consume(v),f):t(v)}function h(v){return v===null?t(v):v===45?(n.consume(v),d):J(v)?(a=h,B(v)):(n.consume(v),h)}function d(v){return v===45?(n.consume(v),f):h(v)}function f(v){return v===62?V(v):v===45?d(v):h(v)}function g(v){const G="CDATA[";return v===G.charCodeAt(s++)?(n.consume(v),s===G.length?m:g):t(v)}function m(v){return v===null?t(v):v===93?(n.consume(v),b):J(v)?(a=m,B(v)):(n.consume(v),m)}function b(v){return v===93?(n.consume(v),y):m(v)}function y(v){return v===62?V(v):v===93?(n.consume(v),y):m(v)}function x(v){return v===null||v===62?V(v):J(v)?(a=x,B(v)):(n.consume(v),x)}function A(v){return v===null?t(v):v===63?(n.consume(v),k):J(v)?(a=A,B(v)):(n.consume(v),A)}function k(v){return v===62?V(v):A(v)}function E(v){return Ke(v)?(n.consume(v),_):t(v)}function _(v){return v===45||Ve(v)?(n.consume(v),_):P(v)}function P(v){return J(v)?(a=P,B(v)):ue(v)?(n.consume(v),P):V(v)}function D(v){return v===45||Ve(v)?(n.consume(v),D):v===47||v===62||ve(v)?O(v):t(v)}function O(v){return v===47?(n.consume(v),V):v===58||v===95||Ke(v)?(n.consume(v),S):J(v)?(a=O,B(v)):ue(v)?(n.consume(v),O):V(v)}function S(v){return v===45||v===46||v===58||v===95||Ve(v)?(n.consume(v),S):R(v)}function R(v){return v===61?(n.consume(v),I):J(v)?(a=R,B(v)):ue(v)?(n.consume(v),R):O(v)}function I(v){return v===null||v===60||v===61||v===62||v===96?t(v):v===34||v===39?(n.consume(v),r=v,F):J(v)?(a=I,B(v)):ue(v)?(n.consume(v),I):(n.consume(v),M)}function F(v){return v===r?(n.consume(v),r=void 0,N):v===null?t(v):J(v)?(a=F,B(v)):(n.consume(v),F)}function M(v){return v===null||v===34||v===39||v===60||v===61||v===96?t(v):v===47||v===62||ve(v)?O(v):(n.consume(v),M)}function N(v){return v===47||v===62||ve(v)?O(v):t(v)}function V(v){return v===62?(n.consume(v),n.exit("htmlTextData"),n.exit("htmlText"),e):t(v)}function B(v){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(v),n.exit("lineEnding"),q}function q(v){return ue(v)?pe(n,U,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(v):U(v)}function U(v){return n.enter("htmlTextData"),a(v)}}const Hs={name:"labelEnd",resolveAll:Sm,resolveTo:km,tokenize:Em},vm={tokenize:Cm},Am={tokenize:Tm},_m={tokenize:Pm};function Sm(n){let e=-1;const t=[];for(;++e<n.length;){const i=n[e][1];if(t.push(n[e]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const r=i.type==="labelImage"?4:2;i.type="data",e+=r}}return n.length!==t.length&&lt(n,0,n.length,t),n}function km(n,e){let t=n.length,i=0,r,s,a,o;for(;t--;)if(r=n[t][1],s){if(r.type==="link"||r.type==="labelLink"&&r._inactive)break;n[t][0]==="enter"&&r.type==="labelLink"&&(r._inactive=!0)}else if(a){if(n[t][0]==="enter"&&(r.type==="labelImage"||r.type==="labelLink")&&!r._balanced&&(s=t,r.type!=="labelLink")){i=2;break}}else r.type==="labelEnd"&&(a=t);const l={type:n[s][1].type==="labelLink"?"link":"image",start:{...n[s][1].start},end:{...n[n.length-1][1].end}},c={type:"label",start:{...n[s][1].start},end:{...n[a][1].end}},u={type:"labelText",start:{...n[s+i+2][1].end},end:{...n[a-2][1].start}};return o=[["enter",l,e],["enter",c,e]],o=ft(o,n.slice(s+1,s+i+3)),o=ft(o,[["enter",u,e]]),o=ft(o,Xi(e.parser.constructs.insideSpan.null,n.slice(s+i+4,a-3),e)),o=ft(o,[["exit",u,e],n[a-2],n[a-1],["exit",c,e]]),o=ft(o,n.slice(a+1)),o=ft(o,[["exit",l,e]]),lt(n,s,n.length,o),n}function Em(n,e,t){const i=this;let r=i.events.length,s,a;for(;r--;)if((i.events[r][1].type==="labelImage"||i.events[r][1].type==="labelLink")&&!i.events[r][1]._balanced){s=i.events[r][1];break}return o;function o(d){return s?s._inactive?h(d):(a=i.parser.defined.includes(bt(i.sliceSerialize({start:s.end,end:i.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(d),n.exit("labelMarker"),n.exit("labelEnd"),l):t(d)}function l(d){return d===40?n.attempt(vm,u,a?u:h)(d):d===91?n.attempt(Am,u,a?c:h)(d):a?u(d):h(d)}function c(d){return n.attempt(_m,u,h)(d)}function u(d){return e(d)}function h(d){return s._balanced=!0,t(d)}}function Cm(n,e,t){return i;function i(h){return n.enter("resource"),n.enter("resourceMarker"),n.consume(h),n.exit("resourceMarker"),r}function r(h){return ve(h)?Kn(n,s)(h):s(h)}function s(h){return h===41?u(h):bc(n,a,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function a(h){return ve(h)?Kn(n,l)(h):u(h)}function o(h){return t(h)}function l(h){return h===34||h===39||h===40?wc(n,c,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):u(h)}function c(h){return ve(h)?Kn(n,u)(h):u(h)}function u(h){return h===41?(n.enter("resourceMarker"),n.consume(h),n.exit("resourceMarker"),n.exit("resource"),e):t(h)}}function Tm(n,e,t){const i=this;return r;function r(o){return xc.call(i,n,s,a,"reference","referenceMarker","referenceString")(o)}function s(o){return i.parser.defined.includes(bt(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?e(o):t(o)}function a(o){return t(o)}}function Pm(n,e,t){return i;function i(s){return n.enter("reference"),n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),r}function r(s){return s===93?(n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),n.exit("reference"),e):t(s)}}const Rm={name:"labelStartImage",resolveAll:Hs.resolveAll,tokenize:Im};function Im(n,e,t){const i=this;return r;function r(o){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(o),n.exit("labelImageMarker"),s}function s(o){return o===91?(n.enter("labelMarker"),n.consume(o),n.exit("labelMarker"),n.exit("labelImage"),a):t(o)}function a(o){return o===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(o):e(o)}}const Lm={name:"labelStartLink",resolveAll:Hs.resolveAll,tokenize:Dm};function Dm(n,e,t){const i=this;return r;function r(a){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(a),n.exit("labelMarker"),n.exit("labelLink"),s}function s(a){return a===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(a):e(a)}}const wr={name:"lineEnding",tokenize:Mm};function Mm(n,e){return t;function t(i){return n.enter("lineEnding"),n.consume(i),n.exit("lineEnding"),pe(n,e,"linePrefix")}}const Pi={name:"thematicBreak",tokenize:Fm};function Fm(n,e,t){let i=0,r;return s;function s(c){return n.enter("thematicBreak"),a(c)}function a(c){return r=c,o(c)}function o(c){return c===r?(n.enter("thematicBreakSequence"),l(c)):i>=3&&(c===null||J(c))?(n.exit("thematicBreak"),e(c)):t(c)}function l(c){return c===r?(n.consume(c),i++,l):(n.exit("thematicBreakSequence"),ue(c)?pe(n,o,"whitespace")(c):o(c))}}const tt={continuation:{tokenize:zm},exit:Hm,name:"list",tokenize:jm},Om={partial:!0,tokenize:Um},Nm={partial:!0,tokenize:Bm};function jm(n,e,t){const i=this,r=i.events[i.events.length-1];let s=r&&r[1].type==="linePrefix"?r[2].sliceSerialize(r[1],!0).length:0,a=0;return o;function o(f){const g=i.containerState.type||(f===42||f===43||f===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!i.containerState.marker||f===i.containerState.marker:os(f)){if(i.containerState.type||(i.containerState.type=g,n.enter(g,{_container:!0})),g==="listUnordered")return n.enter("listItemPrefix"),f===42||f===45?n.check(Pi,t,c)(f):c(f);if(!i.interrupt||f===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),l(f)}return t(f)}function l(f){return os(f)&&++a<10?(n.consume(f),l):(!i.interrupt||a<2)&&(i.containerState.marker?f===i.containerState.marker:f===41||f===46)?(n.exit("listItemValue"),c(f)):t(f)}function c(f){return n.enter("listItemMarker"),n.consume(f),n.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||f,n.check(ui,i.interrupt?t:u,n.attempt(Om,d,h))}function u(f){return i.containerState.initialBlankLine=!0,s++,d(f)}function h(f){return ue(f)?(n.enter("listItemPrefixWhitespace"),n.consume(f),n.exit("listItemPrefixWhitespace"),d):t(f)}function d(f){return i.containerState.size=s+i.sliceSerialize(n.exit("listItemPrefix"),!0).length,e(f)}}function zm(n,e,t){const i=this;return i.containerState._closeFlow=void 0,n.check(ui,r,s);function r(o){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,pe(n,e,"listItemIndent",i.containerState.size+1)(o)}function s(o){return i.containerState.furtherBlankLines||!ue(o)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,a(o)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,n.attempt(Nm,e,a)(o))}function a(o){return i.containerState._closeFlow=!0,i.interrupt=void 0,pe(n,n.attempt(tt,e,t),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function Bm(n,e,t){const i=this;return pe(n,r,"listItemIndent",i.containerState.size+1);function r(s){const a=i.events[i.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===i.containerState.size?e(s):t(s)}}function Hm(n){n.exit(this.containerState.type)}function Um(n,e,t){const i=this;return pe(n,r,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function r(s){const a=i.events[i.events.length-1];return!ue(s)&&a&&a[1].type==="listItemPrefixWhitespace"?e(s):t(s)}}const Co={name:"setextUnderline",resolveTo:$m,tokenize:qm};function $m(n,e){let t=n.length,i,r,s;for(;t--;)if(n[t][0]==="enter"){if(n[t][1].type==="content"){i=t;break}n[t][1].type==="paragraph"&&(r=t)}else n[t][1].type==="content"&&n.splice(t,1),!s&&n[t][1].type==="definition"&&(s=t);const a={type:"setextHeading",start:{...n[i][1].start},end:{...n[n.length-1][1].end}};return n[r][1].type="setextHeadingText",s?(n.splice(r,0,["enter",a,e]),n.splice(s+1,0,["exit",n[i][1],e]),n[i][1].end={...n[s][1].end}):n[i][1]=a,n.push(["exit",a,e]),n}function qm(n,e,t){const i=this;let r;return s;function s(c){let u=i.events.length,h;for(;u--;)if(i.events[u][1].type!=="lineEnding"&&i.events[u][1].type!=="linePrefix"&&i.events[u][1].type!=="content"){h=i.events[u][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||h)?(n.enter("setextHeadingLine"),r=c,a(c)):t(c)}function a(c){return n.enter("setextHeadingLineSequence"),o(c)}function o(c){return c===r?(n.consume(c),o):(n.exit("setextHeadingLineSequence"),ue(c)?pe(n,l,"lineSuffix")(c):l(c))}function l(c){return c===null||J(c)?(n.exit("setextHeadingLine"),e(c)):t(c)}}const Vm={tokenize:Wm};function Wm(n){const e=this,t=n.attempt(ui,i,n.attempt(this.parser.constructs.flowInitial,r,pe(n,n.attempt(this.parser.constructs.flow,r,n.attempt(Qg,r)),"linePrefix")));return t;function i(s){if(s===null){n.consume(s);return}return n.enter("lineEndingBlank"),n.consume(s),n.exit("lineEndingBlank"),e.currentConstruct=void 0,t}function r(s){if(s===null){n.consume(s);return}return n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),e.currentConstruct=void 0,t}}const Gm={resolveAll:Ac()},Xm=vc("string"),Ym=vc("text");function vc(n){return{resolveAll:Ac(n==="text"?Km:void 0),tokenize:e};function e(t){const i=this,r=this.parser.constructs[n],s=t.attempt(r,a,o);return a;function a(u){return c(u)?s(u):o(u)}function o(u){if(u===null){t.consume(u);return}return t.enter("data"),t.consume(u),l}function l(u){return c(u)?(t.exit("data"),s(u)):(t.consume(u),l)}function c(u){if(u===null)return!0;const h=r[u];let d=-1;if(h)for(;++d<h.length;){const f=h[d];if(!f.previous||f.previous.call(i,i.previous))return!0}return!1}}}function Ac(n){return e;function e(t,i){let r=-1,s;for(;++r<=t.length;)s===void 0?t[r]&&t[r][1].type==="data"&&(s=r,r++):(!t[r]||t[r][1].type!=="data")&&(r!==s+2&&(t[s][1].end=t[r-1][1].end,t.splice(s+2,r-s-2),r=s+2),s=void 0);return n?n(t,i):t}}function Km(n,e){let t=0;for(;++t<=n.length;)if((t===n.length||n[t][1].type==="lineEnding")&&n[t-1][1].type==="data"){const i=n[t-1][1],r=e.sliceStream(i);let s=r.length,a=-1,o=0,l;for(;s--;){const c=r[s];if(typeof c=="string"){for(a=c.length;c.charCodeAt(a-1)===32;)o++,a--;if(a)break;a=-1}else if(c===-2)l=!0,o++;else if(c!==-1){s++;break}}if(e._contentTypeTextTrailing&&t===n.length&&(o=0),o){const c={type:t===n.length||l||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?a:i.start._bufferIndex+a,_index:i.start._index+s,line:i.end.line,column:i.end.column-o,offset:i.end.offset-o},end:{...i.end}};i.end={...c.start},i.start.offset===i.end.offset?Object.assign(i,c):(n.splice(t,0,["enter",c,e],["exit",c,e]),t+=2)}t++}return n}const Qm={42:tt,43:tt,45:tt,48:tt,49:tt,50:tt,51:tt,52:tt,53:tt,54:tt,55:tt,56:tt,57:tt,62:pc},Jm={91:nm},Zm={[-2]:xr,[-1]:xr,32:xr},ey={35:lm,42:Pi,45:[Co,Pi],60:dm,61:Co,95:Pi,96:ko,126:ko},ty={38:mc,92:gc},ny={[-5]:wr,[-4]:wr,[-3]:wr,33:Rm,38:mc,42:ls,60:[Lg,xm],91:Lm,92:[am,gc],93:Hs,95:ls,96:Vg},iy={null:[ls,Gm]},ry={null:[42,95]},sy={null:[]},ay=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:ry,contentInitial:Jm,disable:sy,document:Qm,flow:ey,flowInitial:Zm,insideSpan:iy,string:ty,text:ny},Symbol.toStringTag,{value:"Module"}));function oy(n,e,t){let i={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const r={},s=[];let a=[],o=[];const l={attempt:P(E),check:P(_),consume:x,enter:A,exit:k,interrupt:P(_,{interrupt:!0})},c={code:null,containerState:{},defineSkip:m,events:[],now:g,parser:n,previous:null,sliceSerialize:d,sliceStream:f,write:h};let u=e.tokenize.call(c,l);return e.resolveAll&&s.push(e),c;function h(R){return a=ft(a,R),b(),a[a.length-1]!==null?[]:(D(e,0),c.events=Xi(s,c.events,c),c.events)}function d(R,I){return cy(f(R),I)}function f(R){return ly(a,R)}function g(){const{_bufferIndex:R,_index:I,line:F,column:M,offset:N}=i;return{_bufferIndex:R,_index:I,line:F,column:M,offset:N}}function m(R){r[R.line]=R.column,S()}function b(){let R;for(;i._index<a.length;){const I=a[i._index];if(typeof I=="string")for(R=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===R&&i._bufferIndex<I.length;)y(I.charCodeAt(i._bufferIndex));else y(I)}}function y(R){u=u(R)}function x(R){J(R)?(i.line++,i.column=1,i.offset+=R===-3?2:1,S()):R!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===a[i._index].length&&(i._bufferIndex=-1,i._index++)),c.previous=R}function A(R,I){const F=I||{};return F.type=R,F.start=g(),c.events.push(["enter",F,c]),o.push(F),F}function k(R){const I=o.pop();return I.end=g(),c.events.push(["exit",I,c]),I}function E(R,I){D(R,I.from)}function _(R,I){I.restore()}function P(R,I){return F;function F(M,N,V){let B,q,U,v;return Array.isArray(M)?X(M):"tokenize"in M?X([M]):G(M);function G(Q){return Y;function Y(Ae){const Ee=Ae!==null&&Q[Ae],he=Ae!==null&&Q.null,se=[...Array.isArray(Ee)?Ee:Ee?[Ee]:[],...Array.isArray(he)?he:he?[he]:[]];return X(se)(Ae)}}function X(Q){return B=Q,q=0,Q.length===0?V:w(Q[q])}function w(Q){return Y;function Y(Ae){return v=O(),U=Q,Q.partial||(c.currentConstruct=Q),Q.name&&c.parser.constructs.disable.null.includes(Q.name)?$():Q.tokenize.call(I?Object.assign(Object.create(c),I):c,l,ne,$)(Ae)}}function ne(Q){return R(U,v),N}function $(Q){return v.restore(),++q<B.length?w(B[q]):V}}}function D(R,I){R.resolveAll&&!s.includes(R)&&s.push(R),R.resolve&&lt(c.events,I,c.events.length-I,R.resolve(c.events.slice(I),c)),R.resolveTo&&(c.events=R.resolveTo(c.events,c))}function O(){const R=g(),I=c.previous,F=c.currentConstruct,M=c.events.length,N=Array.from(o);return{from:M,restore:V};function V(){i=R,c.previous=I,c.currentConstruct=F,c.events.length=M,o=N,S()}}function S(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}function ly(n,e){const t=e.start._index,i=e.start._bufferIndex,r=e.end._index,s=e.end._bufferIndex;let a;if(t===r)a=[n[t].slice(i,s)];else{if(a=n.slice(t,r),i>-1){const o=a[0];typeof o=="string"?a[0]=o.slice(i):a.shift()}s>0&&a.push(n[r].slice(0,s))}return a}function cy(n,e){let t=-1;const i=[];let r;for(;++t<n.length;){const s=n[t];let a;if(typeof s=="string")a=s;else switch(s){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=e?" ":"	";break}case-1:{if(!e&&r)continue;a=" ";break}default:a=String.fromCharCode(s)}r=s===-2,i.push(a)}return i.join("")}function uy(n){const i={constructs:dc([ay,...(n||{}).extensions||[]]),content:r(kg),defined:[],document:r(Cg),flow:r(Vm),lazy:{},string:r(Xm),text:r(Ym)};return i;function r(s){return a;function a(o){return oy(i,s,o)}}}function hy(n){for(;!yc(n););return n}const To=/[\0\t\n\r]/g;function dy(){let n=1,e="",t=!0,i;return r;function r(s,a,o){const l=[];let c,u,h,d,f;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(a||void 0).decode(s)),h=0,e="",t&&(s.charCodeAt(0)===65279&&h++,t=void 0);h<s.length;){if(To.lastIndex=h,c=To.exec(s),d=c&&c.index!==void 0?c.index:s.length,f=s.charCodeAt(d),!c){e=s.slice(h);break}if(f===10&&h===d&&i)l.push(-3),i=void 0;else switch(i&&(l.push(-5),i=void 0),h<d&&(l.push(s.slice(h,d)),n+=d-h),f){case 0:{l.push(65533),n++;break}case 9:{for(u=Math.ceil(n/4)*4,l.push(-2);n++<u;)l.push(-1);break}case 10:{l.push(-4),n=1;break}default:i=!0,n=1}h=d+1}return o&&(i&&l.push(-5),e&&l.push(e),l.push(null)),l}}const fy=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function py(n){return n.replace(fy,gy)}function gy(n,e,t){if(e)return e;if(t.charCodeAt(0)===35){const r=t.charCodeAt(1),s=r===120||r===88;return fc(t.slice(s?2:1),s?16:10)}return Bs(t)||n}const _c={}.hasOwnProperty;function my(n,e,t){return typeof e!="string"&&(t=e,e=void 0),yy(t)(hy(uy(t).document().write(dy()(n,e,!0))))}function yy(n){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(be),autolinkProtocol:O,autolinkEmail:O,atxHeading:s(Te),blockQuote:s(he),characterEscape:O,characterReference:O,codeFenced:s(se),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(se,a),codeText:s(Je,a),codeTextData:O,data:O,codeFlowValue:O,definition:s(de),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(_e),hardBreakEscape:s(j),hardBreakTrailing:s(j),htmlFlow:s(W,a),htmlFlowData:O,htmlText:s(W,a),htmlTextData:O,image:s(ye),label:a,link:s(be),listItem:s(Me),listItemValue:d,listOrdered:s(ge,h),listUnordered:s(ge),paragraph:s(ct),reference:w,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s(Te),strong:s(Ze),thematicBreak:s(ur)},exit:{atxHeading:l(),atxHeadingSequence:E,autolink:l(),autolinkEmail:Ee,autolinkProtocol:Ae,blockQuote:l(),characterEscapeValue:S,characterReferenceMarkerHexadecimal:$,characterReferenceMarkerNumeric:$,characterReferenceValue:Q,characterReference:Y,codeFenced:l(b),codeFencedFence:m,codeFencedFenceInfo:f,codeFencedFenceMeta:g,codeFlowValue:S,codeIndented:l(y),codeText:l(N),codeTextData:S,data:S,definition:l(),definitionDestinationString:k,definitionLabelString:x,definitionTitleString:A,emphasis:l(),hardBreakEscape:l(I),hardBreakTrailing:l(I),htmlFlow:l(F),htmlFlowData:S,htmlText:l(M),htmlTextData:S,image:l(B),label:U,labelText:q,lineEnding:R,link:l(V),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:ne,resourceDestinationString:v,resourceTitleString:G,resource:X,setextHeading:l(D),setextHeadingLineSequence:P,setextHeadingText:_,strong:l(),thematicBreak:l()}};Sc(e,(n||{}).mdastExtensions||[]);const t={};return i;function i(L){let H={type:"root",children:[]};const Z={stack:[H],tokenStack:[],config:e,enter:o,exit:c,buffer:a,resume:u,data:t},le=[];let me=-1;for(;++me<L.length;)if(L[me][1].type==="listOrdered"||L[me][1].type==="listUnordered")if(L[me][0]==="enter")le.push(me);else{const gt=le.pop();me=r(L,gt,me)}for(me=-1;++me<L.length;){const gt=e[L[me][0]];_c.call(gt,L[me][1].type)&&gt[L[me][1].type].call(Object.assign({sliceSerialize:L[me][2].sliceSerialize},Z),L[me][1])}if(Z.tokenStack.length>0){const gt=Z.tokenStack[Z.tokenStack.length-1];(gt[1]||Po).call(Z,void 0,gt[0])}for(H.position={start:jt(L.length>0?L[0][1].start:{line:1,column:1,offset:0}),end:jt(L.length>0?L[L.length-2][1].end:{line:1,column:1,offset:0})},me=-1;++me<e.transforms.length;)H=e.transforms[me](H)||H;return H}function r(L,H,Z){let le=H-1,me=-1,gt=!1,Xt,kt,jn,zn;for(;++le<=Z;){const rt=L[le];switch(rt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{rt[0]==="enter"?me++:me--,zn=void 0;break}case"lineEndingBlank":{rt[0]==="enter"&&(Xt&&!zn&&!me&&!jn&&(jn=le),zn=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:zn=void 0}if(!me&&rt[0]==="enter"&&rt[1].type==="listItemPrefix"||me===-1&&rt[0]==="exit"&&(rt[1].type==="listUnordered"||rt[1].type==="listOrdered")){if(Xt){let mn=le;for(kt=void 0;mn--;){const Et=L[mn];if(Et[1].type==="lineEnding"||Et[1].type==="lineEndingBlank"){if(Et[0]==="exit")continue;kt&&(L[kt][1].type="lineEndingBlank",gt=!0),Et[1].type="lineEnding",kt=mn}else if(!(Et[1].type==="linePrefix"||Et[1].type==="blockQuotePrefix"||Et[1].type==="blockQuotePrefixWhitespace"||Et[1].type==="blockQuoteMarker"||Et[1].type==="listItemIndent"))break}jn&&(!kt||jn<kt)&&(Xt._spread=!0),Xt.end=Object.assign({},kt?L[kt][1].start:rt[1].end),L.splice(kt||le,0,["exit",Xt,rt[2]]),le++,Z++}if(rt[1].type==="listItemPrefix"){const mn={type:"listItem",_spread:!1,start:Object.assign({},rt[1].start),end:void 0};Xt=mn,L.splice(le,0,["enter",mn,rt[2]]),le++,Z++,jn=void 0,zn=!0}}}return L[H][1]._spread=gt,Z}function s(L,H){return Z;function Z(le){o.call(this,L(le),le),H&&H.call(this,le)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(L,H,Z){this.stack[this.stack.length-1].children.push(L),this.stack.push(L),this.tokenStack.push([H,Z||void 0]),L.position={start:jt(H.start),end:void 0}}function l(L){return H;function H(Z){L&&L.call(this,Z),c.call(this,Z)}}function c(L,H){const Z=this.stack.pop(),le=this.tokenStack.pop();if(le)le[0].type!==L.type&&(H?H.call(this,L,le[0]):(le[1]||Po).call(this,L,le[0]));else throw new Error("Cannot close `"+L.type+"` ("+Yn({start:L.start,end:L.end})+"): it’s not open");Z.position.end=jt(L.end)}function u(){return zs(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function d(L){if(this.data.expectingFirstListItemValue){const H=this.stack[this.stack.length-2];H.start=Number.parseInt(this.sliceSerialize(L),10),this.data.expectingFirstListItemValue=void 0}}function f(){const L=this.resume(),H=this.stack[this.stack.length-1];H.lang=L}function g(){const L=this.resume(),H=this.stack[this.stack.length-1];H.meta=L}function m(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function b(){const L=this.resume(),H=this.stack[this.stack.length-1];H.value=L.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function y(){const L=this.resume(),H=this.stack[this.stack.length-1];H.value=L.replace(/(\r?\n|\r)$/g,"")}function x(L){const H=this.resume(),Z=this.stack[this.stack.length-1];Z.label=H,Z.identifier=bt(this.sliceSerialize(L)).toLowerCase()}function A(){const L=this.resume(),H=this.stack[this.stack.length-1];H.title=L}function k(){const L=this.resume(),H=this.stack[this.stack.length-1];H.url=L}function E(L){const H=this.stack[this.stack.length-1];if(!H.depth){const Z=this.sliceSerialize(L).length;H.depth=Z}}function _(){this.data.setextHeadingSlurpLineEnding=!0}function P(L){const H=this.stack[this.stack.length-1];H.depth=this.sliceSerialize(L).codePointAt(0)===61?1:2}function D(){this.data.setextHeadingSlurpLineEnding=void 0}function O(L){const Z=this.stack[this.stack.length-1].children;let le=Z[Z.length-1];(!le||le.type!=="text")&&(le=Nn(),le.position={start:jt(L.start),end:void 0},Z.push(le)),this.stack.push(le)}function S(L){const H=this.stack.pop();H.value+=this.sliceSerialize(L),H.position.end=jt(L.end)}function R(L){const H=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Z=H.children[H.children.length-1];Z.position.end=jt(L.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(H.type)&&(O.call(this,L),S.call(this,L))}function I(){this.data.atHardBreak=!0}function F(){const L=this.resume(),H=this.stack[this.stack.length-1];H.value=L}function M(){const L=this.resume(),H=this.stack[this.stack.length-1];H.value=L}function N(){const L=this.resume(),H=this.stack[this.stack.length-1];H.value=L}function V(){const L=this.stack[this.stack.length-1];if(this.data.inReference){const H=this.data.referenceType||"shortcut";L.type+="Reference",L.referenceType=H,delete L.url,delete L.title}else delete L.identifier,delete L.label;this.data.referenceType=void 0}function B(){const L=this.stack[this.stack.length-1];if(this.data.inReference){const H=this.data.referenceType||"shortcut";L.type+="Reference",L.referenceType=H,delete L.url,delete L.title}else delete L.identifier,delete L.label;this.data.referenceType=void 0}function q(L){const H=this.sliceSerialize(L),Z=this.stack[this.stack.length-2];Z.label=py(H),Z.identifier=bt(H).toLowerCase()}function U(){const L=this.stack[this.stack.length-1],H=this.resume(),Z=this.stack[this.stack.length-1];if(this.data.inReference=!0,Z.type==="link"){const le=L.children;Z.children=le}else Z.alt=H}function v(){const L=this.resume(),H=this.stack[this.stack.length-1];H.url=L}function G(){const L=this.resume(),H=this.stack[this.stack.length-1];H.title=L}function X(){this.data.inReference=void 0}function w(){this.data.referenceType="collapsed"}function ne(L){const H=this.resume(),Z=this.stack[this.stack.length-1];Z.label=H,Z.identifier=bt(this.sliceSerialize(L)).toLowerCase(),this.data.referenceType="full"}function $(L){this.data.characterReferenceType=L.type}function Q(L){const H=this.sliceSerialize(L),Z=this.data.characterReferenceType;let le;Z?(le=fc(H,Z==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):le=Bs(H);const me=this.stack[this.stack.length-1];me.value+=le}function Y(L){const H=this.stack.pop();H.position.end=jt(L.end)}function Ae(L){S.call(this,L);const H=this.stack[this.stack.length-1];H.url=this.sliceSerialize(L)}function Ee(L){S.call(this,L);const H=this.stack[this.stack.length-1];H.url="mailto:"+this.sliceSerialize(L)}function he(){return{type:"blockquote",children:[]}}function se(){return{type:"code",lang:null,meta:null,value:""}}function Je(){return{type:"inlineCode",value:""}}function de(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function _e(){return{type:"emphasis",children:[]}}function Te(){return{type:"heading",depth:0,children:[]}}function j(){return{type:"break"}}function W(){return{type:"html",value:""}}function ye(){return{type:"image",title:null,url:"",alt:null}}function be(){return{type:"link",title:null,url:"",children:[]}}function ge(L){return{type:"list",ordered:L.type==="listOrdered",start:null,spread:L._spread,children:[]}}function Me(L){return{type:"listItem",spread:L._spread,checked:null,children:[]}}function ct(){return{type:"paragraph",children:[]}}function Ze(){return{type:"strong",children:[]}}function Nn(){return{type:"text",value:""}}function ur(){return{type:"thematicBreak"}}}function jt(n){return{line:n.line,column:n.column,offset:n.offset}}function Sc(n,e){let t=-1;for(;++t<e.length;){const i=e[t];Array.isArray(i)?Sc(n,i):by(n,i)}}function by(n,e){let t;for(t in e)if(_c.call(e,t))switch(t){case"canContainEols":{const i=e[t];i&&n[t].push(...i);break}case"transforms":{const i=e[t];i&&n[t].push(...i);break}case"enter":case"exit":{const i=e[t];i&&Object.assign(n[t],i);break}}}function Po(n,e){throw n?new Error("Cannot close `"+n.type+"` ("+Yn({start:n.start,end:n.end})+"): a different token (`"+e.type+"`, "+Yn({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Yn({start:e.start,end:e.end})+") is still open")}function xy(n){const e=this;e.parser=t;function t(i){return my(i,{...e.data("settings"),...n,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function wy(n,e){const t={type:"element",tagName:"blockquote",properties:{},children:n.wrap(n.all(e),!0)};return n.patch(e,t),n.applyData(e,t)}function vy(n,e){const t={type:"element",tagName:"br",properties:{},children:[]};return n.patch(e,t),[n.applyData(e,t),{type:"text",value:`
`}]}function Ay(n,e){const t=e.value?e.value+`
`:"",i={};e.lang&&(i.className=["language-"+e.lang]);let r={type:"element",tagName:"code",properties:i,children:[{type:"text",value:t}]};return e.meta&&(r.data={meta:e.meta}),n.patch(e,r),r=n.applyData(e,r),r={type:"element",tagName:"pre",properties:{},children:[r]},n.patch(e,r),r}function _y(n,e){const t={type:"element",tagName:"del",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function Sy(n,e){const t={type:"element",tagName:"em",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function ky(n,e){const t=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",i=String(e.identifier).toUpperCase(),r=On(i.toLowerCase()),s=n.footnoteOrder.indexOf(i);let a,o=n.footnoteCounts.get(i);o===void 0?(o=0,n.footnoteOrder.push(i),a=n.footnoteOrder.length):a=s+1,o+=1,n.footnoteCounts.set(i,o);const l={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+r,id:t+"fnref-"+r+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};n.patch(e,l);const c={type:"element",tagName:"sup",properties:{},children:[l]};return n.patch(e,c),n.applyData(e,c)}function Ey(n,e){const t={type:"element",tagName:"h"+e.depth,properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function Cy(n,e){if(n.options.allowDangerousHtml){const t={type:"raw",value:e.value};return n.patch(e,t),n.applyData(e,t)}}function kc(n,e){const t=e.referenceType;let i="]";if(t==="collapsed"?i+="[]":t==="full"&&(i+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+i}];const r=n.all(e),s=r[0];s&&s.type==="text"?s.value="["+s.value:r.unshift({type:"text",value:"["});const a=r[r.length-1];return a&&a.type==="text"?a.value+=i:r.push({type:"text",value:i}),r}function Ty(n,e){const t=String(e.identifier).toUpperCase(),i=n.definitionById.get(t);if(!i)return kc(n,e);const r={src:On(i.url||""),alt:e.alt};i.title!==null&&i.title!==void 0&&(r.title=i.title);const s={type:"element",tagName:"img",properties:r,children:[]};return n.patch(e,s),n.applyData(e,s)}function Py(n,e){const t={src:On(e.url)};e.alt!==null&&e.alt!==void 0&&(t.alt=e.alt),e.title!==null&&e.title!==void 0&&(t.title=e.title);const i={type:"element",tagName:"img",properties:t,children:[]};return n.patch(e,i),n.applyData(e,i)}function Ry(n,e){const t={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};n.patch(e,t);const i={type:"element",tagName:"code",properties:{},children:[t]};return n.patch(e,i),n.applyData(e,i)}function Iy(n,e){const t=String(e.identifier).toUpperCase(),i=n.definitionById.get(t);if(!i)return kc(n,e);const r={href:On(i.url||"")};i.title!==null&&i.title!==void 0&&(r.title=i.title);const s={type:"element",tagName:"a",properties:r,children:n.all(e)};return n.patch(e,s),n.applyData(e,s)}function Ly(n,e){const t={href:On(e.url)};e.title!==null&&e.title!==void 0&&(t.title=e.title);const i={type:"element",tagName:"a",properties:t,children:n.all(e)};return n.patch(e,i),n.applyData(e,i)}function Dy(n,e,t){const i=n.all(e),r=t?My(t):Ec(e),s={},a=[];if(typeof e.checked=="boolean"){const u=i[0];let h;u&&u.type==="element"&&u.tagName==="p"?h=u:(h={type:"element",tagName:"p",properties:{},children:[]},i.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let o=-1;for(;++o<i.length;){const u=i[o];(r||o!==0||u.type!=="element"||u.tagName!=="p")&&a.push({type:"text",value:`
`}),u.type==="element"&&u.tagName==="p"&&!r?a.push(...u.children):a.push(u)}const l=i[i.length-1];l&&(r||l.type!=="element"||l.tagName!=="p")&&a.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:s,children:a};return n.patch(e,c),n.applyData(e,c)}function My(n){let e=!1;if(n.type==="list"){e=n.spread||!1;const t=n.children;let i=-1;for(;!e&&++i<t.length;)e=Ec(t[i])}return e}function Ec(n){const e=n.spread;return e??n.children.length>1}function Fy(n,e){const t={},i=n.all(e);let r=-1;for(typeof e.start=="number"&&e.start!==1&&(t.start=e.start);++r<i.length;){const a=i[r];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:t,children:n.wrap(i,!0)};return n.patch(e,s),n.applyData(e,s)}function Oy(n,e){const t={type:"element",tagName:"p",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function Ny(n,e){const t={type:"root",children:n.wrap(n.all(e))};return n.patch(e,t),n.applyData(e,t)}function jy(n,e){const t={type:"element",tagName:"strong",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function zy(n,e){const t=n.all(e),i=t.shift(),r=[];if(i){const a={type:"element",tagName:"thead",properties:{},children:n.wrap([i],!0)};n.patch(e.children[0],a),r.push(a)}if(t.length>0){const a={type:"element",tagName:"tbody",properties:{},children:n.wrap(t,!0)},o=Fs(e.children[1]),l=sc(e.children[e.children.length-1]);o&&l&&(a.position={start:o,end:l}),r.push(a)}const s={type:"element",tagName:"table",properties:{},children:n.wrap(r,!0)};return n.patch(e,s),n.applyData(e,s)}function By(n,e,t){const i=t?t.children:void 0,s=(i?i.indexOf(e):1)===0?"th":"td",a=t&&t.type==="table"?t.align:void 0,o=a?a.length:e.children.length;let l=-1;const c=[];for(;++l<o;){const h=e.children[l],d={},f=a?a[l]:void 0;f&&(d.align=f);let g={type:"element",tagName:s,properties:d,children:[]};h&&(g.children=n.all(h),n.patch(h,g),g=n.applyData(h,g)),c.push(g)}const u={type:"element",tagName:"tr",properties:{},children:n.wrap(c,!0)};return n.patch(e,u),n.applyData(e,u)}function Hy(n,e){const t={type:"element",tagName:"td",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}const Ro=9,Io=32;function Uy(n){const e=String(n),t=/\r?\n|\r/g;let i=t.exec(e),r=0;const s=[];for(;i;)s.push(Lo(e.slice(r,i.index),r>0,!0),i[0]),r=i.index+i[0].length,i=t.exec(e);return s.push(Lo(e.slice(r),r>0,!1)),s.join("")}function Lo(n,e,t){let i=0,r=n.length;if(e){let s=n.codePointAt(i);for(;s===Ro||s===Io;)i++,s=n.codePointAt(i)}if(t){let s=n.codePointAt(r-1);for(;s===Ro||s===Io;)r--,s=n.codePointAt(r-1)}return r>i?n.slice(i,r):""}function $y(n,e){const t={type:"text",value:Uy(String(e.value))};return n.patch(e,t),n.applyData(e,t)}function qy(n,e){const t={type:"element",tagName:"hr",properties:{},children:[]};return n.patch(e,t),n.applyData(e,t)}const Vy={blockquote:wy,break:vy,code:Ay,delete:_y,emphasis:Sy,footnoteReference:ky,heading:Ey,html:Cy,imageReference:Ty,image:Py,inlineCode:Ry,linkReference:Iy,link:Ly,listItem:Dy,list:Fy,paragraph:Oy,root:Ny,strong:jy,table:zy,tableCell:Hy,tableRow:By,text:$y,thematicBreak:qy,toml:xi,yaml:xi,definition:xi,footnoteDefinition:xi};function xi(){}const Cc=-1,Yi=0,Qn=1,Ui=2,Us=3,$s=4,qs=5,Vs=6,Tc=7,Pc=8,Do=typeof self=="object"?self:globalThis,Wy=(n,e)=>{const t=(r,s)=>(n.set(s,r),r),i=r=>{if(n.has(r))return n.get(r);const[s,a]=e[r];switch(s){case Yi:case Cc:return t(a,r);case Qn:{const o=t([],r);for(const l of a)o.push(i(l));return o}case Ui:{const o=t({},r);for(const[l,c]of a)o[i(l)]=i(c);return o}case Us:return t(new Date(a),r);case $s:{const{source:o,flags:l}=a;return t(new RegExp(o,l),r)}case qs:{const o=t(new Map,r);for(const[l,c]of a)o.set(i(l),i(c));return o}case Vs:{const o=t(new Set,r);for(const l of a)o.add(i(l));return o}case Tc:{const{name:o,message:l}=a;return t(new Do[o](l),r)}case Pc:return t(BigInt(a),r);case"BigInt":return t(Object(BigInt(a)),r);case"ArrayBuffer":return t(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:o}=new Uint8Array(a);return t(new DataView(o),a)}}return t(new Do[s](a),r)};return i},Mo=n=>Wy(new Map,n)(0),bn="",{toString:Gy}={},{keys:Xy}=Object,$n=n=>{const e=typeof n;if(e!=="object"||!n)return[Yi,e];const t=Gy.call(n).slice(8,-1);switch(t){case"Array":return[Qn,bn];case"Object":return[Ui,bn];case"Date":return[Us,bn];case"RegExp":return[$s,bn];case"Map":return[qs,bn];case"Set":return[Vs,bn];case"DataView":return[Qn,t]}return t.includes("Array")?[Qn,t]:t.includes("Error")?[Tc,t]:[Ui,t]},wi=([n,e])=>n===Yi&&(e==="function"||e==="symbol"),Yy=(n,e,t,i)=>{const r=(a,o)=>{const l=i.push(a)-1;return t.set(o,l),l},s=a=>{if(t.has(a))return t.get(a);let[o,l]=$n(a);switch(o){case Yi:{let u=a;switch(l){case"bigint":o=Pc,u=a.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+l);u=null;break;case"undefined":return r([Cc],a)}return r([o,u],a)}case Qn:{if(l){let d=a;return l==="DataView"?d=new Uint8Array(a.buffer):l==="ArrayBuffer"&&(d=new Uint8Array(a)),r([l,[...d]],a)}const u=[],h=r([o,u],a);for(const d of a)u.push(s(d));return h}case Ui:{if(l)switch(l){case"BigInt":return r([l,a.toString()],a);case"Boolean":case"Number":case"String":return r([l,a.valueOf()],a)}if(e&&"toJSON"in a)return s(a.toJSON());const u=[],h=r([o,u],a);for(const d of Xy(a))(n||!wi($n(a[d])))&&u.push([s(d),s(a[d])]);return h}case Us:return r([o,a.toISOString()],a);case $s:{const{source:u,flags:h}=a;return r([o,{source:u,flags:h}],a)}case qs:{const u=[],h=r([o,u],a);for(const[d,f]of a)(n||!(wi($n(d))||wi($n(f))))&&u.push([s(d),s(f)]);return h}case Vs:{const u=[],h=r([o,u],a);for(const d of a)(n||!wi($n(d)))&&u.push(s(d));return h}}const{message:c}=a;return r([o,{name:l,message:c}],a)};return s},Fo=(n,{json:e,lossy:t}={})=>{const i=[];return Yy(!(e||t),!!e,new Map,i)(n),i},$i=typeof structuredClone=="function"?(n,e)=>e&&("json"in e||"lossy"in e)?Mo(Fo(n,e)):structuredClone(n):(n,e)=>Mo(Fo(n,e));function Ky(n,e){const t=[{type:"text",value:"↩"}];return e>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),t}function Qy(n,e){return"Back to reference "+(n+1)+(e>1?"-"+e:"")}function Jy(n){const e=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",t=n.options.footnoteBackContent||Ky,i=n.options.footnoteBackLabel||Qy,r=n.options.footnoteLabel||"Footnotes",s=n.options.footnoteLabelTagName||"h2",a=n.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<n.footnoteOrder.length;){const c=n.footnoteById.get(n.footnoteOrder[l]);if(!c)continue;const u=n.all(c),h=String(c.identifier).toUpperCase(),d=On(h.toLowerCase());let f=0;const g=[],m=n.footnoteCounts.get(h);for(;m!==void 0&&++f<=m;){g.length>0&&g.push({type:"text",value:" "});let x=typeof t=="string"?t:t(l,f);typeof x=="string"&&(x={type:"text",value:x}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+d+(f>1?"-"+f:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(l,f),className:["data-footnote-backref"]},children:Array.isArray(x)?x:[x]})}const b=u[u.length-1];if(b&&b.type==="element"&&b.tagName==="p"){const x=b.children[b.children.length-1];x&&x.type==="text"?x.value+=" ":b.children.push({type:"text",value:" "}),b.children.push(...g)}else u.push(...g);const y={type:"element",tagName:"li",properties:{id:e+"fn-"+d},children:n.wrap(u,!0)};n.patch(c,y),o.push(y)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...$i(a),id:"footnote-label"},children:[{type:"text",value:r}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:n.wrap(o,!0)},{type:"text",value:`
`}]}}const Ki=function(n){if(n==null)return nb;if(typeof n=="function")return Qi(n);if(typeof n=="object")return Array.isArray(n)?Zy(n):eb(n);if(typeof n=="string")return tb(n);throw new Error("Expected function, string, or object as test")};function Zy(n){const e=[];let t=-1;for(;++t<n.length;)e[t]=Ki(n[t]);return Qi(i);function i(...r){let s=-1;for(;++s<e.length;)if(e[s].apply(this,r))return!0;return!1}}function eb(n){const e=n;return Qi(t);function t(i){const r=i;let s;for(s in n)if(r[s]!==e[s])return!1;return!0}}function tb(n){return Qi(e);function e(t){return t&&t.type===n}}function Qi(n){return e;function e(t,i,r){return!!(ib(t)&&n.call(this,t,typeof i=="number"?i:void 0,r||void 0))}}function nb(){return!0}function ib(n){return n!==null&&typeof n=="object"&&"type"in n}const Rc=[],rb=!0,cs=!1,sb="skip";function Ic(n,e,t,i){let r;typeof e=="function"&&typeof t!="function"?(i=t,t=e):r=e;const s=Ki(r),a=i?-1:1;o(n,void 0,[])();function o(l,c,u){const h=l&&typeof l=="object"?l:{};if(typeof h.type=="string"){const f=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(d,"name",{value:"node ("+(l.type+(f?"<"+f+">":""))+")"})}return d;function d(){let f=Rc,g,m,b;if((!e||s(l,c,u[u.length-1]||void 0))&&(f=ab(t(l,u)),f[0]===cs))return f;if("children"in l&&l.children){const y=l;if(y.children&&f[0]!==sb)for(m=(i?y.children.length:-1)+a,b=u.concat(y);m>-1&&m<y.children.length;){const x=y.children[m];if(g=o(x,m,b)(),g[0]===cs)return g;m=typeof g[1]=="number"?g[1]:m+a}}return f}}}function ab(n){return Array.isArray(n)?n:typeof n=="number"?[rb,n]:n==null?Rc:[n]}function Ws(n,e,t,i){let r,s,a;typeof e=="function"?(s=void 0,a=e,r=t):(s=e,a=t,r=i),Ic(n,s,o,r);function o(l,c){const u=c[c.length-1],h=u?u.children.indexOf(l):void 0;return a(l,h,u)}}const us={}.hasOwnProperty,ob={};function lb(n,e){const t=e||ob,i=new Map,r=new Map,s=new Map,a={...Vy,...t.handlers},o={all:c,applyData:ub,definitionById:i,footnoteById:r,footnoteCounts:s,footnoteOrder:[],handlers:a,one:l,options:t,patch:cb,wrap:db};return Ws(n,function(u){if(u.type==="definition"||u.type==="footnoteDefinition"){const h=u.type==="definition"?i:r,d=String(u.identifier).toUpperCase();h.has(d)||h.set(d,u)}}),o;function l(u,h){const d=u.type,f=o.handlers[d];if(us.call(o.handlers,d)&&f)return f(o,u,h);if(o.options.passThrough&&o.options.passThrough.includes(d)){if("children"in u){const{children:m,...b}=u,y=$i(b);return y.children=o.all(u),y}return $i(u)}return(o.options.unknownHandler||hb)(o,u,h)}function c(u){const h=[];if("children"in u){const d=u.children;let f=-1;for(;++f<d.length;){const g=o.one(d[f],u);if(g){if(f&&d[f-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=Oo(g.value)),!Array.isArray(g)&&g.type==="element")){const m=g.children[0];m&&m.type==="text"&&(m.value=Oo(m.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function cb(n,e){n.position&&(e.position=Qp(n))}function ub(n,e){let t=e;if(n&&n.data){const i=n.data.hName,r=n.data.hChildren,s=n.data.hProperties;if(typeof i=="string")if(t.type==="element")t.tagName=i;else{const a="children"in t?t.children:[t];t={type:"element",tagName:i,properties:{},children:a}}t.type==="element"&&s&&Object.assign(t.properties,$i(s)),"children"in t&&t.children&&r!==null&&r!==void 0&&(t.children=r)}return t}function hb(n,e){const t=e.data||{},i="value"in e&&!(us.call(t,"hProperties")||us.call(t,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:n.all(e)};return n.patch(e,i),n.applyData(e,i)}function db(n,e){const t=[];let i=-1;for(e&&t.push({type:"text",value:`
`});++i<n.length;)i&&t.push({type:"text",value:`
`}),t.push(n[i]);return e&&n.length>0&&t.push({type:"text",value:`
`}),t}function Oo(n){let e=0,t=n.charCodeAt(e);for(;t===9||t===32;)e++,t=n.charCodeAt(e);return n.slice(e)}function No(n,e){const t=lb(n,e),i=t.one(n,void 0),r=Jy(t),s=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return r&&s.children.push({type:"text",value:`
`},r),s}function fb(n,e){return n&&"run"in n?async function(t,i){const r=No(t,{file:i,...e});await n.run(r,i)}:function(t,i){return No(t,{file:i,...n||e})}}function jo(n){if(n)throw n}var vr,zo;function pb(){if(zo)return vr;zo=1;var n=Object.prototype.hasOwnProperty,e=Object.prototype.toString,t=Object.defineProperty,i=Object.getOwnPropertyDescriptor,r=function(c){return typeof Array.isArray=="function"?Array.isArray(c):e.call(c)==="[object Array]"},s=function(c){if(!c||e.call(c)!=="[object Object]")return!1;var u=n.call(c,"constructor"),h=c.constructor&&c.constructor.prototype&&n.call(c.constructor.prototype,"isPrototypeOf");if(c.constructor&&!u&&!h)return!1;var d;for(d in c);return typeof d>"u"||n.call(c,d)},a=function(c,u){t&&u.name==="__proto__"?t(c,u.name,{enumerable:!0,configurable:!0,value:u.newValue,writable:!0}):c[u.name]=u.newValue},o=function(c,u){if(u==="__proto__")if(n.call(c,u)){if(i)return i(c,u).value}else return;return c[u]};return vr=function l(){var c,u,h,d,f,g,m=arguments[0],b=1,y=arguments.length,x=!1;for(typeof m=="boolean"&&(x=m,m=arguments[1]||{},b=2),(m==null||typeof m!="object"&&typeof m!="function")&&(m={});b<y;++b)if(c=arguments[b],c!=null)for(u in c)h=o(m,u),d=o(c,u),m!==d&&(x&&d&&(s(d)||(f=r(d)))?(f?(f=!1,g=h&&r(h)?h:[]):g=h&&s(h)?h:{},a(m,{name:u,newValue:l(x,g,d)})):typeof d<"u"&&a(m,{name:u,newValue:d}));return m},vr}var gb=pb();const Ar=Rs(gb);function hs(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function mb(){const n=[],e={run:t,use:i};return e;function t(...r){let s=-1;const a=r.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);o(null,...r);function o(l,...c){const u=n[++s];let h=-1;if(l){a(l);return}for(;++h<r.length;)(c[h]===null||c[h]===void 0)&&(c[h]=r[h]);r=c,u?yb(u,o)(...c):a(null,...c)}}function i(r){if(typeof r!="function")throw new TypeError("Expected `middelware` to be a function, not "+r);return n.push(r),e}}function yb(n,e){let t;return i;function i(...a){const o=n.length>a.length;let l;o&&a.push(r);try{l=n.apply(this,a)}catch(c){const u=c;if(o&&t)throw u;return r(u)}o||(l&&l.then&&typeof l.then=="function"?l.then(s,r):l instanceof Error?r(l):s(l))}function r(a,...o){t||(t=!0,e(a,...o))}function s(a){r(null,a)}}const wt={basename:bb,dirname:xb,extname:wb,join:vb,sep:"/"};function bb(n,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');hi(n);let t=0,i=-1,r=n.length,s;if(e===void 0||e.length===0||e.length>n.length){for(;r--;)if(n.codePointAt(r)===47){if(s){t=r+1;break}}else i<0&&(s=!0,i=r+1);return i<0?"":n.slice(t,i)}if(e===n)return"";let a=-1,o=e.length-1;for(;r--;)if(n.codePointAt(r)===47){if(s){t=r+1;break}}else a<0&&(s=!0,a=r+1),o>-1&&(n.codePointAt(r)===e.codePointAt(o--)?o<0&&(i=r):(o=-1,i=a));return t===i?i=a:i<0&&(i=n.length),n.slice(t,i)}function xb(n){if(hi(n),n.length===0)return".";let e=-1,t=n.length,i;for(;--t;)if(n.codePointAt(t)===47){if(i){e=t;break}}else i||(i=!0);return e<0?n.codePointAt(0)===47?"/":".":e===1&&n.codePointAt(0)===47?"//":n.slice(0,e)}function wb(n){hi(n);let e=n.length,t=-1,i=0,r=-1,s=0,a;for(;e--;){const o=n.codePointAt(e);if(o===47){if(a){i=e+1;break}continue}t<0&&(a=!0,t=e+1),o===46?r<0?r=e:s!==1&&(s=1):r>-1&&(s=-1)}return r<0||t<0||s===0||s===1&&r===t-1&&r===i+1?"":n.slice(r,t)}function vb(...n){let e=-1,t;for(;++e<n.length;)hi(n[e]),n[e]&&(t=t===void 0?n[e]:t+"/"+n[e]);return t===void 0?".":Ab(t)}function Ab(n){hi(n);const e=n.codePointAt(0)===47;let t=_b(n,!e);return t.length===0&&!e&&(t="."),t.length>0&&n.codePointAt(n.length-1)===47&&(t+="/"),e?"/"+t:t}function _b(n,e){let t="",i=0,r=-1,s=0,a=-1,o,l;for(;++a<=n.length;){if(a<n.length)o=n.codePointAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(t.length<2||i!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(l=t.lastIndexOf("/"),l!==t.length-1){l<0?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),r=a,s=0;continue}}else if(t.length>0){t="",i=0,r=a,s=0;continue}}e&&(t=t.length>0?t+"/..":"..",i=2)}else t.length>0?t+="/"+n.slice(r+1,a):t=n.slice(r+1,a),i=a-r-1;r=a,s=0}else o===46&&s>-1?s++:s=-1}return t}function hi(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}const Sb={cwd:kb};function kb(){return"/"}function ds(n){return!!(n!==null&&typeof n=="object"&&"href"in n&&n.href&&"protocol"in n&&n.protocol&&n.auth===void 0)}function Eb(n){if(typeof n=="string")n=new URL(n);else if(!ds(n)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+n+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(n.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return Cb(n)}function Cb(n){if(n.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const e=n.pathname;let t=-1;for(;++t<e.length;)if(e.codePointAt(t)===37&&e.codePointAt(t+1)===50){const i=e.codePointAt(t+2);if(i===70||i===102){const r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(e)}const _r=["history","path","basename","stem","extname","dirname"];class Lc{constructor(e){let t;e?ds(e)?t={path:e}:typeof e=="string"||Tb(e)?t={value:e}:t=e:t={},this.cwd="cwd"in t?"":Sb.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<_r.length;){const s=_r[i];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let r;for(r in t)_r.includes(r)||(this[r]=t[r])}get basename(){return typeof this.path=="string"?wt.basename(this.path):void 0}set basename(e){kr(e,"basename"),Sr(e,"basename"),this.path=wt.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?wt.dirname(this.path):void 0}set dirname(e){Bo(this.basename,"dirname"),this.path=wt.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?wt.extname(this.path):void 0}set extname(e){if(Sr(e,"extname"),Bo(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=wt.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){ds(e)&&(e=Eb(e)),kr(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?wt.basename(this.path,this.extname):void 0}set stem(e){kr(e,"stem"),Sr(e,"stem"),this.path=wt.join(this.dirname||"",e+(this.extname||""))}fail(e,t,i){const r=this.message(e,t,i);throw r.fatal=!0,r}info(e,t,i){const r=this.message(e,t,i);return r.fatal=void 0,r}message(e,t,i){const r=new Ge(e,t,i);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Sr(n,e){if(n&&n.includes(wt.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+wt.sep+"`")}function kr(n,e){if(!n)throw new Error("`"+e+"` cannot be empty")}function Bo(n,e){if(!n)throw new Error("Setting `"+e+"` requires `path` to be set too")}function Tb(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const Pb=function(n){const i=this.constructor.prototype,r=i[n],s=function(){return r.apply(s,arguments)};return Object.setPrototypeOf(s,i),s},Rb={}.hasOwnProperty;class Gs extends Pb{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=mb()}copy(){const e=new Gs;let t=-1;for(;++t<this.attachers.length;){const i=this.attachers[t];e.use(...i)}return e.data(Ar(!0,{},this.namespace)),e}data(e,t){return typeof e=="string"?arguments.length===2?(Tr("data",this.frozen),this.namespace[e]=t,this):Rb.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Tr("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const r=t.call(e,...i);typeof r=="function"&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=vi(e),i=this.parser||this.Parser;return Er("parse",i),i(String(t),t)}process(e,t){const i=this;return this.freeze(),Er("process",this.parser||this.Parser),Cr("process",this.compiler||this.Compiler),t?r(void 0,t):new Promise(r);function r(s,a){const o=vi(e),l=i.parse(o);i.run(l,o,function(u,h,d){if(u||!h||!d)return c(u);const f=h,g=i.stringify(f,d);Db(g)?d.value=g:d.result=g,c(u,d)});function c(u,h){u||!h?a(u):s?s(h):t(void 0,h)}}}processSync(e){let t=!1,i;return this.freeze(),Er("processSync",this.parser||this.Parser),Cr("processSync",this.compiler||this.Compiler),this.process(e,r),Uo("processSync","process",t),i;function r(s,a){t=!0,jo(s),i=a}}run(e,t,i){Ho(e),this.freeze();const r=this.transformers;return!i&&typeof t=="function"&&(i=t,t=void 0),i?s(void 0,i):new Promise(s);function s(a,o){const l=vi(t);r.run(e,l,c);function c(u,h,d){const f=h||e;u?o(u):a?a(f):i(void 0,f,d)}}}runSync(e,t){let i=!1,r;return this.run(e,t,s),Uo("runSync","run",i),r;function s(a,o){jo(a),r=o,i=!0}}stringify(e,t){this.freeze();const i=vi(t),r=this.compiler||this.Compiler;return Cr("stringify",r),Ho(e),r(e,i)}use(e,...t){const i=this.attachers,r=this.namespace;if(Tr("use",this.frozen),e!=null)if(typeof e=="function")l(e,t);else if(typeof e=="object")Array.isArray(e)?o(e):a(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(c){if(typeof c=="function")l(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[u,...h]=c;l(u,h)}else a(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function a(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(r.settings=Ar(!0,r.settings,c.settings))}function o(c){let u=-1;if(c!=null)if(Array.isArray(c))for(;++u<c.length;){const h=c[u];s(h)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function l(c,u){let h=-1,d=-1;for(;++h<i.length;)if(i[h][0]===c){d=h;break}if(d===-1)i.push([c,...u]);else if(u.length>0){let[f,...g]=u;const m=i[d][1];hs(m)&&hs(f)&&(f=Ar(!0,m,f)),i[d]=[c,f,...g]}}}}const Ib=new Gs().freeze();function Er(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function Cr(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function Tr(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Ho(n){if(!hs(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function Uo(n,e,t){if(!t)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function vi(n){return Lb(n)?n:new Lc(n)}function Lb(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function Db(n){return typeof n=="string"||Mb(n)}function Mb(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const Fb="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",$o=[],qo={allowDangerousHtml:!0},Ob=/^(https?|ircs?|mailto|xmpp)$/i,Nb=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function jb(n){const e=zb(n),t=Bb(n);return Hb(e.runSync(e.parse(t),t),n)}function zb(n){const e=n.rehypePlugins||$o,t=n.remarkPlugins||$o,i=n.remarkRehypeOptions?{...n.remarkRehypeOptions,...qo}:qo;return Ib().use(xy).use(t).use(fb,i).use(e)}function Bb(n){const e=n.children||"",t=new Lc;return typeof e=="string"&&(t.value=e),t}function Hb(n,e){const t=e.allowedElements,i=e.allowElement,r=e.components,s=e.disallowedElements,a=e.skipHtml,o=e.unwrapDisallowed,l=e.urlTransform||Ub;for(const u of Nb)Object.hasOwn(e,u.from)&&(""+u.from+(u.to?"use `"+u.to+"` instead":"remove it")+Fb+u.id,void 0);return e.className&&(n={type:"element",tagName:"div",properties:{className:e.className},children:n.type==="root"?n.children:[n]}),Ws(n,c),ng(n,{Fragment:p.Fragment,components:r,ignoreInvalidStyle:!0,jsx:p.jsx,jsxs:p.jsxs,passKeys:!0,passNode:!0});function c(u,h,d){if(u.type==="raw"&&d&&typeof h=="number")return a?d.children.splice(h,1):d.children[h]={type:"text",value:u.value},h;if(u.type==="element"){let f;for(f in br)if(Object.hasOwn(br,f)&&Object.hasOwn(u.properties,f)){const g=u.properties[f],m=br[f];(m===null||m.includes(u.tagName))&&(u.properties[f]=l(String(g||""),f,u))}}if(u.type==="element"){let f=t?!t.includes(u.tagName):s?s.includes(u.tagName):!1;if(!f&&i&&typeof h=="number"&&(f=!i(u,h,d)),f&&d&&typeof h=="number")return o&&u.children?d.children.splice(h,1,...u.children):d.children.splice(h,1),h}}}function Ub(n){const e=n.indexOf(":"),t=n.indexOf("?"),i=n.indexOf("#"),r=n.indexOf("/");return e===-1||r!==-1&&e>r||t!==-1&&e>t||i!==-1&&e>i||Ob.test(n.slice(0,e))?n:""}function Vo(n,e){const t=String(n);if(typeof e!="string")throw new TypeError("Expected character");let i=0,r=t.indexOf(e);for(;r!==-1;)i++,r=t.indexOf(e,r+e.length);return i}function $b(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function qb(n,e,t){const r=Ki((t||{}).ignore||[]),s=Vb(e);let a=-1;for(;++a<s.length;)Ic(n,"text",o);function o(c,u){let h=-1,d;for(;++h<u.length;){const f=u[h],g=d?d.children:void 0;if(r(f,g?g.indexOf(f):void 0,d))return;d=f}if(d)return l(c,u)}function l(c,u){const h=u[u.length-1],d=s[a][0],f=s[a][1];let g=0;const b=h.children.indexOf(c);let y=!1,x=[];d.lastIndex=0;let A=d.exec(c.value);for(;A;){const k=A.index,E={index:A.index,input:A.input,stack:[...u,c]};let _=f(...A,E);if(typeof _=="string"&&(_=_.length>0?{type:"text",value:_}:void 0),_===!1?d.lastIndex=k+1:(g!==k&&x.push({type:"text",value:c.value.slice(g,k)}),Array.isArray(_)?x.push(..._):_&&x.push(_),g=k+A[0].length,y=!0),!d.global)break;A=d.exec(c.value)}return y?(g<c.value.length&&x.push({type:"text",value:c.value.slice(g)}),h.children.splice(b,1,...x)):x=[c],b+x.length}}function Vb(n){const e=[];if(!Array.isArray(n))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!n[0]||Array.isArray(n[0])?n:[n];let i=-1;for(;++i<t.length;){const r=t[i];e.push([Wb(r[0]),Gb(r[1])])}return e}function Wb(n){return typeof n=="string"?new RegExp($b(n),"g"):n}function Gb(n){return typeof n=="function"?n:function(){return n}}const Pr="phrasing",Rr=["autolink","link","image","label"];function Xb(){return{transforms:[tx],enter:{literalAutolink:Kb,literalAutolinkEmail:Ir,literalAutolinkHttp:Ir,literalAutolinkWww:Ir},exit:{literalAutolink:ex,literalAutolinkEmail:Zb,literalAutolinkHttp:Qb,literalAutolinkWww:Jb}}}function Yb(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Pr,notInConstruct:Rr},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Pr,notInConstruct:Rr},{character:":",before:"[ps]",after:"\\/",inConstruct:Pr,notInConstruct:Rr}]}}function Kb(n){this.enter({type:"link",title:null,url:"",children:[]},n)}function Ir(n){this.config.enter.autolinkProtocol.call(this,n)}function Qb(n){this.config.exit.autolinkProtocol.call(this,n)}function Jb(n){this.config.exit.data.call(this,n);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(n)}function Zb(n){this.config.exit.autolinkEmail.call(this,n)}function ex(n){this.exit(n)}function tx(n){qb(n,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,nx],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,ix]],{ignore:["link","linkReference"]})}function nx(n,e,t,i,r){let s="";if(!Dc(r)||(/^w/i.test(e)&&(t=e+t,e="",s="http://"),!rx(t)))return!1;const a=sx(t+i);if(!a[0])return!1;const o={type:"link",title:null,url:s+e+a[0],children:[{type:"text",value:e+a[0]}]};return a[1]?[o,{type:"text",value:a[1]}]:o}function ix(n,e,t,i){return!Dc(i,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+t,children:[{type:"text",value:e+"@"+t}]}}function rx(n){const e=n.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function sx(n){const e=/[!"&'),.:;<>?\]}]+$/.exec(n);if(!e)return[n,void 0];n=n.slice(0,e.index);let t=e[0],i=t.indexOf(")");const r=Vo(n,"(");let s=Vo(n,")");for(;i!==-1&&r>s;)n+=t.slice(0,i+1),t=t.slice(i+1),i=t.indexOf(")"),s++;return[n,t]}function Dc(n,e){const t=n.input.charCodeAt(n.index-1);return(n.index===0||ln(t)||Gi(t))&&(!e||t!==47)}Mc.peek=px;function ax(){this.buffer()}function ox(n){this.enter({type:"footnoteReference",identifier:"",label:""},n)}function lx(){this.buffer()}function cx(n){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},n)}function ux(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=bt(this.sliceSerialize(n)).toLowerCase(),t.label=e}function hx(n){this.exit(n)}function dx(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=bt(this.sliceSerialize(n)).toLowerCase(),t.label=e}function fx(n){this.exit(n)}function px(){return"["}function Mc(n,e,t,i){const r=t.createTracker(i);let s=r.move("[^");const a=t.enter("footnoteReference"),o=t.enter("reference");return s+=r.move(t.safe(t.associationId(n),{after:"]",before:s})),o(),a(),s+=r.move("]"),s}function gx(){return{enter:{gfmFootnoteCallString:ax,gfmFootnoteCall:ox,gfmFootnoteDefinitionLabelString:lx,gfmFootnoteDefinition:cx},exit:{gfmFootnoteCallString:ux,gfmFootnoteCall:hx,gfmFootnoteDefinitionLabelString:dx,gfmFootnoteDefinition:fx}}}function mx(n){let e=!1;return n&&n.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:t,footnoteReference:Mc},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(i,r,s,a){const o=s.createTracker(a);let l=o.move("[^");const c=s.enter("footnoteDefinition"),u=s.enter("label");return l+=o.move(s.safe(s.associationId(i),{before:l,after:"]"})),u(),l+=o.move("]:"),i.children&&i.children.length>0&&(o.shift(4),l+=o.move((e?`
`:" ")+s.indentLines(s.containerFlow(i,o.current()),e?Fc:yx))),c(),l}}function yx(n,e,t){return e===0?n:Fc(n,e,t)}function Fc(n,e,t){return(t?"":"    ")+n}const bx=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Oc.peek=_x;function xx(){return{canContainEols:["delete"],enter:{strikethrough:vx},exit:{strikethrough:Ax}}}function wx(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:bx}],handlers:{delete:Oc}}}function vx(n){this.enter({type:"delete",children:[]},n)}function Ax(n){this.exit(n)}function Oc(n,e,t,i){const r=t.createTracker(i),s=t.enter("strikethrough");let a=r.move("~~");return a+=t.containerPhrasing(n,{...r.current(),before:a,after:"~"}),a+=r.move("~~"),s(),a}function _x(){return"~"}function Sx(n){return n.length}function kx(n,e){const t=e||{},i=(t.align||[]).concat(),r=t.stringLength||Sx,s=[],a=[],o=[],l=[];let c=0,u=-1;for(;++u<n.length;){const m=[],b=[];let y=-1;for(n[u].length>c&&(c=n[u].length);++y<n[u].length;){const x=Ex(n[u][y]);if(t.alignDelimiters!==!1){const A=r(x);b[y]=A,(l[y]===void 0||A>l[y])&&(l[y]=A)}m.push(x)}a[u]=m,o[u]=b}let h=-1;if(typeof i=="object"&&"length"in i)for(;++h<c;)s[h]=Wo(i[h]);else{const m=Wo(i);for(;++h<c;)s[h]=m}h=-1;const d=[],f=[];for(;++h<c;){const m=s[h];let b="",y="";m===99?(b=":",y=":"):m===108?b=":":m===114&&(y=":");let x=t.alignDelimiters===!1?1:Math.max(1,l[h]-b.length-y.length);const A=b+"-".repeat(x)+y;t.alignDelimiters!==!1&&(x=b.length+x+y.length,x>l[h]&&(l[h]=x),f[h]=x),d[h]=A}a.splice(1,0,d),o.splice(1,0,f),u=-1;const g=[];for(;++u<a.length;){const m=a[u],b=o[u];h=-1;const y=[];for(;++h<c;){const x=m[h]||"";let A="",k="";if(t.alignDelimiters!==!1){const E=l[h]-(b[h]||0),_=s[h];_===114?A=" ".repeat(E):_===99?E%2?(A=" ".repeat(E/2+.5),k=" ".repeat(E/2-.5)):(A=" ".repeat(E/2),k=A):k=" ".repeat(E)}t.delimiterStart!==!1&&!h&&y.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&x==="")&&(t.delimiterStart!==!1||h)&&y.push(" "),t.alignDelimiters!==!1&&y.push(A),y.push(x),t.alignDelimiters!==!1&&y.push(k),t.padding!==!1&&y.push(" "),(t.delimiterEnd!==!1||h!==c-1)&&y.push("|")}g.push(t.delimiterEnd===!1?y.join("").replace(/ +$/,""):y.join(""))}return g.join(`
`)}function Ex(n){return n==null?"":String(n)}function Wo(n){const e=typeof n=="string"?n.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function Cx(n,e,t,i){const r=t.enter("blockquote"),s=t.createTracker(i);s.move("> "),s.shift(2);const a=t.indentLines(t.containerFlow(n,s.current()),Tx);return r(),a}function Tx(n,e,t){return">"+(t?"":" ")+n}function Px(n,e){return Go(n,e.inConstruct,!0)&&!Go(n,e.notInConstruct,!1)}function Go(n,e,t){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return t;let i=-1;for(;++i<e.length;)if(n.includes(e[i]))return!0;return!1}function Xo(n,e,t,i){let r=-1;for(;++r<t.unsafe.length;)if(t.unsafe[r].character===`
`&&Px(t.stack,t.unsafe[r]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function Rx(n,e){const t=String(n);let i=t.indexOf(e),r=i,s=0,a=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===r?++s>a&&(a=s):s=1,r=i+e.length,i=t.indexOf(e,r);return a}function Ix(n,e){return!!(e.options.fences===!1&&n.value&&!n.lang&&/[^ \r\n]/.test(n.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(n.value))}function Lx(n){const e=n.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function Dx(n,e,t,i){const r=Lx(t),s=n.value||"",a=r==="`"?"GraveAccent":"Tilde";if(Ix(n,t)){const h=t.enter("codeIndented"),d=t.indentLines(s,Mx);return h(),d}const o=t.createTracker(i),l=r.repeat(Math.max(Rx(s,r)+1,3)),c=t.enter("codeFenced");let u=o.move(l);if(n.lang){const h=t.enter(`codeFencedLang${a}`);u+=o.move(t.safe(n.lang,{before:u,after:" ",encode:["`"],...o.current()})),h()}if(n.lang&&n.meta){const h=t.enter(`codeFencedMeta${a}`);u+=o.move(" "),u+=o.move(t.safe(n.meta,{before:u,after:`
`,encode:["`"],...o.current()})),h()}return u+=o.move(`
`),s&&(u+=o.move(s+`
`)),u+=o.move(l),c(),u}function Mx(n,e,t){return(t?"":"    ")+n}function Xs(n){const e=n.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function Fx(n,e,t,i){const r=Xs(t),s=r==='"'?"Quote":"Apostrophe",a=t.enter("definition");let o=t.enter("label");const l=t.createTracker(i);let c=l.move("[");return c+=l.move(t.safe(t.associationId(n),{before:c,after:"]",...l.current()})),c+=l.move("]: "),o(),!n.url||/[\0- \u007F]/.test(n.url)?(o=t.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(t.safe(n.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(o=t.enter("destinationRaw"),c+=l.move(t.safe(n.url,{before:c,after:n.title?" ":`
`,...l.current()}))),o(),n.title&&(o=t.enter(`title${s}`),c+=l.move(" "+r),c+=l.move(t.safe(n.title,{before:c,after:r,...l.current()})),c+=l.move(r),o()),a(),c}function Ox(n){const e=n.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function oi(n){return"&#x"+n.toString(16).toUpperCase()+";"}function qi(n,e,t){const i=Ln(n),r=Ln(e);return i===void 0?r===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Nc.peek=Nx;function Nc(n,e,t,i){const r=Ox(t),s=t.enter("emphasis"),a=t.createTracker(i),o=a.move(r);let l=a.move(t.containerPhrasing(n,{after:r,before:o,...a.current()}));const c=l.charCodeAt(0),u=qi(i.before.charCodeAt(i.before.length-1),c,r);u.inside&&(l=oi(c)+l.slice(1));const h=l.charCodeAt(l.length-1),d=qi(i.after.charCodeAt(0),h,r);d.inside&&(l=l.slice(0,-1)+oi(h));const f=a.move(r);return s(),t.attentionEncodeSurroundingInfo={after:d.outside,before:u.outside},o+l+f}function Nx(n,e,t){return t.options.emphasis||"*"}function jx(n,e){let t=!1;return Ws(n,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return t=!0,cs}),!!((!n.depth||n.depth<3)&&zs(n)&&(e.options.setext||t))}function zx(n,e,t,i){const r=Math.max(Math.min(6,n.depth||1),1),s=t.createTracker(i);if(jx(n,t)){const u=t.enter("headingSetext"),h=t.enter("phrasing"),d=t.containerPhrasing(n,{...s.current(),before:`
`,after:`
`});return h(),u(),d+`
`+(r===1?"=":"-").repeat(d.length-(Math.max(d.lastIndexOf("\r"),d.lastIndexOf(`
`))+1))}const a="#".repeat(r),o=t.enter("headingAtx"),l=t.enter("phrasing");s.move(a+" ");let c=t.containerPhrasing(n,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(c)&&(c=oi(c.charCodeAt(0))+c.slice(1)),c=c?a+" "+c:a,t.options.closeAtx&&(c+=" "+a),l(),o(),c}jc.peek=Bx;function jc(n){return n.value||""}function Bx(){return"<"}zc.peek=Hx;function zc(n,e,t,i){const r=Xs(t),s=r==='"'?"Quote":"Apostrophe",a=t.enter("image");let o=t.enter("label");const l=t.createTracker(i);let c=l.move("![");return c+=l.move(t.safe(n.alt,{before:c,after:"]",...l.current()})),c+=l.move("]("),o(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(o=t.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(t.safe(n.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(o=t.enter("destinationRaw"),c+=l.move(t.safe(n.url,{before:c,after:n.title?" ":")",...l.current()}))),o(),n.title&&(o=t.enter(`title${s}`),c+=l.move(" "+r),c+=l.move(t.safe(n.title,{before:c,after:r,...l.current()})),c+=l.move(r),o()),c+=l.move(")"),a(),c}function Hx(){return"!"}Bc.peek=Ux;function Bc(n,e,t,i){const r=n.referenceType,s=t.enter("imageReference");let a=t.enter("label");const o=t.createTracker(i);let l=o.move("![");const c=t.safe(n.alt,{before:l,after:"]",...o.current()});l+=o.move(c+"]["),a();const u=t.stack;t.stack=[],a=t.enter("reference");const h=t.safe(t.associationId(n),{before:l,after:"]",...o.current()});return a(),t.stack=u,s(),r==="full"||!c||c!==h?l+=o.move(h+"]"):r==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function Ux(){return"!"}Hc.peek=$x;function Hc(n,e,t){let i=n.value||"",r="`",s=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++s<t.unsafe.length;){const a=t.unsafe[s],o=t.compilePattern(a);let l;if(a.atBreak)for(;l=o.exec(i);){let c=l.index;i.charCodeAt(c)===10&&i.charCodeAt(c-1)===13&&c--,i=i.slice(0,c)+" "+i.slice(l.index+1)}}return r+i+r}function $x(){return"`"}function Uc(n,e){const t=zs(n);return!!(!e.options.resourceLink&&n.url&&!n.title&&n.children&&n.children.length===1&&n.children[0].type==="text"&&(t===n.url||"mailto:"+t===n.url)&&/^[a-z][a-z+.-]+:/i.test(n.url)&&!/[\0- <>\u007F]/.test(n.url))}$c.peek=qx;function $c(n,e,t,i){const r=Xs(t),s=r==='"'?"Quote":"Apostrophe",a=t.createTracker(i);let o,l;if(Uc(n,t)){const u=t.stack;t.stack=[],o=t.enter("autolink");let h=a.move("<");return h+=a.move(t.containerPhrasing(n,{before:h,after:">",...a.current()})),h+=a.move(">"),o(),t.stack=u,h}o=t.enter("link"),l=t.enter("label");let c=a.move("[");return c+=a.move(t.containerPhrasing(n,{before:c,after:"](",...a.current()})),c+=a.move("]("),l(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(l=t.enter("destinationLiteral"),c+=a.move("<"),c+=a.move(t.safe(n.url,{before:c,after:">",...a.current()})),c+=a.move(">")):(l=t.enter("destinationRaw"),c+=a.move(t.safe(n.url,{before:c,after:n.title?" ":")",...a.current()}))),l(),n.title&&(l=t.enter(`title${s}`),c+=a.move(" "+r),c+=a.move(t.safe(n.title,{before:c,after:r,...a.current()})),c+=a.move(r),l()),c+=a.move(")"),o(),c}function qx(n,e,t){return Uc(n,t)?"<":"["}qc.peek=Vx;function qc(n,e,t,i){const r=n.referenceType,s=t.enter("linkReference");let a=t.enter("label");const o=t.createTracker(i);let l=o.move("[");const c=t.containerPhrasing(n,{before:l,after:"]",...o.current()});l+=o.move(c+"]["),a();const u=t.stack;t.stack=[],a=t.enter("reference");const h=t.safe(t.associationId(n),{before:l,after:"]",...o.current()});return a(),t.stack=u,s(),r==="full"||!c||c!==h?l+=o.move(h+"]"):r==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function Vx(){return"["}function Ys(n){const e=n.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function Wx(n){const e=Ys(n),t=n.options.bulletOther;if(!t)return e==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+t+"`) to be different");return t}function Gx(n){const e=n.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function Vc(n){const e=n.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function Xx(n,e,t,i){const r=t.enter("list"),s=t.bulletCurrent;let a=n.ordered?Gx(t):Ys(t);const o=n.ordered?a==="."?")":".":Wx(t);let l=e&&t.bulletLastUsed?a===t.bulletLastUsed:!1;if(!n.ordered){const u=n.children?n.children[0]:void 0;if((a==="*"||a==="-")&&u&&(!u.children||!u.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(l=!0),Vc(t)===a&&u){let h=-1;for(;++h<n.children.length;){const d=n.children[h];if(d&&d.type==="listItem"&&d.children&&d.children[0]&&d.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=o),t.bulletCurrent=a;const c=t.containerFlow(n,i);return t.bulletLastUsed=a,t.bulletCurrent=s,r(),c}function Yx(n){const e=n.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function Kx(n,e,t,i){const r=Yx(t);let s=t.bulletCurrent||Ys(t);e&&e.type==="list"&&e.ordered&&(s=(typeof e.start=="number"&&e.start>-1?e.start:1)+(t.options.incrementListMarker===!1?0:e.children.indexOf(n))+s);let a=s.length+1;(r==="tab"||r==="mixed"&&(e&&e.type==="list"&&e.spread||n.spread))&&(a=Math.ceil(a/4)*4);const o=t.createTracker(i);o.move(s+" ".repeat(a-s.length)),o.shift(a);const l=t.enter("listItem"),c=t.indentLines(t.containerFlow(n,o.current()),u);return l(),c;function u(h,d,f){return d?(f?"":" ".repeat(a))+h:(f?s:s+" ".repeat(a-s.length))+h}}function Qx(n,e,t,i){const r=t.enter("paragraph"),s=t.enter("phrasing"),a=t.containerPhrasing(n,i);return s(),r(),a}const Jx=Ki(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Zx(n,e,t,i){return(n.children.some(function(a){return Jx(a)})?t.containerPhrasing:t.containerFlow).call(t,n,i)}function ew(n){const e=n.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}Wc.peek=tw;function Wc(n,e,t,i){const r=ew(t),s=t.enter("strong"),a=t.createTracker(i),o=a.move(r+r);let l=a.move(t.containerPhrasing(n,{after:r,before:o,...a.current()}));const c=l.charCodeAt(0),u=qi(i.before.charCodeAt(i.before.length-1),c,r);u.inside&&(l=oi(c)+l.slice(1));const h=l.charCodeAt(l.length-1),d=qi(i.after.charCodeAt(0),h,r);d.inside&&(l=l.slice(0,-1)+oi(h));const f=a.move(r+r);return s(),t.attentionEncodeSurroundingInfo={after:d.outside,before:u.outside},o+l+f}function tw(n,e,t){return t.options.strong||"*"}function nw(n,e,t,i){return t.safe(n.value,i)}function iw(n){const e=n.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function rw(n,e,t){const i=(Vc(t)+(t.options.ruleSpaces?" ":"")).repeat(iw(t));return t.options.ruleSpaces?i.slice(0,-1):i}const Gc={blockquote:Cx,break:Xo,code:Dx,definition:Fx,emphasis:Nc,hardBreak:Xo,heading:zx,html:jc,image:zc,imageReference:Bc,inlineCode:Hc,link:$c,linkReference:qc,list:Xx,listItem:Kx,paragraph:Qx,root:Zx,strong:Wc,text:nw,thematicBreak:rw};function sw(){return{enter:{table:aw,tableData:Yo,tableHeader:Yo,tableRow:lw},exit:{codeText:cw,table:ow,tableData:Lr,tableHeader:Lr,tableRow:Lr}}}function aw(n){const e=n._align;this.enter({type:"table",align:e.map(function(t){return t==="none"?null:t}),children:[]},n),this.data.inTable=!0}function ow(n){this.exit(n),this.data.inTable=void 0}function lw(n){this.enter({type:"tableRow",children:[]},n)}function Lr(n){this.exit(n)}function Yo(n){this.enter({type:"tableCell",children:[]},n)}function cw(n){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,uw));const t=this.stack[this.stack.length-1];t.type,t.value=e,this.exit(n)}function uw(n,e){return e==="|"?e:n}function hw(n){const e=n||{},t=e.tableCellPadding,i=e.tablePipeAlign,r=e.stringLength,s=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:d,table:a,tableCell:l,tableRow:o}};function a(f,g,m,b){return c(u(f,m,b),f.align)}function o(f,g,m,b){const y=h(f,m,b),x=c([y]);return x.slice(0,x.indexOf(`
`))}function l(f,g,m,b){const y=m.enter("tableCell"),x=m.enter("phrasing"),A=m.containerPhrasing(f,{...b,before:s,after:s});return x(),y(),A}function c(f,g){return kx(f,{align:g,alignDelimiters:i,padding:t,stringLength:r})}function u(f,g,m){const b=f.children;let y=-1;const x=[],A=g.enter("table");for(;++y<b.length;)x[y]=h(b[y],g,m);return A(),x}function h(f,g,m){const b=f.children;let y=-1;const x=[],A=g.enter("tableRow");for(;++y<b.length;)x[y]=l(b[y],f,g,m);return A(),x}function d(f,g,m){let b=Gc.inlineCode(f,g,m);return m.stack.includes("tableCell")&&(b=b.replace(/\|/g,"\\$&")),b}}function dw(){return{exit:{taskListCheckValueChecked:Ko,taskListCheckValueUnchecked:Ko,paragraph:pw}}}function fw(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:gw}}}function Ko(n){const e=this.stack[this.stack.length-2];e.type,e.checked=n.type==="taskListCheckValueChecked"}function pw(n){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const i=t.children[0];if(i&&i.type==="text"){const r=e.children;let s=-1,a;for(;++s<r.length;){const o=r[s];if(o.type==="paragraph"){a=o;break}}a===t&&(i.value=i.value.slice(1),i.value.length===0?t.children.shift():t.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,t.position.start=Object.assign({},i.position.start)))}}this.exit(n)}function gw(n,e,t,i){const r=n.children[0],s=typeof n.checked=="boolean"&&r&&r.type==="paragraph",a="["+(n.checked?"x":" ")+"] ",o=t.createTracker(i);s&&o.move(a);let l=Gc.listItem(n,e,t,{...i,...o.current()});return s&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),l;function c(u){return u+a}}function mw(){return[Xb(),gx(),xx(),sw(),dw()]}function yw(n){return{extensions:[Yb(),mx(n),wx(),hw(n),fw()]}}const bw={tokenize:Sw,partial:!0},Xc={tokenize:kw,partial:!0},Yc={tokenize:Ew,partial:!0},Kc={tokenize:Cw,partial:!0},xw={tokenize:Tw,partial:!0},Qc={name:"wwwAutolink",tokenize:Aw,previous:Zc},Jc={name:"protocolAutolink",tokenize:_w,previous:eu},Ot={name:"emailAutolink",tokenize:vw,previous:tu},St={};function ww(){return{text:St}}let Qt=48;for(;Qt<123;)St[Qt]=Ot,Qt++,Qt===58?Qt=65:Qt===91&&(Qt=97);St[43]=Ot;St[45]=Ot;St[46]=Ot;St[95]=Ot;St[72]=[Ot,Jc];St[104]=[Ot,Jc];St[87]=[Ot,Qc];St[119]=[Ot,Qc];function vw(n,e,t){const i=this;let r,s;return a;function a(h){return!fs(h)||!tu.call(i,i.previous)||Ks(i.events)?t(h):(n.enter("literalAutolink"),n.enter("literalAutolinkEmail"),o(h))}function o(h){return fs(h)?(n.consume(h),o):h===64?(n.consume(h),l):t(h)}function l(h){return h===46?n.check(xw,u,c)(h):h===45||h===95||Ve(h)?(s=!0,n.consume(h),l):u(h)}function c(h){return n.consume(h),r=!0,l}function u(h){return s&&r&&Ke(i.previous)?(n.exit("literalAutolinkEmail"),n.exit("literalAutolink"),e(h)):t(h)}}function Aw(n,e,t){const i=this;return r;function r(a){return a!==87&&a!==119||!Zc.call(i,i.previous)||Ks(i.events)?t(a):(n.enter("literalAutolink"),n.enter("literalAutolinkWww"),n.check(bw,n.attempt(Xc,n.attempt(Yc,s),t),t)(a))}function s(a){return n.exit("literalAutolinkWww"),n.exit("literalAutolink"),e(a)}}function _w(n,e,t){const i=this;let r="",s=!1;return a;function a(h){return(h===72||h===104)&&eu.call(i,i.previous)&&!Ks(i.events)?(n.enter("literalAutolink"),n.enter("literalAutolinkHttp"),r+=String.fromCodePoint(h),n.consume(h),o):t(h)}function o(h){if(Ke(h)&&r.length<5)return r+=String.fromCodePoint(h),n.consume(h),o;if(h===58){const d=r.toLowerCase();if(d==="http"||d==="https")return n.consume(h),l}return t(h)}function l(h){return h===47?(n.consume(h),s?c:(s=!0,l)):t(h)}function c(h){return h===null||Hi(h)||ve(h)||ln(h)||Gi(h)?t(h):n.attempt(Xc,n.attempt(Yc,u),t)(h)}function u(h){return n.exit("literalAutolinkHttp"),n.exit("literalAutolink"),e(h)}}function Sw(n,e,t){let i=0;return r;function r(a){return(a===87||a===119)&&i<3?(i++,n.consume(a),r):a===46&&i===3?(n.consume(a),s):t(a)}function s(a){return a===null?t(a):e(a)}}function kw(n,e,t){let i,r,s;return a;function a(c){return c===46||c===95?n.check(Kc,l,o)(c):c===null||ve(c)||ln(c)||c!==45&&Gi(c)?l(c):(s=!0,n.consume(c),a)}function o(c){return c===95?i=!0:(r=i,i=void 0),n.consume(c),a}function l(c){return r||i||!s?t(c):e(c)}}function Ew(n,e){let t=0,i=0;return r;function r(a){return a===40?(t++,n.consume(a),r):a===41&&i<t?s(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?n.check(Kc,e,s)(a):a===null||ve(a)||ln(a)?e(a):(n.consume(a),r)}function s(a){return a===41&&i++,n.consume(a),r}}function Cw(n,e,t){return i;function i(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(n.consume(o),i):o===38?(n.consume(o),s):o===93?(n.consume(o),r):o===60||o===null||ve(o)||ln(o)?e(o):t(o)}function r(o){return o===null||o===40||o===91||ve(o)||ln(o)?e(o):i(o)}function s(o){return Ke(o)?a(o):t(o)}function a(o){return o===59?(n.consume(o),i):Ke(o)?(n.consume(o),a):t(o)}}function Tw(n,e,t){return i;function i(s){return n.consume(s),r}function r(s){return Ve(s)?t(s):e(s)}}function Zc(n){return n===null||n===40||n===42||n===95||n===91||n===93||n===126||ve(n)}function eu(n){return!Ke(n)}function tu(n){return!(n===47||fs(n))}function fs(n){return n===43||n===45||n===46||n===95||Ve(n)}function Ks(n){let e=n.length,t=!1;for(;e--;){const i=n[e][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){t=!0;break}if(i._gfmAutolinkLiteralWalkedInto){t=!1;break}}return n.length>0&&!t&&(n[n.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const Pw={tokenize:Nw,partial:!0};function Rw(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:Mw,continuation:{tokenize:Fw},exit:Ow}},text:{91:{name:"gfmFootnoteCall",tokenize:Dw},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:Iw,resolveTo:Lw}}}}function Iw(n,e,t){const i=this;let r=i.events.length;const s=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a;for(;r--;){const l=i.events[r][1];if(l.type==="labelImage"){a=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return o;function o(l){if(!a||!a._balanced)return t(l);const c=bt(i.sliceSerialize({start:a.end,end:i.now()}));return c.codePointAt(0)!==94||!s.includes(c.slice(1))?t(l):(n.enter("gfmFootnoteCallLabelMarker"),n.consume(l),n.exit("gfmFootnoteCallLabelMarker"),e(l))}}function Lw(n,e){let t=n.length;for(;t--;)if(n[t][1].type==="labelImage"&&n[t][0]==="enter"){n[t][1];break}n[t+1][1].type="data",n[t+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},n[t+3][1].start),end:Object.assign({},n[n.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},n[t+3][1].end),end:Object.assign({},n[t+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},n[n.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},o=[n[t+1],n[t+2],["enter",i,e],n[t+3],n[t+4],["enter",r,e],["exit",r,e],["enter",s,e],["enter",a,e],["exit",a,e],["exit",s,e],n[n.length-2],n[n.length-1],["exit",i,e]];return n.splice(t,n.length-t+1,...o),n}function Dw(n,e,t){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s=0,a;return o;function o(h){return n.enter("gfmFootnoteCall"),n.enter("gfmFootnoteCallLabelMarker"),n.consume(h),n.exit("gfmFootnoteCallLabelMarker"),l}function l(h){return h!==94?t(h):(n.enter("gfmFootnoteCallMarker"),n.consume(h),n.exit("gfmFootnoteCallMarker"),n.enter("gfmFootnoteCallString"),n.enter("chunkString").contentType="string",c)}function c(h){if(s>999||h===93&&!a||h===null||h===91||ve(h))return t(h);if(h===93){n.exit("chunkString");const d=n.exit("gfmFootnoteCallString");return r.includes(bt(i.sliceSerialize(d)))?(n.enter("gfmFootnoteCallLabelMarker"),n.consume(h),n.exit("gfmFootnoteCallLabelMarker"),n.exit("gfmFootnoteCall"),e):t(h)}return ve(h)||(a=!0),s++,n.consume(h),h===92?u:c}function u(h){return h===91||h===92||h===93?(n.consume(h),s++,c):c(h)}}function Mw(n,e,t){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s,a=0,o;return l;function l(g){return n.enter("gfmFootnoteDefinition")._container=!0,n.enter("gfmFootnoteDefinitionLabel"),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(g),n.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(g){return g===94?(n.enter("gfmFootnoteDefinitionMarker"),n.consume(g),n.exit("gfmFootnoteDefinitionMarker"),n.enter("gfmFootnoteDefinitionLabelString"),n.enter("chunkString").contentType="string",u):t(g)}function u(g){if(a>999||g===93&&!o||g===null||g===91||ve(g))return t(g);if(g===93){n.exit("chunkString");const m=n.exit("gfmFootnoteDefinitionLabelString");return s=bt(i.sliceSerialize(m)),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(g),n.exit("gfmFootnoteDefinitionLabelMarker"),n.exit("gfmFootnoteDefinitionLabel"),d}return ve(g)||(o=!0),a++,n.consume(g),g===92?h:u}function h(g){return g===91||g===92||g===93?(n.consume(g),a++,u):u(g)}function d(g){return g===58?(n.enter("definitionMarker"),n.consume(g),n.exit("definitionMarker"),r.includes(s)||r.push(s),pe(n,f,"gfmFootnoteDefinitionWhitespace")):t(g)}function f(g){return e(g)}}function Fw(n,e,t){return n.check(ui,e,n.attempt(Pw,e,t))}function Ow(n){n.exit("gfmFootnoteDefinition")}function Nw(n,e,t){const i=this;return pe(n,r,"gfmFootnoteDefinitionIndent",5);function r(s){const a=i.events[i.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?e(s):t(s)}}function jw(n){let t=(n||{}).singleTilde;const i={name:"strikethrough",tokenize:s,resolveAll:r};return t==null&&(t=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function r(a,o){let l=-1;for(;++l<a.length;)if(a[l][0]==="enter"&&a[l][1].type==="strikethroughSequenceTemporary"&&a[l][1]._close){let c=l;for(;c--;)if(a[c][0]==="exit"&&a[c][1].type==="strikethroughSequenceTemporary"&&a[c][1]._open&&a[l][1].end.offset-a[l][1].start.offset===a[c][1].end.offset-a[c][1].start.offset){a[l][1].type="strikethroughSequence",a[c][1].type="strikethroughSequence";const u={type:"strikethrough",start:Object.assign({},a[c][1].start),end:Object.assign({},a[l][1].end)},h={type:"strikethroughText",start:Object.assign({},a[c][1].end),end:Object.assign({},a[l][1].start)},d=[["enter",u,o],["enter",a[c][1],o],["exit",a[c][1],o],["enter",h,o]],f=o.parser.constructs.insideSpan.null;f&&lt(d,d.length,0,Xi(f,a.slice(c+1,l),o)),lt(d,d.length,0,[["exit",h,o],["enter",a[l][1],o],["exit",a[l][1],o],["exit",u,o]]),lt(a,c-1,l-c+3,d),l=c+d.length-2;break}}for(l=-1;++l<a.length;)a[l][1].type==="strikethroughSequenceTemporary"&&(a[l][1].type="data");return a}function s(a,o,l){const c=this.previous,u=this.events;let h=0;return d;function d(g){return c===126&&u[u.length-1][1].type!=="characterEscape"?l(g):(a.enter("strikethroughSequenceTemporary"),f(g))}function f(g){const m=Ln(c);if(g===126)return h>1?l(g):(a.consume(g),h++,f);if(h<2&&!t)return l(g);const b=a.exit("strikethroughSequenceTemporary"),y=Ln(g);return b._open=!y||y===2&&!!m,b._close=!m||m===2&&!!y,o(g)}}}class zw{constructor(){this.map=[]}add(e,t,i){Bw(this,e,t,i)}consume(e){if(this.map.sort(function(s,a){return s[0]-a[0]}),this.map.length===0)return;let t=this.map.length;const i=[];for(;t>0;)t-=1,i.push(e.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),e.length=this.map[t][0];i.push(e.slice()),e.length=0;let r=i.pop();for(;r;){for(const s of r)e.push(s);r=i.pop()}this.map.length=0}}function Bw(n,e,t,i){let r=0;if(!(t===0&&i.length===0)){for(;r<n.map.length;){if(n.map[r][0]===e){n.map[r][1]+=t,n.map[r][2].push(...i);return}r+=1}n.map.push([e,t,i])}}function Hw(n,e){let t=!1;const i=[];for(;e<n.length;){const r=n[e];if(t){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(n[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(n[e-1][1].type==="tableDelimiterMarker"){const s=i.length-1;i[s]=i[s]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(t=!0);e+=1}return i}function Uw(){return{flow:{null:{name:"table",tokenize:$w,resolveAll:qw}}}}function $w(n,e,t){const i=this;let r=0,s=0,a;return o;function o(S){let R=i.events.length-1;for(;R>-1;){const M=i.events[R][1].type;if(M==="lineEnding"||M==="linePrefix")R--;else break}const I=R>-1?i.events[R][1].type:null,F=I==="tableHead"||I==="tableRow"?_:l;return F===_&&i.parser.lazy[i.now().line]?t(S):F(S)}function l(S){return n.enter("tableHead"),n.enter("tableRow"),c(S)}function c(S){return S===124||(a=!0,s+=1),u(S)}function u(S){return S===null?t(S):J(S)?s>1?(s=0,i.interrupt=!0,n.exit("tableRow"),n.enter("lineEnding"),n.consume(S),n.exit("lineEnding"),f):t(S):ue(S)?pe(n,u,"whitespace")(S):(s+=1,a&&(a=!1,r+=1),S===124?(n.enter("tableCellDivider"),n.consume(S),n.exit("tableCellDivider"),a=!0,u):(n.enter("data"),h(S)))}function h(S){return S===null||S===124||ve(S)?(n.exit("data"),u(S)):(n.consume(S),S===92?d:h)}function d(S){return S===92||S===124?(n.consume(S),h):h(S)}function f(S){return i.interrupt=!1,i.parser.lazy[i.now().line]?t(S):(n.enter("tableDelimiterRow"),a=!1,ue(S)?pe(n,g,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(S):g(S))}function g(S){return S===45||S===58?b(S):S===124?(a=!0,n.enter("tableCellDivider"),n.consume(S),n.exit("tableCellDivider"),m):E(S)}function m(S){return ue(S)?pe(n,b,"whitespace")(S):b(S)}function b(S){return S===58?(s+=1,a=!0,n.enter("tableDelimiterMarker"),n.consume(S),n.exit("tableDelimiterMarker"),y):S===45?(s+=1,y(S)):S===null||J(S)?k(S):E(S)}function y(S){return S===45?(n.enter("tableDelimiterFiller"),x(S)):E(S)}function x(S){return S===45?(n.consume(S),x):S===58?(a=!0,n.exit("tableDelimiterFiller"),n.enter("tableDelimiterMarker"),n.consume(S),n.exit("tableDelimiterMarker"),A):(n.exit("tableDelimiterFiller"),A(S))}function A(S){return ue(S)?pe(n,k,"whitespace")(S):k(S)}function k(S){return S===124?g(S):S===null||J(S)?!a||r!==s?E(S):(n.exit("tableDelimiterRow"),n.exit("tableHead"),e(S)):E(S)}function E(S){return t(S)}function _(S){return n.enter("tableRow"),P(S)}function P(S){return S===124?(n.enter("tableCellDivider"),n.consume(S),n.exit("tableCellDivider"),P):S===null||J(S)?(n.exit("tableRow"),e(S)):ue(S)?pe(n,P,"whitespace")(S):(n.enter("data"),D(S))}function D(S){return S===null||S===124||ve(S)?(n.exit("data"),P(S)):(n.consume(S),S===92?O:D)}function O(S){return S===92||S===124?(n.consume(S),D):D(S)}}function qw(n,e){let t=-1,i=!0,r=0,s=[0,0,0,0],a=[0,0,0,0],o=!1,l=0,c,u,h;const d=new zw;for(;++t<n.length;){const f=n[t],g=f[1];f[0]==="enter"?g.type==="tableHead"?(o=!1,l!==0&&(Qo(d,e,l,c,u),u=void 0,l=0),c={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},d.add(t,0,[["enter",c,e]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(i=!0,h=void 0,s=[0,0,0,0],a=[0,t+1,0,0],o&&(o=!1,u={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},d.add(t,0,[["enter",u,e]])),r=g.type==="tableDelimiterRow"?2:u?3:1):r&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(i=!1,a[2]===0&&(s[1]!==0&&(a[0]=a[1],h=Ai(d,e,s,r,void 0,h),s=[0,0,0,0]),a[2]=t)):g.type==="tableCellDivider"&&(i?i=!1:(s[1]!==0&&(a[0]=a[1],h=Ai(d,e,s,r,void 0,h)),s=a,a=[s[1],t,0,0])):g.type==="tableHead"?(o=!0,l=t):g.type==="tableRow"||g.type==="tableDelimiterRow"?(l=t,s[1]!==0?(a[0]=a[1],h=Ai(d,e,s,r,t,h)):a[1]!==0&&(h=Ai(d,e,a,r,t,h)),r=0):r&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(a[3]=t)}for(l!==0&&Qo(d,e,l,c,u),d.consume(e.events),t=-1;++t<e.events.length;){const f=e.events[t];f[0]==="enter"&&f[1].type==="table"&&(f[1]._align=Hw(e.events,t))}return n}function Ai(n,e,t,i,r,s){const a=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",o="tableContent";t[0]!==0&&(s.end=Object.assign({},xn(e.events,t[0])),n.add(t[0],0,[["exit",s,e]]));const l=xn(e.events,t[1]);if(s={type:a,start:Object.assign({},l),end:Object.assign({},l)},n.add(t[1],0,[["enter",s,e]]),t[2]!==0){const c=xn(e.events,t[2]),u=xn(e.events,t[3]),h={type:o,start:Object.assign({},c),end:Object.assign({},u)};if(n.add(t[2],0,[["enter",h,e]]),i!==2){const d=e.events[t[2]],f=e.events[t[3]];if(d[1].end=Object.assign({},f[1].end),d[1].type="chunkText",d[1].contentType="text",t[3]>t[2]+1){const g=t[2]+1,m=t[3]-t[2]-1;n.add(g,m,[])}}n.add(t[3]+1,0,[["exit",h,e]])}return r!==void 0&&(s.end=Object.assign({},xn(e.events,r)),n.add(r,0,[["exit",s,e]]),s=void 0),s}function Qo(n,e,t,i,r){const s=[],a=xn(e.events,t);r&&(r.end=Object.assign({},a),s.push(["exit",r,e])),i.end=Object.assign({},a),s.push(["exit",i,e]),n.add(t+1,0,s)}function xn(n,e){const t=n[e],i=t[0]==="enter"?"start":"end";return t[1][i]}const Vw={name:"tasklistCheck",tokenize:Gw};function Ww(){return{text:{91:Vw}}}function Gw(n,e,t){const i=this;return r;function r(l){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?t(l):(n.enter("taskListCheck"),n.enter("taskListCheckMarker"),n.consume(l),n.exit("taskListCheckMarker"),s)}function s(l){return ve(l)?(n.enter("taskListCheckValueUnchecked"),n.consume(l),n.exit("taskListCheckValueUnchecked"),a):l===88||l===120?(n.enter("taskListCheckValueChecked"),n.consume(l),n.exit("taskListCheckValueChecked"),a):t(l)}function a(l){return l===93?(n.enter("taskListCheckMarker"),n.consume(l),n.exit("taskListCheckMarker"),n.exit("taskListCheck"),o):t(l)}function o(l){return J(l)?e(l):ue(l)?n.check({tokenize:Xw},e,t)(l):t(l)}}function Xw(n,e,t){return pe(n,i,"whitespace");function i(r){return r===null?t(r):e(r)}}function Yw(n){return dc([ww(),Rw(),jw(n),Uw(),Ww()])}const Kw={};function Qw(n){const e=this,t=n||Kw,i=e.data(),r=i.micromarkExtensions||(i.micromarkExtensions=[]),s=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),a=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);r.push(Yw(t)),s.push(mw()),a.push(yw(t))}var He=(n=>(n.Answer="answer",n.Message="message",n.Citation="citation",n.Info="info",n.Error="error",n))(He||{}),an=(n=>(n.User="user",n.Assistant="assistant",n))(an||{}),nu=(n=>(n.ChatCompletions="chat_completions",n))(nu||{}),ps=(n=>(n.Text="text",n))(ps||{});const Jw="modulepreload",Zw=function(n){return"/"+n},Jo={},_i=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");r=a(t.map(c=>{if(c=Zw(c),c in Jo)return;Jo[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Jw,u||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,g)=>{d.addEventListener("load",f),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};var Jn={};Jn.d=(n,e)=>{for(var t in e)Jn.o(e,t)&&!Jn.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};Jn.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var re=globalThis.pdfjsLib={};Jn.d(re,{AbortException:()=>pn,AnnotationEditorLayer:()=>Lt,AnnotationEditorParamsType:()=>te,AnnotationEditorType:()=>oe,AnnotationEditorUIManager:()=>qt,AnnotationLayer:()=>Q0,AnnotationMode:()=>Ht,ColorPicker:()=>dt,DOMSVGFactory:()=>ha,DrawLayer:()=>$e,FeatureTest:()=>Qe,GlobalWorkerOptions:()=>ei,ImageKind:()=>Ri,InvalidPDFException:()=>ru,MissingPDFException:()=>fn,OPS:()=>mt,OutputScale:()=>bs,PDFDataRangeTransport:()=>Au,PDFDateString:()=>au,PDFWorker:()=>ze,PasswordResponses:()=>iv,PermissionFlag:()=>nv,PixelsPerInch:()=>Dn,RenderingCancelledException:()=>Zs,TextLayer:()=>_s,UnexpectedResponseException:()=>tr,Util:()=>K,VerbosityLevel:()=>Ji,XfaLayer:()=>Su,build:()=>I0,createValidAbsoluteUrl:()=>ov,fetchData:()=>ir,getDocument:()=>A0,getFilenameFromUrl:()=>mv,getPdfFilenameFromUrl:()=>yv,getXfaPageViewport:()=>bv,isDataScheme:()=>rr,isPdfFile:()=>ea,noContextMenu:()=>pt,normalizeUnicode:()=>fv,setLayerDimensions:()=>cn,shadow:()=>fe,version:()=>R0});const We=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),iu=[1,0,0,1,0,0],gs=[.001,0,0,.001,0,0],ev=1e7,Dr=1.35,ot={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ht={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},tv="pdfjs_internal_editor_",oe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},te={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},nv={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ue={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ri={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Fe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},qn={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Ji={ERRORS:0,WARNINGS:1,INFOS:5},mt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},iv={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Zi=Ji.WARNINGS;function rv(n){Number.isInteger(n)&&(Zi=n)}function sv(){return Zi}function er(n){Zi>=Ji.INFOS&&console.log(`Info: ${n}`)}function ce(n){Zi>=Ji.WARNINGS&&console.log(`Warning: ${n}`)}function ke(n){throw new Error(n)}function Ne(n,e){n||ke(e)}function av(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ov(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=dv(n)}catch{}const i=e?new URL(n,e):new URL(n);if(av(i))return i}catch{}return null}function fe(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const Gt=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class ms extends Gt{constructor(e,t){super(e,"PasswordException"),this.code=t}}class ys extends Gt{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ru extends Gt{constructor(e){super(e,"InvalidPDFException")}}class fn extends Gt{constructor(e){super(e,"MissingPDFException")}}class tr extends Gt{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class lv extends Gt{constructor(e){super(e,"FormatError")}}class pn extends Gt{constructor(e){super(e,"AbortException")}}function su(n){(typeof n!="object"||n?.length===void 0)&&ke("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let r=0;r<e;r+=t){const s=Math.min(r+t,e),a=n.subarray(r,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function nr(n){typeof n!="string"&&ke("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function cv(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Qs(n){const e=Object.create(null);for(const[t,i]of n)e[t]=i;return e}function uv(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function hv(){try{return new Function(""),!0}catch{return!1}}class Qe{static get isLittleEndian(){return fe(this,"isLittleEndian",uv())}static get isEvalSupported(){return fe(this,"isEvalSupported",hv())}static get isOffscreenCanvasSupported(){return fe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?fe(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):fe(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return fe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Mr=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class K{static makeHexColor(e,t,i){return`#${Mr[e]}${Mr[t]}${Mr[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],r=e[0]*t[1]+e[1]*t[3]+t[5];return[i,r]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],r=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,s=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[r,s]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),s=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],r[0],s[0],a[0]),Math.min(i[1],r[1],s[1],a[1]),Math.max(i[0],r[0],s[0],a[0]),Math.max(i[1],r[1],s[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],s=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(i+a)/2,l=Math.sqrt((i+a)**2-4*(i*a-s*r))/2,c=o+l||1,u=o-l||1;return[Math.sqrt(c),Math.sqrt(u)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>r)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[i,s,r,a]}static#e(e,t,i,r,s,a,o,l,c,u){if(c<=0||c>=1)return;const h=1-c,d=c*c,f=d*c,g=h*(h*(h*e+3*c*t)+3*d*i)+f*r,m=h*(h*(h*s+3*c*a)+3*d*o)+f*l;u[0]=Math.min(u[0],g),u[1]=Math.min(u[1],m),u[2]=Math.max(u[2],g),u[3]=Math.max(u[3],m)}static#t(e,t,i,r,s,a,o,l,c,u,h,d){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&this.#e(e,t,i,r,s,a,o,l,-h/u,d);return}const f=u**2-4*h*c;if(f<0)return;const g=Math.sqrt(f),m=2*c;this.#e(e,t,i,r,s,a,o,l,(-u+g)/m,d),this.#e(e,t,i,r,s,a,o,l,(-u-g)/m,d)}static bezierBoundingBox(e,t,i,r,s,a,o,l,c){return c?(c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],this.#t(e,i,s,o,t,r,a,l,3*(-e+3*(i-s)+o),6*(e-2*i+s),3*(i-e),c),this.#t(e,i,s,o,t,r,a,l,3*(-t+3*(r-a)+l),6*(t-2*r+a),3*(r-t),c),c}}function dv(n){return decodeURIComponent(escape(n))}let Fr=null,Zo=null;function fv(n){return Fr||(Fr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Zo=new Map([["ﬅ","ſt"]])),n.replaceAll(Fr,(e,t,i)=>t?t.normalize("NFKC"):Zo.get(i))}function pv(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(n);else for(let e=0;e<32;e++)n[e]=Math.floor(Math.random()*255);return su(n)}const Js="pdfjs_internal_id_",Tt={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function gv(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(su(n))}const It="http://www.w3.org/2000/svg";class Dn{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ir(n,e="text"){if(Gn(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class di{constructor({viewBox:e,scale:t,rotation:i,offsetX:r=0,offsetY:s=0,dontFlip:a=!1}){this.viewBox=e,this.scale=t,this.rotation=i,this.offsetX=r,this.offsetY=s;const o=(e[2]+e[0])/2,l=(e[3]+e[1])/2;let c,u,h,d;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,u=0,h=0,d=1;break;case 90:c=0,u=1,h=1,d=0;break;case 270:c=0,u=-1,h=-1,d=0;break;case 0:c=1,u=0,h=0,d=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(h=-h,d=-d);let f,g,m,b;c===0?(f=Math.abs(l-e[1])*t+r,g=Math.abs(o-e[0])*t+s,m=(e[3]-e[1])*t,b=(e[2]-e[0])*t):(f=Math.abs(o-e[0])*t+r,g=Math.abs(l-e[1])*t+s,m=(e[2]-e[0])*t,b=(e[3]-e[1])*t),this.transform=[c*t,u*t,h*t,d*t,f-c*t*o-h*t*l,g-u*t*o-d*t*l],this.width=m,this.height=b}get rawDims(){const{viewBox:e}=this;return fe(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:s=!1}={}){return new di({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:s})}convertToViewportPoint(e,t){return K.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=K.applyTransform([e[0],e[1]],this.transform),i=K.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return K.applyInverseTransform([e,t],this.transform)}}class Zs extends Gt{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function rr(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function ea(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function mv(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function yv(n,e="document.pdf"){if(typeof n!="string")return e;if(rr(n))return ce('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=t.exec(n);let s=i.exec(r[1])||i.exec(r[2])||i.exec(r[3]);if(s&&(s=s[0],s.includes("%")))try{s=i.exec(decodeURIComponent(s))[0]}catch{}return s||e}class el{started=Object.create(null);times=[];time(e){e in this.started&&ce(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ce(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:r,end:s}of this.times)e.push(`${i.padEnd(t)} ${s-r}ms
`);return e.join("")}}function Gn(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function pt(n){n.preventDefault()}function tl(n){console.log("Deprecated API usage: "+n)}class au{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const i=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,c==="-"?(a+=u,o+=h):c==="+"&&(a-=u,o-=h),new Date(Date.UTC(i,r,s,a,o,l))}}function bv(n,{scale:e=1,rotation:t=0}){const{width:i,height:r}=n.attributes.style,s=[0,0,parseInt(i),parseInt(r)];return new di({viewBox:s,scale:e,rotation:t})}function ta(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ce(`Not a valid color format: "${n}"`),[0,0,0])}function xv(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,ta(i))}e.remove()}function Ce(n){const{a:e,b:t,c:i,d:r,e:s,f:a}=n.getTransform();return[e,t,i,r,s,a]}function Pt(n){const{a:e,b:t,c:i,d:r,e:s,f:a}=n.getTransform().invertSelf();return[e,t,i,r,s,a]}function cn(n,e,t=!1,i=!0){if(e instanceof di){const{pageWidth:r,pageHeight:s}=e.rawDims,{style:a}=n,o=Qe.isCSSRoundSupported,l=`var(--scale-factor) * ${r}px`,c=`var(--scale-factor) * ${s}px`,u=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,h=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=u,a.height=h):(a.width=h,a.height=u)}i&&n.setAttribute("data-main-rotation",e.rotation)}class bs{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class Zn{#e=null;#t=null;#n;#i=null;#s=null;static#r=null;constructor(e){this.#n=e,Zn.#r||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;e.addEventListener("contextmenu",pt,{signal:t}),e.addEventListener("pointerdown",Zn.#l,{signal:t});const i=this.#i=document.createElement("div");i.className="buttons",e.append(i);const r=this.#n.toolbarPosition;if(r){const{style:s}=e,a=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#h(),e}get div(){return this.#e}static#l(e){e.stopPropagation()}#c(e){this.#n._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()}#u(e){this.#n._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()}#o(e){const t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",pt,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#s?.shown()}#h(){const{editorType:e,_uiManager:t}=this.#n,i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",Zn.#r[e]),this.#o(i),i.addEventListener("click",r=>{t.delete()},{signal:t._signal}),this.#i.append(i)}get#a(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#o(t),this.#i.prepend(t,this.#a),this.#s=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#o(t),this.#i.prepend(t,this.#a)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class wv{#e=null;#t=null;#n;constructor(e){this.#n=e}#i(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",pt,{signal:this.#n._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#r(),e}#s(e,t){let i=0,r=0;for(const s of e){const a=s.y+s.height;if(a<i)continue;const o=s.x+(t?s.width:0);if(a>i){r=o,i=a;continue}t?o>r&&(r=o):o<r&&(r=o)}return[t?1-r:r,i]}show(e,t,i){const[r,s]=this.#s(t,i),{style:a}=this.#t||=this.#i();e.append(this.#t),a.insetInlineEnd=`${100*r}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#r(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=this.#n._signal;e.addEventListener("contextmenu",pt,{signal:i}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:i}),this.#e.append(e)}}function Vi(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}function vv(n){return Math.round(Math.min(255,Math.max(1,255*n))).toString(16).padStart(2,"0")}class Av{#e=0;get id(){return`${tv}${this.#e++}`}}class na{#e=pv();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const s=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return fe(this,"_isSVGFittingCanvas",s)}async#i(e,t){this.#n||=new Map;let i=this.#n.get(e);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let r;if(typeof t=="string"?(i.url=t,r=await ir(t,"blob")):t instanceof File?r=i.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const s=na._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,u)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const h=i.svgUrl=a.result;o.src=await s?`${h}#svgView(preserveAspectRatio(none))`:h},o.onerror=a.onerror=u});a.readAsDataURL(r),await l}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){console.error(r),i=null}return this.#n.set(e,i),i&&this.#n.set(i.id,i),i}async getFromFile(e){const{lastModified:t,name:i,size:r,type:s}=e;return this.#i(`${t}_${i}_${r}_${s}`,e)}async getFromUrl(e){return this.#i(e,e)}async getFromBlob(e,t){const i=await t;return this.#i(e,i)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let i=this.#n.get(e);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,i),this.#n.set(i.id,i),i}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}i.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class _v{#e=[];#t=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:i,mustExec:r,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(r&&e(),this.#t)return;const l={cmd:e,undo:t,post:i,type:s};if(this.#i===-1){this.#e.length>0&&(this.#e.length=0),this.#i=0,this.#e.push(l);return}if(a&&this.#e[this.#i].type===s){o&&(l.undo=this.#e[this.#i].undo),this.#e[this.#i]=l;return}const c=this.#i+1;c===this.#n?this.#e.splice(0,1):(this.#i=c,c<this.#e.length&&this.#e.splice(c)),this.#e.push(l)}undo(){if(this.#i===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1,this.#i-=1}redo(){if(this.#i<this.#e.length-1){this.#i+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#e.length-1}destroy(){this.#e=null}}class fi{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Qe.platform;for(const[i,r,s={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(this.#e(t));if(!i)return;const{callback:r,options:{bubbles:s=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(r.bind(e,...a,t)(),s||(t.stopPropagation(),t.preventDefault()))}}class ia{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return xv(e),fe(this,"_colors",e)}convert(e){const t=ta(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,r]of this._colors)if(r.every((s,a)=>s===t[a]))return ia._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?K.makeHexColor(...t):e}}class qt{#e=new AbortController;#t=null;#n=new Map;#i=new Map;#s=null;#r=null;#l=null;#c=new _v;#u=null;#o=0;#h=new Set;#a=null;#d=null;#p=new Set;#f=!1;#y=!1;#m=!1;#g=null;#b=null;#w=null;#E=null;#_=!1;#S=null;#F=new Av;#C=!1;#v=!1;#k=null;#T=null;#P=null;#L=null;#A=oe.NONE;#x=new Set;#D=null;#M=null;#O=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#N=null;#j=null;#H=null;#R=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=qt.prototype,t=a=>a.#j.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},r=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return fe(this,"_keyboardManager",new fi([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#j.contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#j.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}constructor(e,t,i,r,s,a,o,l,c,u,h){const d=this._signal=this.#e.signal;this.#j=e,this.#H=t,this.#s=i,this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:d}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:d}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:d}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:d}),r._on("setpreference",this.onSetPreference.bind(this),{signal:d}),r._on("switchannotationeditorparams",f=>this.updateParams(f.type,f.value),{signal:d}),this.#ee(),this.#re(),this.#G(),this.#r=s.annotationStorage,this.#g=s.filterFactory,this.#M=a,this.#E=o||null,this.#f=l,this.#y=c,this.#m=u,this.#L=h||null,this.viewParameters={realScale:Dn.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#R?.resolve(),this.#R=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#i.values())e.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#t=null,this.#x.clear(),this.#c.destroy(),this.#s?.destroy(),this.#S?.hide(),this.#S=null,this.#b&&(clearTimeout(this.#b),this.#b=null),this.#N&&(clearTimeout(this.#N),this.#N=null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#L}get useNewAltTextFlow(){return this.#y}get useNewAltTextWhenAddingImage(){return this.#m}get hcmFilter(){return fe(this,"hcmFilter",this.#M?this.#g.addHCMFilter(this.#M.foreground,this.#M.background):"none")}get direction(){return fe(this,"direction",getComputedStyle(this.#j).direction)}get highlightColors(){return fe(this,"highlightColors",this.#E?new Map(this.#E.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return fe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setMainHighlightColorPicker(e){this.#P=e}editAltText(e,t=!1){this.#s?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#m=t;break}}onPageChanging({pageNumber:e}){this.#o=e-1}focusMainContainer(){this.#j.focus()}findParent(e,t){for(const i of this.#i.values()){const{x:r,y:s,width:a,height:o}=i.div.getBoundingClientRect();if(e>=r&&e<=r+a&&t>=s&&t<=s+o)return i}return null}disableUserSelect(e=!1){this.#H.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Dn.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#q({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#W(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of this.#i.values())if(i.hasTextLayer(e))return i;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a}=t,o=t.toString(),c=this.#q(t).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;t.empty();const h=this.#W(c),d=this.#A===oe.NONE,f=()=>{h?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a,text:o}),d&&this.showAllEditors("highlight",!0,!0)};if(d){this.switchToMode(oe.HIGHLIGHT,f);return}f()}#J(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=this.#q(e).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(this.#S||=new wv(this),this.#S.show(i,r,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#r&&!this.#r.has(e.id)&&this.#r.setValue(e.id,e)}#Z(){const e=document.getSelection();if(!e||e.isCollapsed){this.#D&&(this.#S?.hide(),this.#D=null,this.#I({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#D)return;const r=this.#q(e).closest(".textLayer");if(!r){this.#D&&(this.#S?.hide(),this.#D=null,this.#I({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#D=t,this.#I({hasSelectedText:!0}),!(this.#A!==oe.HIGHLIGHT&&this.#A!==oe.NONE)&&(this.#A===oe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#_=this.isShiftKeyDown,!this.isShiftKeyDown)){const s=this.#A===oe.HIGHLIGHT?this.#W(r):null;s?.toggleDrawing();const a=new AbortController,o=this.combinedSignal(a),l=c=>{c.type==="pointerup"&&c.button!==0||(a.abort(),s?.toggleDrawing(!0),c.type==="pointerup"&&this.#V("main_toolbar"))};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}}#V(e=""){this.#A===oe.HIGHLIGHT?this.highlightSelection(e):this.#f&&this.#J()}#ee(){document.addEventListener("selectionchange",this.#Z.bind(this),{signal:this._signal})}#te(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ne(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#V("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#x)if(t.div.contains(e)){this.#T=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#T)return;const[e,t]=this.#T;this.#T=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#G(){if(this.#k)return;this.#k=new AbortController;const e=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ie(){this.#k?.abort(),this.#k=null}#X(){if(this.#u)return;this.#u=new AbortController;const e=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#Y(){this.#u?.abort(),this.#u=null}#re(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#G(),this.#X()}removeEditListeners(){this.#ie(),this.#Y()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of this.#d)if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of this.#d)if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of this.#x){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const a of this.#d)if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){ce(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const s=[];for(const l of i){const c=await r.deserialize(l);if(!c)return;s.push(c)}const a=()=>{for(const l of s)this.#K(l);this.#Q(s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){ce(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==oe.NONE&&!this.isEditorHandlingKeyboard&&qt._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#V("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#I(e){Object.entries(e).some(([i,r])=>this.#U[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,e)}),this.#A===oe.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#B([[te.HIGHLIGHT_FREE,!0]]))}#B(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#te(),this.#X(),this.#I({isEditing:this.#A!==oe.NONE,isEmpty:this.#$(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#Y(),this.#I({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#d){this.#d=e;for(const t of this.#d)this.#B(t.defaultPropertiesToUpdate)}}getId(){return this.#F.id}get currentLayer(){return this.#i.get(this.#o)}getLayer(e){return this.#i.get(e)}get currentPageIndex(){return this.#o}addLayer(e){this.#i.set(e.pageIndex,e),this.#C?e.enable():e.disable()}removeLayer(e){this.#i.delete(e.pageIndex)}async updateMode(e,t=null,i=!1){if(this.#A!==e&&!(this.#R&&(await this.#R.promise,!this.#R))){if(this.#R=Promise.withResolvers(),this.#A=e,e===oe.NONE){this.setEditingState(!1),this.#ae(),this.#R.resolve();return}this.setEditingState(!0),await this.#se(),this.unselectAll();for(const r of this.#i.values())r.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),this.#R.resolve();return}for(const r of this.#n.values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#R.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#d){switch(e){case te.CREATE:this.currentLayer.addNewEditor();return;case te.HIGHLIGHT_DEFAULT_COLOR:this.#P?.updateColor(t);break;case te.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#O||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const i of this.#x)i.updateParams(e,t);for(const i of this.#d)i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){for(const s of this.#n.values())s.editorType===e&&s.show(t);(this.#O?.get(te.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#B([[te.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#v!==e){this.#v=e;for(const t of this.#i.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#se(){if(!this.#C){this.#C=!0;const e=[];for(const t of this.#i.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#ae(){if(this.unselectAll(),this.#C){this.#C=!1;for(const e of this.#i.values())e.disable();for(const e of this.#n.values())e.disable()}}getEditors(e){const t=[];for(const i of this.#n.values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.focusMainContainer(),this.#b=null},0)),this.#n.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#h.has(e.annotationElementId))&&this.#r?.remove(e.id)}addDeletedAnnotationElement(e){this.#h.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#h.has(e)}removeDeletedAnnotationElement(e){this.#h.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#K(e){const t=this.#i.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#B(e.propertiesToUpdate))}get#oe(){let e=null;for(e of this.#x);return e}updateUI(e){this.#oe===e&&this.#B(e.propertiesToUpdate)}toggleSelected(e){if(this.#x.has(e)){this.#x.delete(e),e.unselect(),this.#I({hasSelectedEditor:this.hasSelection});return}this.#x.add(e),e.select(),this.#B(e.propertiesToUpdate),this.#I({hasSelectedEditor:!0})}setSelected(e){for(const t of this.#x)t!==e&&t.unselect();this.#x.clear(),this.#x.add(e),e.select(),this.#B(e.propertiesToUpdate),this.#I({hasSelectedEditor:!0})}isSelected(e){return this.#x.has(e)}get firstSelectedEditor(){return this.#x.values().next().value}unselect(e){e.unselect(),this.#x.delete(e),this.#I({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#x.size!==0}get isEnterHandled(){return this.#x.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#I({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#$()})}redo(){this.#c.redo(),this.#I({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#$()})}addCommands(e){this.#c.add(e),this.#I({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#$()})}#$(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#x],t=()=>{for(const r of e)r.remove()},i=()=>{for(const r of e)this.#K(r)};this.addCommands({cmd:t,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#Q(e){for(const t of this.#x)t.unselect();this.#x.clear();for(const t of e)t.isEmpty()||(this.#x.add(t),t.select());this.#I({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#x)e.commit();this.#Q(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#A!==oe.NONE))&&this.hasSelection){for(const e of this.#x)e.unselect();this.#x.clear(),this.#I({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=e,this.#z[1]+=t;const[r,s]=this.#z,a=[...this.#x],o=1e3;this.#N&&clearTimeout(this.#N),this.#N=setTimeout(()=>{this.#N=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const l of a)this.#n.has(l.id)&&l.translateInPage(r,s)},undo:()=>{for(const l of a)this.#n.has(l.id)&&l.translateInPage(-r,-s)},mustExec:!1})},o);for(const l of a)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#a=new Map;for(const e of this.#x)this.#a.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#a)return!1;this.disableUserSelect(!1);const e=this.#a;this.#a=null;let t=!1;for(const[{x:r,y:s,pageIndex:a},o]of e)o.newX=r,o.newY=s,o.newPageIndex=a,t||=r!==o.savedX||s!==o.savedY||a!==o.savedPageIndex;if(!t)return!1;const i=(r,s,a,o)=>{if(this.#n.has(r.id)){const l=this.#i.get(o);l?r._setParentAndPosition(l,s,a):(r.pageIndex=o,r.x=s,r.y=a)}};return this.addCommands({cmd:()=>{for(const[r,{newX:s,newY:a,newPageIndex:o}]of e)i(r,s,a,o)},undo:()=>{for(const[r,{savedX:s,savedY:a,savedPageIndex:o}]of e)i(r,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#a)for(const i of this.#a.keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#x.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#A}get imageManager(){return fe(this,"imageManager",new na)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,u=t.rangeCount;c<u;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:r,width:s,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,u,h,d)=>({x:(u-r)/a,y:1-(c+h-i)/s,width:d/a,height:h/s});break;case"180":o=(c,u,h,d)=>({x:1-(c+h-i)/s,y:1-(u+d-r)/a,width:h/s,height:d/a});break;case"270":o=(c,u,h,d)=>({x:1-(u+d-r)/a,y:(c-i)/s,width:d/a,height:h/s});break;default:o=(c,u,h,d)=>({x:(c-i)/s,y:(u-r)/a,width:h/s,height:d/a});break}const l=[];for(let c=0,u=t.rangeCount;c<u;c++){const h=t.getRangeAt(c);if(!h.collapsed)for(const{x:d,y:f,width:g,height:m}of h.getClientRects())g===0||m===0||l.push(o(d,f,g,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#l||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#l?.delete(e)}renderAnnotationElement(e){const t=this.#l?.get(e.data.id);if(!t)return;const i=this.#r.getRawValue(t);i&&(this.#A===oe.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}}class vt{#e=null;#t=!1;#n=null;#i=null;#s=null;#r=null;#l=!1;#c=null;#u=null;#o=null;#h=null;#a=!1;static#d=null;static _l10n=null;constructor(e){this.#u=e,this.#a=e._uiManager.useNewAltTextFlow,vt.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){vt._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#i=document.createElement("span");e.append(t),this.#a?(e.classList.add("new"),e.setAttribute("data-l10n-id",vt.#d.missing),t.setAttribute("data-l10n-id",vt.#d["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#u._uiManager._signal;e.addEventListener("contextmenu",pt,{signal:i}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:i});const r=s=>{s.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#a&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(this.#l=!0,r(s))},{signal:i}),await this.#f(),e}get#p(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#a?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#a?this.#e!==null||!!this.#o:this.isEmpty()}get guessedText(){return this.#o}async setGuessedText(e){this.#e===null&&(this.#o=e,this.#h=await vt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#f())}toggleAltTextBadge(e=!1){if(!this.#a||this.#e){this.#c?.remove(),this.#c=null;return}if(!this.#c){const t=this.#c=document.createElement("div");t.className="noAltTextBadge",this.#u.div.append(t)}this.#c.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#o===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#o,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:r,cancel:s=!1}){i&&(this.#o=i,this.#h=r),!(this.#e===e&&this.#t===t)&&(s||(this.#e=e,this.#t=t),this.#f())}toggle(e=!1){this.#n&&(!e&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!e)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#s=null,this.#c?.remove(),this.#c=null}async#f(){const e=this.#n;if(!e)return;if(this.#a){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",vt.#d[this.#p]),this.#i?.setAttribute("data-l10n-id",vt.#d[`${this.#p}-label`]),!this.#e){this.#s?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#s?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#s;if(!t){this.#s=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#u.id}`;const r=100,s=this.#u._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:s}),e.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:s})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#u.getImageForAltText()?.setAttribute("aria-describedby",t.id)}}class ee{#e=null;#t=null;#n=null;#i=!1;#s=!1;#r=null;#l=null;#c=null;#u="";#o=!1;#h=null;#a=!1;#d=!1;#p=!1;#f=null;#y=0;#m=0;#g=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#b=!1;#w=ee._zIndex++;static _borderLineWidth=-1;static _colorManager=new ia;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=ee.prototype._resizeWithKeyboard,t=qt.TRANSLATE_SMALL,i=qt.TRANSLATE_BIG;return fe(this,"_resizerKeyboardManager",new fi([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],ee.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:r,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return fe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Sv({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ee._l10n??=e,ee._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ee._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);ee._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){ke("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#b}set _isDraggable(e){this.#b=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#w}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#O(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#o?this.#o=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,r){const[s,a]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(e+i)/s,this.y=(t+r)/a,this.fixAndSetPosition()}#E([e,t],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/e,this.y+=r/t,this.fixAndSetPosition()}translate(e,t){this.#E(this.parentDimensions,e,t)}translateInPage(e,t){this.#h||=[this.x,this.y],this.#E(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#h||=[this.x,this.y];const[i,r]=this.parentDimensions;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:u}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,u)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:a}=this;const[o,l]=this.getBaseTranslation();s+=o,a+=l,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#h&&(this.#h[0]!==this.x||this.#h[1]!==this.y)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=ee,r=i/e,s=i/t;switch(this.rotation){case 90:return[-r,s];case 180:return[r,s];case 270:return[r,-s];default:return[-r,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const[t,i]=this.pageDimensions;let{x:r,y:s,width:a,height:o}=this;if(a*=t,o*=i,r*=t,s*=i,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(t-a,r)),s=Math.max(0,Math.min(i-o,s));break;case 90:r=Math.max(0,Math.min(t-o,r)),s=Math.min(i,Math.max(a,s));break;case 180:r=Math.min(t,Math.max(a,r)),s=Math.min(i,Math.max(o,s));break;case 270:r=Math.min(t,Math.max(o,r)),s=Math.max(0,Math.min(i-a,s));break}this.x=r/=t,this.y=s/=i;const[l,c]=this.getBaseTranslation();r+=l,s+=c;const{style:u}=this.div;u.left=`${(100*r).toFixed(2)}%`,u.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#_(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return ee.#_(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return ee.#_(e,t,360-this.parentRotation)}#S(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,r]=this.parentDimensions;this.div.style.width=`${(100*e/i).toFixed(2)}%`,this.#s||(this.div.style.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,r=i.endsWith("%"),s=!this.#s&&t.endsWith("%");if(r&&s)return;const[a,o]=this.parentDimensions;r||(e.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!this.#s&&!s&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#F(){if(this.#r)return;this.#r=document.createElement("div"),this.#r.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const r=document.createElement("div");this.#r.append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",this.#C.bind(this,i),{signal:t}),r.addEventListener("contextmenu",pt,{signal:t}),r.tabIndex=-1}this.div.prepend(this.#r)}#C(e,t){t.preventDefault();const{isMac:i}=Qe.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1;const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#k.bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("contextmenu",pt,{signal:a});const o=this.x,l=this.y,c=this.width,u=this.height,h=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=h,this.div.style.cursor=d,this.#v(o,l,c,u)};window.addEventListener("pointerup",f,{signal:a}),window.addEventListener("blur",f,{signal:a})}#v(e,t,i,r){const s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===t&&o===i&&l===r||this.addCommands({cmd:()=>{this.width=o,this.height=l,this.x=s,this.y=a;const[c,u]=this.parentDimensions;this.setDims(c*o,u*l),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=r,this.x=e,this.y=t;const[c,u]=this.parentDimensions;this.setDims(c*i,u*r),this.fixAndSetPosition()},mustExec:!0})}#k(e,t){const[i,r]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,c=ee.MIN_SIZE/i,u=ee.MIN_SIZE/r,h=B=>Math.round(B*1e4)/1e4,d=this.#S(this.rotation),f=(B,q)=>[d[0]*B+d[2]*q,d[1]*B+d[3]*q],g=this.#S(360-this.rotation),m=(B,q)=>[g[0]*B+g[2]*q,g[1]*B+g[3]*q];let b,y,x=!1,A=!1;switch(e){case"topLeft":x=!0,b=(B,q)=>[0,0],y=(B,q)=>[B,q];break;case"topMiddle":b=(B,q)=>[B/2,0],y=(B,q)=>[B/2,q];break;case"topRight":x=!0,b=(B,q)=>[B,0],y=(B,q)=>[0,q];break;case"middleRight":A=!0,b=(B,q)=>[B,q/2],y=(B,q)=>[0,q/2];break;case"bottomRight":x=!0,b=(B,q)=>[B,q],y=(B,q)=>[0,0];break;case"bottomMiddle":b=(B,q)=>[B/2,q],y=(B,q)=>[B/2,0];break;case"bottomLeft":x=!0,b=(B,q)=>[0,q],y=(B,q)=>[B,0];break;case"middleLeft":A=!0,b=(B,q)=>[0,q/2],y=(B,q)=>[B,q/2];break}const k=b(o,l),E=y(o,l);let _=f(...E);const P=h(s+_[0]),D=h(a+_[1]);let O=1,S=1,[R,I]=this.screenToPageTranslation(t.movementX,t.movementY);if([R,I]=m(R/i,I/r),x){const B=Math.hypot(o,l);O=S=Math.max(Math.min(Math.hypot(E[0]-k[0]-R,E[1]-k[1]-I)/B,1/o,1/l),c/o,u/l)}else A?O=Math.max(c,Math.min(1,Math.abs(E[0]-k[0]-R)))/o:S=Math.max(u,Math.min(1,Math.abs(E[1]-k[1]-I)))/l;const F=h(o*O),M=h(l*S);_=f(...y(F,M));const N=P-_[0],V=D-_[1];this.width=F,this.height=M,this.x=N,this.y=V,this.setDims(i*F,r*M),this.fixAndSetPosition()}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#d?this._editToolbar:(this._editToolbar=new Zn(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(vt.initialize(ee._l10n),this.#n=new vt(this),this.#e&&(this.#n.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#L();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),Vi(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:t}=Qe.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#o=!0,this._isDraggable){this.#P(e);return}this.#T(e)}get isSelected(){return this._uiManager.isSelected(this)}#T(e){const{isMac:t}=Qe.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#P(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();const i=new AbortController,r=this._uiManager.combinedSignal(i);if(t){this.div.classList.add("moving"),this.#y=e.clientX,this.#m=e.clientY;const a=o=>{const{clientX:l,clientY:c}=o,[u,h]=this.screenToPageTranslation(l-this.#y,c-this.#m);this.#y=l,this.#m=c,this._uiManager.dragSelectedEditors(u,h)};window.addEventListener("pointermove",a,{passive:!0,capture:!0,signal:r})}const s=()=>{i.abort(),t&&this.div.classList.remove("moving"),this.#o=!1,this._uiManager.endDragSession()||this.#T(e)};window.addEventListener("pointerup",s,{signal:r}),window.addEventListener("blur",s,{signal:r})}moveInDOM(){this.#f&&clearTimeout(this.#f),this.#f=setTimeout(()=>{this.#f=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition()}getRect(e,t,i=this.rotation){const r=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/r,u=t/r,h=this.x*s,d=this.y*a,f=this.width*s,g=this.height*a;switch(i){case 0:return[h+c+o,a-d-u-g+l,h+c+f+o,a-d-u+l];case 90:return[h+u+o,a-d+c+l,h+u+g+o,a-d+c+f+l];case 180:return[h-c-f+o,a-d+u+l,h-c+o,a-d+u+g+l];case 270:return[h-u-g+o,a-d-c-f+l,h-u+o,a-d-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,r,s,a]=e,o=s-i,l=a-r;switch(this.rotation){case 0:return[i,t-a,o,l];case 90:return[i,t-r,l,o];case 180:return[s,t-r,o,l];case 270:return[s,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#d=!0}disableEditMode(){this.#d=!1}isInEditMode(){return this.#d}shouldGetKeyboardEvents(){return this.#p}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}#L(){if(this.#c||!this.div)return;this.#c=new AbortController;const e=this._uiManager.combinedSignal(this.#c);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#L()}rotate(e){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){ke("An editor must be serializable")}static async deserialize(e,t,i){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});r.rotation=e.rotation,r.#e=e.accessibilityData;const[s,a]=r.pageDimensions,[o,l,c,u]=r.getRectInCurrentCoords(e.rect,a);return r.x=o/s,r.y=l/a,r.width=c/s,r.height=u/a,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#c?.abort(),this.#c=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#f&&(clearTimeout(this.#f),this.#f=null),this.#O(),this.removeEditToolbar(),this.#g){for(const e of this.#g.values())clearTimeout(e);this.#g=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#F(),this.#r.classList.remove("hidden"),Vi(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#r.children;if(!this.#t){this.#t=Array.from(t);const a=this.#A.bind(this),o=this.#x.bind(this),l=this._uiManager._signal;for(const c of this.#t){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",this.#D.bind(this,u),{signal:l}),c.setAttribute("data-l10n-id",ee._l10nResizer[u])}}const i=this.#t[0];let r=0;for(const a of t){if(a===i)break;r++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(s!==r){if(s<r)for(let o=0;o<r-s;o++)this.#r.append(this.#r.firstChild);else if(s>r)for(let o=0;o<s-r;o++)this.#r.firstChild.before(this.#r.lastChild);let a=0;for(const o of t){const c=this.#t[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",ee._l10nResizer[c])}}this.#M(0),this.#p=!0,this.#r.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#A(e){ee._resizerKeyboardManager.exec(this,e)}#x(e){this.#p&&e.relatedTarget?.parentNode!==this.#r&&this.#O()}#D(e){this.#u=this.#p?e:""}#M(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#p&&this.#k(this.#u,{movementX:e,movementY:t})}#O(){if(this.#p=!1,this.#M(-1),this.#l){const{savedX:e,savedY:t,savedWidth:i,savedHeight:r}=this.#l;this.#v(e,t,i,r),this.#l=null}}_stopResizingWithKeyboard(){this.#O(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#r?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#a}set isEditing(e){this.#a=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#s=!0;const i=e/t,{style:r}=this.div;r.aspectRatio=i,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#g||=new Map;const{action:i}=e;let r=this.#g.get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),this.#g.delete(i),this.#g.size===0&&(this.#g=null)},ee._telemetryTimeout),this.#g.set(i,r);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class Sv extends ee{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const nl=3285377520,ut=4294901760,xt=65535;class ou{constructor(e){this.h1=e?e&4294967295:nl,this.h2=e?e&4294967295:nl}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let m=0,b=e.length;m<b;m++){const y=e.charCodeAt(m);y<=255?t[i++]=y:(t[i++]=y>>>8,t[i++]=y&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,s=i-r*4,a=new Uint32Array(t.buffer,0,r);let o=0,l=0,c=this.h1,u=this.h2;const h=3432918353,d=461845907,f=h&xt,g=d&xt;for(let m=0;m<r;m++)m&1?(o=a[m],o=o*h&ut|o*f&xt,o=o<<15|o>>>17,o=o*d&ut|o*g&xt,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[m],l=l*h&ut|l*f&xt,l=l<<15|l>>>17,l=l*d&ut|l*g&xt,u^=l,u=u<<13|u>>>19,u=u*5+3864292196);switch(o=0,s){case 3:o^=t[r*4+2]<<16;case 2:o^=t[r*4+1]<<8;case 1:o^=t[r*4],o=o*h&ut|o*f&xt,o=o<<15|o>>>17,o=o*d&ut|o*g&xt,r&1?c^=o:u^=o}this.h1=c,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ut|e*36045&xt,t=t*4283543511&ut|((t<<16|e>>>16)*2950163797&ut)>>>16,e^=t>>>1,e=e*444984403&ut|e*60499&xt,t=t*3301882366&ut|((t<<16|e>>>16)*3120437893&ut)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const xs=Object.freeze({map:null,hash:"",transfer:void 0});class ra{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=this.#n.get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#n.values())if(t instanceof ee)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=this.#n.get(e);let r=!1;if(i!==void 0)for(const[s,a]of Object.entries(t))i[s]!==a&&(r=!0,i[s]=a);else r=!0,this.#n.set(e,t);r&&this.#i(),t instanceof ee&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?Qs(this.#n):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return this.#n.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new lu(this)}get serializable(){if(this.#n.size===0)return xs;const e=new Map,t=new ou,i=[],r=Object.create(null);let s=!1;for(const[a,o]of this.#n){const l=o instanceof ee?o.serialize(!1,r):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),s||=!!l.bitmap)}if(s)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:xs}get editorStats(){let e=null;const t=new Map;for(const i of this.#n.values()){if(!(i instanceof ee))continue;const r=i.telemetryFinalData;if(!r)continue;const{type:s}=r;t.has(s)||t.set(s,Object.getPrototypeOf(i).constructor),e||=Object.create(null);const a=e[s]||=new Map;for(const[o,l]of Object.entries(r)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const u=c.get(l)??0;c.set(l,u+1)}}for(const[i,r]of t)e[i]=r.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#n.values())!(t instanceof ee)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}}class lu extends ra{#e;constructor(e){super();const{map:t,hash:i,transfer:r}=e.serializable,s=structuredClone(t,r?{transfer:r}:null);this.#e={map:s,hash:i,transfer:r}}get print(){ke("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return fe(this,"modifiedIds",{ids:new Set,hash:""})}}class kv{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(Ne(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:s}=e,a=new FontFace(i,r,s);this.addNativeFontFace(a);try{await a.load(),this.#e.add(i),t?.(e)}catch{ce(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}ke("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw ce(`Failed to load font '${i.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return fe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(We||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),fe(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Ne(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:t,callback:e};return i.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return fe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(k,E){return k.charCodeAt(E)<<24|k.charCodeAt(E+1)<<16|k.charCodeAt(E+2)<<8|k.charCodeAt(E+3)&255}function r(k,E,_,P){const D=k.substring(0,E),O=k.substring(E+_);return D+P+O}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function u(k,E){if(++c>30){ce("Load test font never loaded."),E();return}if(l.font="30px "+k,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){E();return}setTimeout(u.bind(null,k,E))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=r(d,976,h.length,h);const g=16,m=1482184792;let b=i(d,g);for(s=0,a=h.length-3;s<a;s+=4)b=b-m+i(h,s)|0;s<h.length&&(b=b-m+i(h+"XXX",s)|0),d=r(d,g,4,cv(b));const y=`url(data:font/opentype;base64,${btoa(d)});`,x=`@font-face {font-family:"${h}";src:${y}}`;this.insertRule(x);const A=this._document.createElement("div");A.style.visibility="hidden",A.style.width=A.style.height="10px",A.style.position="absolute",A.style.top=A.style.left="0px";for(const k of[e.loadedName,h]){const E=this._document.createElement("span");E.textContent="Hi",E.style.fontFamily=k,A.append(E)}this._document.body.append(A),u(h,()=>{A.remove(),t.complete()})}}class Ev{constructor(e,{disableFontFace:t=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${gv(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let i;try{i=e.get(this.loadedName+"_path_"+t)}catch(s){ce(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(i)||i.length===0)return this.compiledGlyphs[t]=function(s,a){};const r=[];for(let s=0,a=i.length;s<a;)switch(i[s++]){case Tt.BEZIER_CURVE_TO:{const[o,l,c,u,h,d]=i.slice(s,s+6);r.push(f=>f.bezierCurveTo(o,l,c,u,h,d)),s+=6}break;case Tt.MOVE_TO:{const[o,l]=i.slice(s,s+2);r.push(c=>c.moveTo(o,l)),s+=2}break;case Tt.LINE_TO:{const[o,l]=i.slice(s,s+2);r.push(c=>c.lineTo(o,l)),s+=2}break;case Tt.QUADRATIC_CURVE_TO:{const[o,l,c,u]=i.slice(s,s+4);r.push(h=>h.quadraticCurveTo(o,l,c,u)),s+=4}break;case Tt.RESTORE:r.push(o=>o.restore());break;case Tt.SAVE:r.push(o=>o.save());break;case Tt.SCALE:Ne(r.length===2,"Scale command is only valid at the third position.");break;case Tt.TRANSFORM:{const[o,l,c,u,h,d]=i.slice(s,s+6);r.push(f=>f.transform(o,l,c,u,h,d)),s+=6}break;case Tt.TRANSLATE:{const[o,l]=i.slice(s,s+2);r.push(c=>c.translate(o,l)),s+=2}break}return this.compiledGlyphs[t]=function(a,o){r[0](a),r[1](a),a.scale(o,-o);for(let l=2,c=r.length;l<c;l++)r[l](a)}}}class cu{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){ke("Abstract method `_createCanvas` called.")}}class Cv extends cu{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class uu{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){ke("Abstract method `_fetch` called.")}}class hu extends uu{async _fetch(e){const t=await ir(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):nr(t)}}class du{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,r,s){return"none"}destroy(e=!1){}}class Tv extends du{#e;#t;#n;#i;#s;#r;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#i=e,this.#s=t}get#c(){return this.#t||=new Map}get#u(){return this.#r||=new Map}get#o(){if(!this.#n){const e=this.#s.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const i=this.#s.createElementNS(It,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#n=this.#s.createElementNS(It,"defs"),e.append(i),i.append(this.#n),this.#s.body.append(e)}return this.#n}#h(e){if(e.length===1){const l=e[0],c=new Array(256);for(let h=0;h<256;h++)c[h]=l[h]/255;const u=c.join(",");return[u,u,u]}const[t,i,r]=e,s=new Array(256),a=new Array(256),o=new Array(256);for(let l=0;l<256;l++)s[l]=t[l]/255,a[l]=i[l]/255,o[l]=r[l]/255;return[s.join(","),a.join(","),o.join(",")]}#a(e){if(this.#e===void 0){this.#e="";const t=this.#s.URL;t!==this.#s.baseURI&&(rr(t)?ce('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#c.get(e);if(t)return t;const[i,r,s]=this.#h(e),a=e.length===1?i:`${i}${r}${s}`;if(t=this.#c.get(a),t)return this.#c.set(e,t),t;const o=`g_${this.#i}_transfer_map_${this.#l++}`,l=this.#a(o);this.#c.set(e,l),this.#c.set(a,l);const c=this.#f(o);return this.#m(i,r,s,c),l}addHCMFilter(e,t){const i=`${e}-${t}`,r="base";let s=this.#u.get(r);if(s?.key===i||(s?(s.filter?.remove(),s.key=i,s.url="none",s.filter=null):(s={key:i,url:"none",filter:null},this.#u.set(r,s)),!e||!t))return s.url;const a=this.#b(e);e=K.makeHexColor(...a);const o=this.#b(t);if(t=K.makeHexColor(...o),this.#o.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return s.url;const l=new Array(256);for(let f=0;f<=255;f++){const g=f/255;l[f]=g<=.03928?g/12.92:((g+.055)/1.055)**2.4}const c=l.join(","),u=`g_${this.#i}_hcm_filter`,h=s.filter=this.#f(u);this.#m(c,c,c,h),this.#p(h);const d=(f,g)=>{const m=a[f]/255,b=o[f]/255,y=new Array(g+1);for(let x=0;x<=g;x++)y[x]=m+x/g*(b-m);return y.join(",")};return this.#m(d(0,5),d(1,5),d(2,5),h),s.url=this.#a(u),s.url}addAlphaFilter(e){let t=this.#c.get(e);if(t)return t;const[i]=this.#h([e]),r=`alpha_${i}`;if(t=this.#c.get(r),t)return this.#c.set(e,t),t;const s=`g_${this.#i}_alpha_map_${this.#l++}`,a=this.#a(s);this.#c.set(e,a),this.#c.set(r,a);const o=this.#f(s);return this.#g(i,o),a}addLuminosityFilter(e){let t=this.#c.get(e||"luminosity");if(t)return t;let i,r;if(e?([i]=this.#h([e]),r=`luminosity_${i}`):r="luminosity",t=this.#c.get(r),t)return this.#c.set(e,t),t;const s=`g_${this.#i}_luminosity_map_${this.#l++}`,a=this.#a(s);this.#c.set(e,a),this.#c.set(r,a);const o=this.#f(s);return this.#d(o),e&&this.#g(i,o),a}addHighlightHCMFilter(e,t,i,r,s){const a=`${t}-${i}-${r}-${s}`;let o=this.#u.get(e);if(o?.key===a||(o?(o.filter?.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},this.#u.set(e,o)),!t||!i))return o.url;const[l,c]=[t,i].map(this.#b.bind(this));let u=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[d,f]=[r,s].map(this.#b.bind(this));h<u&&([u,h,d,f]=[h,u,f,d]),this.#o.style.color="";const g=(y,x,A)=>{const k=new Array(256),E=(h-u)/A,_=y/255,P=(x-y)/(255*A);let D=0;for(let O=0;O<=A;O++){const S=Math.round(u+O*E),R=_+O*P;for(let I=D;I<=S;I++)k[I]=R;D=S+1}for(let O=D;O<256;O++)k[O]=k[D-1];return k.join(",")},m=`g_${this.#i}_hcm_${e}_filter`,b=o.filter=this.#f(m);return this.#p(b),this.#m(g(d[0],f[0],5),g(d[1],f[1],5),g(d[2],f[2],5),b),o.url=this.#a(m),o.url}destroy(e=!1){e&&this.#u.size!==0||(this.#n&&(this.#n.parentNode.parentNode.remove(),this.#n=null),this.#t&&(this.#t.clear(),this.#t=null),this.#l=0)}#d(e){const t=this.#s.createElementNS(It,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){const t=this.#s.createElementNS(It,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#f(e){const t=this.#s.createElementNS(It,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#o.append(t),t}#y(e,t,i){const r=this.#s.createElementNS(It,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),e.append(r)}#m(e,t,i,r){const s=this.#s.createElementNS(It,"feComponentTransfer");r.append(s),this.#y(s,"feFuncR",e),this.#y(s,"feFuncG",t),this.#y(s,"feFuncB",i)}#g(e,t){const i=this.#s.createElementNS(It,"feComponentTransfer");t.append(i),this.#y(i,"feFuncA",e)}#b(e){return this.#o.style.color=e,ta(getComputedStyle(this.#o).getPropertyValue("color"))}}class fu{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){ke("Abstract method `_fetch` called.")}}class pu extends fu{async _fetch(e){const t=await ir(e,"arraybuffer");return new Uint8Array(t)}}if(We){var ws=Promise.withResolvers(),vs=null;(async()=>{const e=await _i(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),t=await _i(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),i=await _i(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),r=await _i(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);let s,a;return new Map(Object.entries({fs:e,http:t,https:i,url:r,canvas:s,path2d:a}))})().then(e=>{vs=e,ws.resolve()},e=>{ce(`loadPackages: ${e}`),vs=new Map,ws.resolve()})}class Vt{static get promise(){return ws.promise}static get(e){return vs?.get(e)}}async function gu(n){const t=await Vt.get("fs").promises.readFile(n);return new Uint8Array(t)}class Pv extends du{}class Rv extends cu{_createCanvas(e,t){return Vt.get("canvas").createCanvas(e,t)}}class Iv extends uu{async _fetch(e){return gu(e)}}class Lv extends fu{async _fetch(e){return gu(e)}}const Ye={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function As(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,i),n.clip(r)}class sa{getPattern(){ke("Abstract method `getPattern` called.")}}class Dv extends sa{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,r){let s;if(r===Ye.STROKE||r===Ye.FILL){const a=t.current.getClippedPathBoundingBox(r,Ce(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-a[0],-a[1]),i=K.transform(i,[1,0,0,1,a[0],a[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),As(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),s=e.createPattern(c.canvas,"no-repeat");const h=new DOMMatrix(i);s.setTransform(h)}else As(e,this._bbox),s=this._createGradient(e);return s}}function Or(n,e,t,i,r,s,a,o){const l=e.coords,c=e.colors,u=n.data,h=n.width*4;let d;l[t+1]>l[i+1]&&(d=t,t=i,i=d,d=s,s=a,a=d),l[i+1]>l[r+1]&&(d=i,i=r,r=d,d=a,a=o,o=d),l[t+1]>l[i+1]&&(d=t,t=i,i=d,d=s,s=a,a=d);const f=(l[t]+e.offsetX)*e.scaleX,g=(l[t+1]+e.offsetY)*e.scaleY,m=(l[i]+e.offsetX)*e.scaleX,b=(l[i+1]+e.offsetY)*e.scaleY,y=(l[r]+e.offsetX)*e.scaleX,x=(l[r+1]+e.offsetY)*e.scaleY;if(g>=x)return;const A=c[s],k=c[s+1],E=c[s+2],_=c[a],P=c[a+1],D=c[a+2],O=c[o],S=c[o+1],R=c[o+2],I=Math.round(g),F=Math.round(x);let M,N,V,B,q,U,v,G;for(let X=I;X<=F;X++){if(X<b){const Y=X<g?0:(g-X)/(g-b);M=f-(f-m)*Y,N=A-(A-_)*Y,V=k-(k-P)*Y,B=E-(E-D)*Y}else{let Y;X>x?Y=1:b===x?Y=0:Y=(b-X)/(b-x),M=m-(m-y)*Y,N=_-(_-O)*Y,V=P-(P-S)*Y,B=D-(D-R)*Y}let w;X<g?w=0:X>x?w=1:w=(g-X)/(g-x),q=f-(f-y)*w,U=A-(A-O)*w,v=k-(k-S)*w,G=E-(E-R)*w;const ne=Math.round(Math.min(M,q)),$=Math.round(Math.max(M,q));let Q=h*X+ne*4;for(let Y=ne;Y<=$;Y++)w=(M-Y)/(M-q),w<0?w=0:w>1&&(w=1),u[Q++]=N-(N-U)*w|0,u[Q++]=V-(V-v)*w|0,u[Q++]=B-(B-G)*w|0,u[Q++]=255}}function Mv(n,e,t){const i=e.coords,r=e.colors;let s,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(s=0;s<l;s++){let u=s*o;for(let h=0;h<c;h++,u++)Or(n,t,i[u],i[u+1],i[u+o],r[u],r[u+1],r[u+o]),Or(n,t,i[u+o+1],i[u+1],i[u+o],r[u+o+1],r[u+1],r[u+o])}break;case"triangles":for(s=0,a=i.length;s<a;s+=3)Or(n,t,i[s],i[s+1],i[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class Fv extends sa{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,u=Math.ceil(this._bounds[3])-l,h=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),f=c/h,g=u/d,m={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/g},b=h+2*2,y=d+2*2,x=i.getCanvas("mesh",b,y),A=x.context,k=A.createImageData(h,d);if(t){const _=k.data;for(let P=0,D=_.length;P<D;P+=4)_[P]=t[0],_[P+1]=t[1],_[P+2]=t[2],_[P+3]=255}for(const _ of this._figures)Mv(k,_,m);return A.putImageData(k,2,2),{canvas:x.canvas,offsetX:o-2*f,offsetY:l-2*g,scaleX:f,scaleY:g}}getPattern(e,t,i,r){As(e,this._bbox);let s;if(r===Ye.SHADING)s=K.singularValueDecompose2dScale(Ce(e));else if(s=K.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=K.singularValueDecompose2dScale(this.matrix);s=[s[0]*o[0],s[1]*o[1]]}const a=this._createMeshCanvas(s,r===Ye.SHADING?null:this._background,t.cachedCanvases);return r!==Ye.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class Ov extends sa{getPattern(){return"hotpink"}}function Nv(n){switch(n[0]){case"RadialAxial":return new Dv(n);case"Mesh":return new Fv(n);case"Dummy":return new Ov}throw new Error(`Unknown IR type: ${n[0]}`)}const il={COLORED:1,UNCOLORED:2};class aa{static MAX_PATTERN_SIZE=3e3;constructor(e,t,i,r,s){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=r,this.baseTransform=s}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:r,tilingType:s,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),er("TilingType: "+s);const u=t[0],h=t[1],d=t[2],f=t[3],g=d-u,m=f-h,b=K.singularValueDecompose2dScale(this.matrix),y=K.singularValueDecompose2dScale(this.baseTransform),x=b[0]*y[0],A=b[1]*y[1];let k=g,E=m,_=!1,P=!1;const D=Math.ceil(l*x),O=Math.ceil(c*A),S=Math.ceil(g*x),R=Math.ceil(m*A);D>=S?k=l:_=!0,O>=R?E=c:P=!0;const I=this.getSizeAndScale(k,this.ctx.canvas.width,x),F=this.getSizeAndScale(E,this.ctx.canvas.height,A),M=e.cachedCanvases.getCanvas("pattern",I.size,F.size),N=M.context,V=o.createCanvasGraphics(N);if(V.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(V,r,a),N.translate(-I.scale*u,-F.scale*h),V.transform(I.scale,0,0,F.scale,0,0),N.save(),this.clipBbox(V,u,h,d,f),V.baseTransform=Ce(V.ctx),V.executeOperatorList(i),V.endDrawing(),N.restore(),_||P){const B=M.canvas;_&&(k=l),P&&(E=c);const q=this.getSizeAndScale(k,this.ctx.canvas.width,x),U=this.getSizeAndScale(E,this.ctx.canvas.height,A),v=q.size,G=U.size,X=e.cachedCanvases.getCanvas("pattern-workaround",v,G),w=X.context,ne=_?Math.floor(g/l):0,$=P?Math.floor(m/c):0;for(let Q=0;Q<=ne;Q++)for(let Y=0;Y<=$;Y++)w.drawImage(B,v*Q,G*Y,v,G,0,0,v,G);return{canvas:X.canvas,scaleX:q.scale,scaleY:U.scale,offsetX:u,offsetY:h}}return{canvas:M.canvas,scaleX:I.scale,scaleY:F.scale,offsetX:u,offsetY:h}}getSizeAndScale(e,t,i){const r=Math.max(aa.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*i);return s>=r?s=r:i=s/e,{scale:i,size:s}}clipBbox(e,t,i,r,s){const a=r-t,o=s-i;e.ctx.rect(t,i,a,o),e.current.updateRectMinMax(Ce(e.ctx),[t,i,r,s]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const r=e.ctx,s=e.current;switch(t){case il.COLORED:const a=this.ctx;r.fillStyle=a.fillStyle,r.strokeStyle=a.strokeStyle,s.fillColor=a.fillStyle,s.strokeColor=a.strokeStyle;break;case il.UNCOLORED:const o=K.makeHexColor(i[0],i[1],i[2]);r.fillStyle=o,r.strokeStyle=o,s.fillColor=o,s.strokeColor=o;break;default:throw new lv(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,r){let s=i;r!==Ye.SHADING&&(s=K.transform(s,t.baseTransform),this.matrix&&(s=K.transform(s,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(s);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}}function jv({src:n,srcPos:e=0,dest:t,width:i,height:r,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=Qe.isLittleEndian?4278190080:255,[l,c]=a?[s,o]:[o,s],u=i>>3,h=i&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let g=0;g<r;g++){for(const b=e+u;e<b;e++){const y=e<d?n[e]:255;t[f++]=y&128?c:l,t[f++]=y&64?c:l,t[f++]=y&32?c:l,t[f++]=y&16?c:l,t[f++]=y&8?c:l,t[f++]=y&4?c:l,t[f++]=y&2?c:l,t[f++]=y&1?c:l}if(h===0)continue;const m=e<d?n[e++]:255;for(let b=0;b<h;b++)t[f++]=m&1<<7-b?c:l}return{srcPos:e,destPos:f}}const rl=16,sl=100,zv=15,al=10,ol=1e3,nt=16;function Bv(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(i,r){e.translate(i,r),this.__originalTranslate(i,r)},n.scale=function(i,r){e.scale(i,r),this.__originalScale(i,r)},n.transform=function(i,r,s,a,o,l){e.transform(i,r,s,a,o,l),this.__originalTransform(i,r,s,a,o,l)},n.setTransform=function(i,r,s,a,o,l){e.setTransform(i,r,s,a,o,l),this.__originalSetTransform(i,r,s,a,o,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){e.rotate(i),this.__originalRotate(i)},n.clip=function(i){e.clip(i),this.__originalClip(i)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,r,s,a,o){e.bezierCurveTo(t,i,r,s,a,o),this.__originalBezierCurveTo(t,i,r,s,a,o)},n.rect=function(t,i,r,s){e.rect(t,i,r,s),this.__originalRect(t,i,r,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Hv{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,i)):(r=this.canvasFactory.create(t,i),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Si(n,e,t,i,r,s,a,o,l,c){const[u,h,d,f,g,m]=Ce(n);if(h===0&&d===0){const x=a*u+g,A=Math.round(x),k=o*f+m,E=Math.round(k),_=(a+l)*u+g,P=Math.abs(Math.round(_)-A)||1,D=(o+c)*f+m,O=Math.abs(Math.round(D)-E)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(f),A,E),n.drawImage(e,t,i,r,s,0,0,P,O),n.setTransform(u,h,d,f,g,m),[P,O]}if(u===0&&f===0){const x=o*d+g,A=Math.round(x),k=a*h+m,E=Math.round(k),_=(o+c)*d+g,P=Math.abs(Math.round(_)-A)||1,D=(a+l)*h+m,O=Math.abs(Math.round(D)-E)||1;return n.setTransform(0,Math.sign(h),Math.sign(d),0,A,E),n.drawImage(e,t,i,r,s,0,0,O,P),n.setTransform(u,h,d,f,g,m),[O,P]}n.drawImage(e,t,i,r,s,a,o,l,c);const b=Math.hypot(u,h),y=Math.hypot(d,f);return[b*l,y*c]}function Uv(n){const{width:e,height:t}=n;if(e>ol||t>ol)return null;const i=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=e+1;let a=new Uint8Array(s*(t+1)),o,l,c;const u=e+7&-8;let h=new Uint8Array(u*t),d=0;for(const y of n.data){let x=128;for(;x>0;)h[d++]=y&x?0:255,x>>=1}let f=0;for(d=0,h[d]!==0&&(a[0]=1,++f),l=1;l<e;l++)h[d]!==h[d+1]&&(a[l]=h[d]?2:1,++f),d++;for(h[d]!==0&&(a[l]=2,++f),o=1;o<t;o++){d=o*u,c=o*s,h[d-u]!==h[d]&&(a[c]=h[d]?1:8,++f);let y=(h[d]?4:0)+(h[d-u]?8:0);for(l=1;l<e;l++)y=(y>>2)+(h[d+1]?4:0)+(h[d-u+1]?8:0),r[y]&&(a[c+l]=r[y],++f),d++;if(h[d-u]!==h[d]&&(a[c+l]=h[d]?2:4,++f),f>i)return null}for(d=u*(t-1),c=o*s,h[d]!==0&&(a[c]=8,++f),l=1;l<e;l++)h[d]!==h[d+1]&&(a[c+l]=h[d]?4:8,++f),d++;if(h[d]!==0&&(a[c+l]=4,++f),f>i)return null;const g=new Int32Array([0,s,-1,0,-s,0,0,0,1]),m=new Path2D;for(o=0;f&&o<=t;o++){let y=o*s;const x=y+e;for(;y<x&&!a[y];)y++;if(y===x)continue;m.moveTo(y%s,o);const A=y;let k=a[y];do{const E=g[k];do y+=E;while(!a[y]);const _=a[y];_!==5&&_!==10?(k=_,a[y]=0):(k=_&51*k>>4,a[y]&=k>>2|k<<2),m.lineTo(y%s,y/s|0),a[y]||--f}while(A!==y);--o}return h=null,a=null,function(y){y.save(),y.scale(1/e,-1/t),y.translate(0,-t),y.fill(m),y.beginPath(),y.restore()}}class ll{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=iu,this.textMatrixScale=1,this.fontMatrix=gs,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ue.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=K.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=K.applyTransform(t,e),r=K.applyTransform(t.slice(2),e),s=K.applyTransform([t[0],t[3]],e),a=K.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],r[0],s[0],a[0]),this.minY=Math.min(this.minY,i[1],r[1],s[1],a[1]),this.maxX=Math.max(this.maxX,i[0],r[0],s[0],a[0]),this.maxY=Math.max(this.maxY,i[1],r[1],s[1],a[1])}updateScalingPathMinMax(e,t){K.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,r,s,a,o,l,c,u){const h=K.bezierBoundingBox(t,i,r,s,a,o,l,c,u);u||this.updateRectMinMax(e,h)}getPathBoundingBox(e=Ye.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===Ye.STROKE){t||ke("Stroke bounding box must include transform.");const r=K.singularValueDecompose2dScale(t),s=r[0]*this.lineWidth/2,a=r[1]*this.lineWidth/2;i[0]-=s,i[1]-=a,i[2]+=s,i[3]+=a}return i}updateClipFromPath(){const e=K.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Ye.FILL,t=null){return K.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function cl(n,e){if(typeof ImageData<"u"&&e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,r=t%nt,s=(t-r)/nt,a=r===0?s:s+1,o=n.createImageData(i,nt);let l=0,c;const u=e.data,h=o.data;let d,f,g,m;if(e.kind===Ri.GRAYSCALE_1BPP){const b=u.byteLength,y=new Uint32Array(h.buffer,0,h.byteLength>>2),x=y.length,A=i+7>>3,k=4294967295,E=Qe.isLittleEndian?4278190080:255;for(d=0;d<a;d++){for(g=d<s?nt:r,c=0,f=0;f<g;f++){const _=b-l;let P=0;const D=_>A?i:_*8-7,O=D&-8;let S=0,R=0;for(;P<O;P+=8)R=u[l++],y[c++]=R&128?k:E,y[c++]=R&64?k:E,y[c++]=R&32?k:E,y[c++]=R&16?k:E,y[c++]=R&8?k:E,y[c++]=R&4?k:E,y[c++]=R&2?k:E,y[c++]=R&1?k:E;for(;P<D;P++)S===0&&(R=u[l++],S=128),y[c++]=R&S?k:E,S>>=1}for(;c<x;)y[c++]=0;n.putImageData(o,0,d*nt)}}else if(e.kind===Ri.RGBA_32BPP){for(f=0,m=i*nt*4,d=0;d<s;d++)h.set(u.subarray(l,l+m)),l+=m,n.putImageData(o,0,f),f+=nt;d<a&&(m=i*r*4,h.set(u.subarray(l,l+m)),n.putImageData(o,0,f))}else if(e.kind===Ri.RGB_24BPP)for(g=nt,m=i*g,d=0;d<a;d++){for(d>=s&&(g=r,m=i*g),c=0,f=m;f--;)h[c++]=u[l++],h[c++]=u[l++],h[c++]=u[l++],h[c++]=255;n.putImageData(o,0,d*nt)}else throw new Error(`bad image kind: ${e.kind}`)}function ul(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,r=t%nt,s=(t-r)/nt,a=r===0?s:s+1,o=n.createImageData(i,nt);let l=0;const c=e.data,u=o.data;for(let h=0;h<a;h++){const d=h<s?nt:r;({srcPos:l}=jv({src:c,srcPos:l,dest:u,width:i,height:d,nonBlackColor:0})),n.putImageData(o,0,h*nt)}}function Vn(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function ki(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!We){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function hl(n,e){if(e)return!0;const t=K.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*Dn.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const $v=["butt","round","square"],qv=["miter","round","bevel"],Vv={},dl={};class Pn{constructor(e,t,i,r,s,{optionalContentConfig:a,markedContentStack:o=null},l,c){this.ctx=e,this.current=new ll(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=r,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new Hv(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:r=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Ce(this.compositeCtx))}this.ctx.save(),ki(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ce(this.ctx)}executeOperatorList(e,t,i,r){const s=e.argsArray,a=e.fnArray;let o=t||0;const l=s.length;if(l===o)return o;const c=l-o>al&&typeof i=="function",u=c?Date.now()+zv:0;let h=0;const d=this.commonObjs,f=this.objs;let g;for(;;){if(r!==void 0&&o===r.nextBreakPoint)return r.breakIt(o,i),o;if(g=a[o],g!==mt.dependency)this[g].apply(this,s[o]);else for(const m of s[o]){const b=m.startsWith("g_")?d:f;if(!b.has(m))return b.get(m,i),o}if(o++,o===l)return o;if(c&&++h>al){if(Date.now()>u)return i(),o;h=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const i=e.width??e.displayWidth,r=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,l=r,c="prescale1",u,h;for(;s>2&&o>1||a>2&&l>1;){let d=o,f=l;s>2&&o>1&&(d=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/d),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),u=this.cachedCanvases.getCanvas(c,d,f),h=u.context,h.clearRect(0,0,d,f),h.drawImage(e,0,0,o,l,0,0,d,f),e=u.canvas,o=d,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:r}=e,s=this.current.fillColor,a=this.current.patternFill,o=Ce(t);let l,c,u,h;if((e.bitmap||e.data)&&e.count>1){const D=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),s]),l=this._cachedBitmapsMap.get(D),l||(l=new Map,this._cachedBitmapsMap.set(D,l));const O=l.get(c);if(O&&!a){const S=Math.round(Math.min(o[0],o[2])+o[4]),R=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:O,offsetX:S,offsetY:R}}u=O}u||(h=this.cachedCanvases.getCanvas("maskCanvas",i,r),ul(h.context,e));let d=K.transform(o,[1/i,0,0,-1/r,0,0]);d=K.transform(d,[1,0,0,1,0,-r]);const[f,g,m,b]=K.getAxialAlignedBoundingBox([0,0,i,r],d),y=Math.round(m-f)||1,x=Math.round(b-g)||1,A=this.cachedCanvases.getCanvas("fillCanvas",y,x),k=A.context,E=f,_=g;k.translate(-E,-_),k.transform(...d),u||(u=this._scaleImage(h.canvas,Pt(k)),u=u.img,l&&a&&l.set(c,u)),k.imageSmoothingEnabled=hl(Ce(k),e.interpolate),Si(k,u,0,0,u.width,u.height,0,0,i,r),k.globalCompositeOperation="source-in";const P=K.transform(Pt(k),[1,0,0,1,-E,-_]);return k.fillStyle=a?s.getPattern(t,this,P,Ye.FILL):s,k.fillRect(0,0,i,r),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,A.canvas)),{canvas:A.canvas,offsetX:Math.round(E),offsetY:Math.round(_)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=$v[e]}setLineJoin(e){this.ctx.lineJoin=qv[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;const s=this.ctx;s.setTransform(...Ce(this.suspendedCtx)),Vn(this.suspendedCtx,s),Bv(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Vn(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,r){const s=r[0],a=r[1],o=r[2]-s,l=r[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,i,o,l,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,r,s,a,o,l,c,u,h){let d=e.canvas,f=l-u,g=c-h;if(a){const b=K.makeHexColor(...a);if(f<0||g<0||f+i>d.width||g+r>d.height){const y=this.cachedCanvases.getCanvas("maskExtension",i,r),x=y.context;x.drawImage(d,-f,-g),x.globalCompositeOperation="destination-atop",x.fillStyle=b,x.fillRect(0,0,i,r),x.globalCompositeOperation="source-over",d=y.canvas,f=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(f,g,i,r),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=b,e.fillRect(f,g,i,r),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const m=new Path2D;m.rect(l,c,i,r),t.clip(m),t.globalCompositeOperation="destination-in",t.drawImage(d,f,g,i,r,l,c,i,r),t.restore()}save(){this.inSMaskMode?(Vn(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Vn(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,r,s,a){this.ctx.transform(e,t,i,r,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const r=this.ctx,s=this.current;let a=s.x,o=s.y,l,c;const u=Ce(r),h=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,d=h?i.slice(0):null;for(let f=0,g=0,m=e.length;f<m;f++)switch(e[f]|0){case mt.rectangle:a=t[g++],o=t[g++];const b=t[g++],y=t[g++],x=a+b,A=o+y;r.moveTo(a,o),b===0||y===0?r.lineTo(x,A):(r.lineTo(x,o),r.lineTo(x,A),r.lineTo(a,A)),h||s.updateRectMinMax(u,[a,o,x,A]),r.closePath();break;case mt.moveTo:a=t[g++],o=t[g++],r.moveTo(a,o),h||s.updatePathMinMax(u,a,o);break;case mt.lineTo:a=t[g++],o=t[g++],r.lineTo(a,o),h||s.updatePathMinMax(u,a,o);break;case mt.curveTo:l=a,c=o,a=t[g+4],o=t[g+5],r.bezierCurveTo(t[g],t[g+1],t[g+2],t[g+3],a,o),s.updateCurvePathMinMax(u,l,c,t[g],t[g+1],t[g+2],t[g+3],a,o,d),g+=6;break;case mt.curveTo2:l=a,c=o,r.bezierCurveTo(a,o,t[g],t[g+1],t[g+2],t[g+3]),s.updateCurvePathMinMax(u,l,c,a,o,t[g],t[g+1],t[g+2],t[g+3],d),a=t[g+2],o=t[g+3],g+=4;break;case mt.curveTo3:l=a,c=o,a=t[g+2],o=t[g+3],r.bezierCurveTo(t[g],t[g+1],a,o,a,o),s.updateCurvePathMinMax(u,l,c,t[g],t[g+1],a,o,a,o,d),g+=4;break;case mt.closePath:r.closePath();break}h&&s.updateScalingPathMinMax(u,d),s.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i?.getPattern?(t.save(),t.strokeStyle=i.getPattern(t,this,Pt(t),Ye.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let s=!1;r&&(t.save(),t.fillStyle=i.getPattern(t,this,Pt(t),Ye.FILL),s=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),s&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Vv}eoClip(){this.pendingClip=dl}beginText(){this.current.textMatrix=iu,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(const i of e)t.setTransform(...i.transform),t.translate(i.x,i.y),i.addToPath(t,i.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const i=this.commonObjs.get(e),r=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=i.fontMatrix||gs,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&ce("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const s=i.loadedName||"sans-serif",a=i.systemFontInfo?.css||`"${s}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=t;t<rl?c=rl:t>sl&&(c=sl),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,r,s,a){this.current.textMatrix=[e,t,i,r,s,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,r){const s=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,u=l&Ue.FILL_STROKE_MASK,h=!!(l&Ue.ADD_TO_PATH_FLAG),d=a.patternFill&&!o.missingFile;let f;(o.disableFontFace||h||d)&&(f=o.getPathGenerator(this.commonObjs,e)),o.disableFontFace||d?(s.save(),s.translate(t,i),s.beginPath(),f(s,c),r&&s.setTransform(...r),(u===Ue.FILL||u===Ue.FILL_STROKE)&&s.fill(),(u===Ue.STROKE||u===Ue.FILL_STROKE)&&s.stroke(),s.restore()):((u===Ue.FILL||u===Ue.FILL_STROKE)&&s.fillText(e,t,i),(u===Ue.STROKE||u===Ue.FILL_STROKE)&&s.strokeText(e,t,i)),h&&(this.pendingTextPaths||=[]).push({transform:Ce(s),x:t,y:i,fontSize:c,addToPath:f})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){i=!0;break}return fe(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const r=t.fontSize;if(r===0)return;const s=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,u=t.textHScale*c,h=e.length,d=i.vertical,f=d?1:-1,g=i.defaultVMetrics,m=r*t.fontMatrix[0],b=t.textRenderingMode===Ue.FILL&&!i.disableFontFace&&!t.patternFill;s.save(),s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),c>0?s.scale(u,-1):s.scale(u,1);let y;if(t.patternFill){s.save();const _=t.fillColor.getPattern(s,this,Pt(s),Ye.FILL);y=Ce(s),s.restore(),s.fillStyle=_}let x=t.lineWidth;const A=t.textMatrixScale;if(A===0||x===0){const _=t.textRenderingMode&Ue.FILL_STROKE_MASK;(_===Ue.STROKE||_===Ue.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=A;if(a!==1&&(s.scale(a,a),x/=a),s.lineWidth=x,i.isInvalidPDFjsFont){const _=[];let P=0;for(const D of e)_.push(D.unicode),P+=D.width;s.fillText(_.join(""),0,0),t.x+=P*m*u,s.restore(),this.compose();return}let k=0,E;for(E=0;E<h;++E){const _=e[E];if(typeof _=="number"){k+=f*_*r/1e3;continue}let P=!1;const D=(_.isSpace?l:0)+o,O=_.fontChar,S=_.accent;let R,I,F=_.width;if(d){const N=_.vmetric||g,V=-(_.vmetric?N[1]:F*.5)*m,B=N[2]*m;F=N?-N[0]:F,R=V/a,I=(k+B)/a}else R=k/a,I=0;if(i.remeasure&&F>0){const N=s.measureText(O).width*1e3/r*a;if(F<N&&this.isFontSubpixelAAEnabled){const V=F/N;P=!0,s.save(),s.scale(V,1),R/=V}else F!==N&&(R+=(F-N)/2e3*r/a)}if(this.contentVisible&&(_.isInFont||i.missingFile)){if(b&&!S)s.fillText(O,R,I);else if(this.paintChar(O,R,I,y),S){const N=R+r*S.offset.x/a,V=I-r*S.offset.y/a;this.paintChar(S.fontChar,N,V,y)}}const M=d?F*m-D*c:F*m+D*c;k+=M,P&&s.restore()}d?t.y-=k:t.x+=k*u,s.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,r=i.font,s=i.fontSize,a=i.fontDirection,o=r.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,u=i.textHScale*a,h=i.fontMatrix||gs,d=e.length,f=i.textRenderingMode===Ue.INVISIBLE;let g,m,b,y;if(!(f||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(u,a),g=0;g<d;++g){if(m=e[g],typeof m=="number"){y=o*m*s/1e3,this.ctx.translate(y,0),i.x+=y*u;continue}const x=(m.isSpace?c:0)+l,A=r.charProcOperatorList[m.operatorListId];if(!A){ce(`Type3 character "${m.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=m,this.save(),t.scale(s,s),t.transform(...h),this.executeOperatorList(A),this.restore()),b=K.applyTransform([m.width,0],h)[0]*s+x,t.translate(b,0),i.x+=b*u}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,r,s,a){this.ctx.rect(i,r,s-i,a-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],r=this.baseTransform||Ce(this.ctx),s={createCanvasGraphics:a=>new Pn(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new aa(e,i,this.ctx,s,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=K.makeHexColor(e,t,i)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=K.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=Nv(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,Pt(t),Ye.SHADING);const r=Pt(t);if(r){const{width:s,height:a}=t.canvas,[o,l,c,u]=K.getAxialAlignedBoundingBox([0,0,s,a],r);this.ctx.fillRect(o,l,c-o,u-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){ke("Should not call beginInlineImage")}beginImageData(){ke("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ce(this.ctx),t)){const i=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],i,r),this.current.updateRectMinMax(Ce(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||er("TODO: Support non-isolated groups."),e.knockout&&ce("Knockout groups not supported.");const i=Ce(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=K.getAxialAlignedBoundingBox(e.bbox,Ce(t));const s=[0,0,t.canvas.width,t.canvas.height];r=K.intersect(r,s)||[0,0,0,0];const a=Math.floor(r[0]),o=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-a,1),c=Math.max(Math.ceil(r[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let u="groupAt"+this.groupLevel;e.smask&&(u+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(u,l,c),d=h.context;d.translate(-a,-o),d.transform(...i),e.smask?this.smaskStack.push({canvas:h.canvas,context:d,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Vn(t,d),this.ctx=d,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=Ce(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const s=K.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,i,r,s){if(this.#e(),ki(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(s&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[l,c]=K.singularValueDecompose2dScale(Ce(this.ctx)),{viewportScale:u}=this,h=Math.ceil(a*this.outputScaleX*u),d=Math.ceil(o*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,d);const{canvas:f,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),ki(this.ctx)}else ki(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new ll(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=Uv(e)),r.compiled)){r.compiled(i);return}const s=this._createMaskCanvas(e),a=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,s.offsetX,s.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,r=0,s,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=Ce(o);o.transform(t,i,r,s,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let u=0,h=a.length;u<h;u+=2){const d=K.transform(l,[t,i,r,s,a[u],a[u+1]]),[f,g]=K.applyTransform([0,0],d);o.drawImage(c.canvas,f,g)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;for(const s of e){const{data:a,width:o,height:l,transform:c}=s,u=this.cachedCanvases.getCanvas("maskCanvas",o,l),h=u.context;h.save();const d=this.getObject(a,s);ul(h,d),h.globalCompositeOperation="source-in",h.fillStyle=r?i.getPattern(h,this,Pt(t),Ye.FILL):i,h.fillRect(0,0,o,l),h.restore(),t.save(),t.transform(...c),t.scale(1,-1),Si(t,u.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){ce("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,r){if(!this.contentVisible)return;const s=this.getObject(e);if(!s){ce("Dependent image isn't ready yet");return}const a=s.width,o=s.height,l=[];for(let c=0,u=r.length;c<u;c+=2)l.push({transform:[t,0,0,i,r[c],r[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:r}=e,s=this.cachedCanvases.getCanvas("inlineImage",i,r),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,r=this.ctx;if(this.save(),!We){const{filter:o}=r;o!=="none"&&o!==""&&(r.filter="none")}r.scale(1/t,-1/i);let s;if(e.bitmap)s=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)s=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,i).context;cl(l,e),s=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(s,Pt(r));r.imageSmoothingEnabled=hl(Ce(r),e.interpolate),Si(r,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const s=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",s,a).context;cl(l,e),r=this.applyTransferMapsToCanvas(l)}for(const s of t)i.save(),i.transform(...s.transform),i.scale(1,-1),Si(i,r,s.x,s.y,s.w,s.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===dl?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ce(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:r,d:s}=this.ctx.getTransform();let a,o;if(i===0&&r===0){const l=Math.abs(t),c=Math.abs(s);if(l===c)if(e===0)a=o=1/l;else{const u=l*e;a=o=u<1?1/u:1}else if(e===0)a=1/l,o=1/c;else{const u=l*e,h=c*e;a=u<1?1/u:1,o=h<1?1/h:1}}else{const l=Math.abs(t*s-i*r),c=Math.hypot(t,i),u=Math.hypot(r,s);if(e===0)a=u/l,o=c/l;else{const h=e*l;a=u>h?u/h:1,o=c>h?c/h:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[r,s]=this.getScaleForStroking();if(t.lineWidth=i||1,r===1&&s===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(r,s),a.length>0){const o=Math.max(r,s);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const n in mt)Pn.prototype[n]!==void 0&&(Pn.prototype[mt[n]]=Pn.prototype[n]);class ei{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}const Ei={DATA:1,ERROR:2},Ie={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function st(n){switch(n instanceof Error||typeof n=="object"&&n!==null||ke('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new pn(n.message);case"MissingPDFException":return new fn(n.message);case"PasswordException":return new ms(n.message,n.code);case"UnexpectedResponseException":return new tr(n.message,n.status);case"UnknownErrorException":return new ys(n.message,n.details);default:return new ys(n.message,n.toString())}}class Xn{#e=new AbortController;constructor(e,t,i){this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#i(e);return}if(e.callback){const i=e.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Ei.DATA)r.resolve(e.data);else if(e.callback===Ei.ERROR)r.reject(st(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,r=e.sourceName,s=this.comObj;new Promise(function(a){a(t(e.data))}).then(function(a){s.postMessage({sourceName:i,targetName:r,callback:Ei.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:i,targetName:r,callback:Ei.ERROR,callbackId:e.callbackId,reason:st(a)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const r=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},i)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,i,r){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:t,desiredSize:c.desiredSize},r),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[s].pullCall=u,l.postMessage({sourceName:a,targetName:o,stream:Ie.PULL,streamId:s,desiredSize:c.desiredSize}),u.promise},cancel:c=>{Ne(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[s].cancelCall=u,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Ie.CANCEL,streamId:s,reason:st(c)}),u.promise}},i)}#n(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,u=1,h){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=u,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:r,stream:Ie.ENQUEUE,streamId:t,chunk:c},h)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:Ie.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){Ne(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:Ie.ERROR,streamId:t,reason:st(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,new Promise(function(c){c(o(e.data,l))}).then(function(){s.postMessage({sourceName:i,targetName:r,stream:Ie.START_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:i,targetName:r,stream:Ie.START_COMPLETE,streamId:t,reason:st(c)})})}#i(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,s=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Ie.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(st(e.reason));break;case Ie.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(st(e.reason));break;case Ie.PULL:if(!o){s.postMessage({sourceName:i,targetName:r,stream:Ie.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,new Promise(function(l){l(o.onPull?.())}).then(function(){s.postMessage({sourceName:i,targetName:r,stream:Ie.PULL_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:i,targetName:r,stream:Ie.PULL_COMPLETE,streamId:t,reason:st(l)})});break;case Ie.ENQUEUE:if(Ne(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Ie.CLOSE:if(Ne(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#s(a,t);break;case Ie.ERROR:Ne(a,"error should have stream controller"),a.controller.error(st(e.reason)),this.#s(a,t);break;case Ie.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(st(e.reason)),this.#s(a,t);break;case Ie.CANCEL:if(!o)break;new Promise(function(l){l(o.onCancel?.(st(e.reason)))}).then(function(){s.postMessage({sourceName:i,targetName:r,stream:Ie.CANCEL_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:i,targetName:r,stream:Ie.CANCEL_COMPLETE,streamId:t,reason:st(l)})}),o.sinkCapability.reject(st(e.reason)),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#s(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class Wv{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return Qs(this.#e)}has(e){return this.#e.has(e)}}const wn=Symbol("INTERNAL");class Gv{#e=!1;#t=!1;#n=!1;#i=!0;constructor(e,{name:t,intent:i,usage:r,rbGroups:s}){this.#e=!!(e&ot.DISPLAY),this.#t=!!(e&ot.PRINT),this.name=t,this.intent=i,this.usage=r,this.rbGroups=s}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,i=!1){e!==wn&&ke("Internal method `_setVisible` called."),this.#n=i,this.#i=t}}class Xv{#e=null;#t=new Map;#n=null;#i=null;constructor(e,t=ot.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#i=e.order;for(const i of e.groups)this.#t.set(i.id,new Gv(t,i));if(e.baseState==="OFF")for(const i of this.#t.values())i._setVisible(wn,!1);for(const i of e.on)this.#t.get(i)._setVisible(wn,!0);for(const i of e.off)this.#t.get(i)._setVisible(wn,!1);this.#n=this.getHash()}}#s(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let r=1;r<t;r++){const s=e[r];let a;if(Array.isArray(s))a=this.#s(s);else if(this.#t.has(s))a=this.#t.get(s).visible;else return ce(`Optional content group not found: ${s}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return er("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(ce(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#s(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return ce(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return ce(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return ce(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return ce(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return ce(`Unknown optional content policy ${e.policy}.`),!0}return ce(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){const r=this.#t.get(e);if(!r){ce(`Optional content group not found: ${e}`);return}if(i&&t&&r.rbGroups.length)for(const s of r.rbGroups)for(const a of s)a!==e&&this.#t.get(a)?._setVisible(wn,!1,!0);r._setVisible(wn,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let i;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const s=this.#t.get(r);if(s)switch(i){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!s.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#i?this.#i.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?Qs(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new ou;for(const[t,i]of this.#t)e.update(`${t}:${i.visible}`);return this.#e=e.hexdigest()}}class Yv{constructor(e,{disableRange:t=!1,disableStream:i=!1}){Ne(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,s?.length>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(i),!0)});Ne(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ne(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Kv(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new Qv(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class Kv{constructor(e,t,i=!1,r=null){this._stream=e,this._done=i||!1,this._filename=ea(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Qv{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Jv(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let u=o(t);return u=unescape(u),u=l(u),u=c(u),s(u)}if(t=a(n),t){const u=c(t);return s(u)}if(t=i("filename","i").exec(n),t){t=t[1];let u=o(t);return u=c(u),s(u)}function i(u,h){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function r(u,h){if(u){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const d=new TextDecoder(u,{fatal:!0}),f=nr(h);h=d.decode(f),e=!1}catch{}}return h}function s(u){return e&&/[\x80-\xff]/.test(u)&&(u=r("utf-8",u),e&&(u=r("iso-8859-1",u))),u}function a(u){const h=[];let d;const f=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=f.exec(u))!==null;){let[,m,b,y]=d;if(m=parseInt(m,10),m in h){if(m===0)break;continue}h[m]=[b,y]}const g=[];for(let m=0;m<h.length&&m in h;++m){let[b,y]=h[m];y=o(y),b&&(y=unescape(y),m===0&&(y=l(y))),g.push(y)}return g.join("")}function o(u){if(u.startsWith('"')){const h=u.slice(1).split('\\"');for(let d=0;d<h.length;++d){const f=h[d].indexOf('"');f!==-1&&(h[d]=h[d].slice(0,f),h.length=d+1),h[d]=h[d].replaceAll(/\\(.)/g,"$1")}u=h.join('"')}return u}function l(u){const h=u.indexOf("'");if(h===-1)return u;const d=u.slice(0,h),g=u.slice(h+1).replace(/^[^']*'/,"");return r(d,g)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,d,f,g){if(f==="q"||f==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,b){return String.fromCharCode(parseInt(b,16))}),r(d,g);try{g=atob(g)}catch{}return r(d,g)})}return""}function oa(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const r=e[i];r!==void 0&&t.append(i,r)}return t}function la({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(r.suggestedLength=s,s<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function ca(n){const e=n.get("Content-Disposition");if(e){let t=Jv(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(ea(t))return t}return null}function sr(n,e){return n===404||n===0&&e.startsWith("file:")?new fn('Missing PDF "'+e+'".'):new tr(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function mu(n){return n===200||n===206}function yu(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function bu(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ce(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class fl{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=oa(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ne(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Zv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new e0(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Zv{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),r=t.url;fetch(r,yu(i,this._withCredentials,this._abortController)).then(s=>{if(!mu(s.status))throw sr(s.status,r);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:l}=la({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=ca(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new pn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:bu(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class e0{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${i-1}`);const a=r.url;fetch(a,yu(s,this._withCredentials,this._abortController)).then(o=>{if(!mu(o.status))throw sr(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:bu(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Nr=200,jr=206;function t0(n){const e=n.response;return typeof e!="string"?e:nr(e).buffer}class n0{constructor({url:e,httpHeaders:t,withCredentials:i}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=oa(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,i){const r={begin:e,end:t};for(const s in i)r[s]=i[s];return this.request(r)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=jr):r.expectedStatus=Nr,t.responseType="arraybuffer",e.onError&&(t.onerror=function(s){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){const i=this.pendingRequests[e];i&&i.onProgress?.(t)}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){i.onError?.(r.status);return}const s=r.status||Nr;if(!(s===Nr&&i.expectedStatus===jr)&&s!==i.expectedStatus){i.onError?.(r.status);return}const o=t0(r);if(s===jr){const l=r.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);i.onDone({begin:parseInt(c[1],10),chunk:o})}else o?i.onDone({begin:0,chunk:o}):i.onError?.(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class i0{constructor(e){this._source=e,this._manager=new n0(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ne(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new r0(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new s0(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class r0{constructor(e,t){this._manager=e;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(i),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),i=new Headers(t.getAllResponseHeaders().trim().split(/[\r\n]+/).map(a=>{const[o,...l]=a.split(": ");return[o,l.join(": ")]})),{allowRangeRequests:r,suggestedLength:s}=la({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=ca(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=sr(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class s0{constructor(e,t,i){this._manager=e;const r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,i,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=sr(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const a0=/^[a-z][a-z0-9\-+.]+:/i;function o0(n){if(a0.test(n))return new URL(n);const e=Vt.get("url");return new URL(e.pathToFileURL(n))}function xu(n,e,t){return n.protocol==="http:"?Vt.get("http").request(n,{headers:e},t):Vt.get("https").request(n,{headers:e},t)}class l0{constructor(e){this.source=e,this.url=o0(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=oa(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ne(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new h0(this):new c0(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=this.isFsUrl?new d0(this,e,t):new u0(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class wu{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new pn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class vu{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class c0 extends wu{constructor(e){super(e);const t=Object.fromEntries(e.headers),i=r=>{if(r.statusCode===404){const l=new fn(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(r);const s=new Headers(this._readableStream.headers),{allowRangeRequests:a,suggestedLength:o}=la({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=o||this._contentLength,this._filename=ca(s)};this._request=xu(this._url,t,i),this._request.on("error",r=>{this._storedError=r,this._headersCapability.reject(r)}),this._request.end()}}class u0 extends vu{constructor(e,t,i){super(e);const r=Object.fromEntries(e.headers);r.Range=`bytes=${t}-${i-1}`;const s=a=>{if(a.statusCode===404){const o=new fn(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(a)};this._request=xu(this._url,r,s),this._request.on("error",a=>{this._storedError=a}),this._request.end()}}class h0 extends wu{constructor(e){super(e);const t=Vt.get("fs");t.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(t.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new fn(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}}class d0 extends vu{constructor(e,t,i){super(e);const r=Vt.get("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}}const f0=1e5,et=30,p0=.8;let _s=class ht{#e=Promise.withResolvers();#t=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#l=0;#c=0;#u=null;#o=null;#h=0;#a=0;#d=Object.create(null);#p=[];#f=null;#y=[];#m=new WeakMap;#g=null;static#b=new Map;static#w=new Map;static#E=new WeakMap;static#_=null;static#S=new Set;constructor({textContentSource:e,container:t,viewport:i}){if(e instanceof ReadableStream)this.#f=e;else if(typeof e=="object")this.#f=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#o=t,this.#a=i.scale*(globalThis.devicePixelRatio||1),this.#h=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:s,pageX:a,pageY:o}=i.rawDims;this.#g=[1,0,0,-1,-a,o+s],this.#c=r,this.#l=s,ht.#P(),cn(t,i),this.#e.promise.finally(()=>{ht.#S.delete(this),this.#r=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Qe.platform;return fe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#u.read().then(({value:t,done:i})=>{if(i){this.#e.resolve();return}this.#s??=t.lang,Object.assign(this.#d,t.styles),this.#F(t.items),e()},this.#e.reject)};return this.#u=this.#f.getReader(),ht.#S.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const i=e.scale*(globalThis.devicePixelRatio||1),r=e.rotation;if(r!==this.#h&&(t?.(),this.#h=r,cn(this.#o,{rotation:r})),i!==this.#a){t?.(),this.#a=i;const s={div:null,properties:null,ctx:ht.#k(this.#s)};for(const a of this.#y)s.properties=this.#m.get(a),s.div=a,this.#v(s)}}cancel(){const e=new pn("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#y}get textContentItemsStr(){return this.#p}#F(e){if(this.#n)return;this.#r.ctx??=ht.#k(this.#s);const t=this.#y,i=this.#p;for(const r of e){if(t.length>f0){ce("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const s=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),r.id!==null&&this.#t.setAttribute("id",`${r.id}`),s.append(this.#t)}else r.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}i.push(r.str),this.#C(r)}}#C(e){const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#y.push(t);const r=K.transform(this.#g,e.transform);let s=Math.atan2(r[1],r[0]);const a=this.#d[e.fontName];a.vertical&&(s+=Math.PI/2);let o=this.#i&&a.fontSubstitution||a.fontFamily;o=ht.fontFamilyMap.get(o)||o;const l=Math.hypot(r[2],r[3]),c=l*ht.#L(o,this.#s);let u,h;s===0?(u=r[4],h=r[5]-c):(u=r[4]+c*Math.sin(s),h=r[5]-c*Math.cos(s));const d="calc(var(--scale-factor)*",f=t.style;this.#t===this.#o?(f.left=`${(100*u/this.#c).toFixed(2)}%`,f.top=`${(100*h/this.#l).toFixed(2)}%`):(f.left=`${d}${u.toFixed(2)}px)`,f.top=`${d}${h.toFixed(2)}px)`),f.fontSize=`${d}${(ht.#_*l).toFixed(2)}px)`,f.fontFamily=o,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#i&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(i.angle=s*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const m=Math.abs(e.transform[0]),b=Math.abs(e.transform[3]);m!==b&&Math.max(m,b)/Math.min(m,b)>1.5&&(g=!0)}if(g&&(i.canvasWidth=a.vertical?e.height:e.width),this.#m.set(t,i),this.#r.div=t,this.#r.properties=i,this.#v(this.#r),i.hasText&&this.#t.append(t),i.hasEOL){const m=document.createElement("br");m.setAttribute("role","presentation"),this.#t.append(m)}}#v(e){const{div:t,properties:i,ctx:r}=e,{style:s}=t;let a="";if(ht.#_>1&&(a=`scale(${1/ht.#_})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:o}=s,{canvasWidth:l,fontSize:c}=i;ht.#T(r,c*this.#a,o);const{width:u}=r.measureText(t.textContent);u>0&&(a=`scaleX(${l*this.#a/u}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(s.transform=a)}static cleanup(){if(!(this.#S.size>0)){this.#b.clear();for(const{canvas:e}of this.#w.values())e.remove();this.#w.clear()}}static#k(e=null){let t=this.#w.get(e||="");if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#w.set(e,t),this.#E.set(t,{size:0,family:""})}return t}static#T(e,t,i){const r=this.#E.get(e);t===r.size&&i===r.family||(e.font=`${t}px ${i}`,r.size=t,r.family=i)}static#P(){if(this.#_!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#_=e.getBoundingClientRect().height,e.remove()}static#L(e,t){const i=this.#b.get(e);if(i)return i;const r=this.#k(t);r.canvas.width=r.canvas.height=et,this.#T(r,et,e);const s=r.measureText("");let a=s.fontBoundingBoxAscent,o=Math.abs(s.fontBoundingBoxDescent);if(a){const u=a/(a+o);return this.#b.set(e,u),r.canvas.width=r.canvas.height=0,u}r.strokeStyle="red",r.clearRect(0,0,et,et),r.strokeText("g",0,0);let l=r.getImageData(0,0,et,et).data;o=0;for(let u=l.length-1-3;u>=0;u-=4)if(l[u]>0){o=Math.ceil(u/4/et);break}r.clearRect(0,0,et,et),r.strokeText("A",0,et),l=r.getImageData(0,0,et,et).data,a=0;for(let u=0,h=l.length;u<h;u+=4)if(l[u]>0){a=et-Math.floor(u/4/et);break}r.canvas.width=r.canvas.height=0;const c=a?a/(a+o):p0;return this.#b.set(e,c),c}};class li{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function r(s){if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(li.shouldBuildText(o))s?.attributes?.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&t.push({str:a}),!!s.children)for(const l of s.children)r(l)}return r(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const g0=65536,m0=100,y0=5e3,b0=We?Rv:Cv,x0=We?Iv:hu,w0=We?Pv:Tv,v0=We?Lv:pu;function A0(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new ua,{docId:t}=e,i=n.url?_0(n.url):null,r=n.data?S0(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof Au?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:g0;let u=n.worker instanceof ze?n.worker:null;const h=n.verbosity,d=typeof n.docBaseUrl=="string"&&!rr(n.docBaseUrl)?n.docBaseUrl:null,f=typeof n.cMapUrl=="string"?n.cMapUrl:null,g=n.cMapPacked!==!1,m=n.CMapReaderFactory||x0,b=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,y=n.StandardFontDataFactory||v0,x=n.stopAtErrors!==!0,A=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,E=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!We,_=typeof n.isChrome=="boolean"?n.isChrome:!Qe.platform.isFirefox&&typeof window<"u"&&!!window?.chrome,P=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,D=typeof n.disableFontFace=="boolean"?n.disableFontFace:We,O=n.fontExtraProperties===!0,S=n.enableXfa===!0,R=n.ownerDocument||globalThis.document,I=n.disableRange===!0,F=n.disableStream===!0,M=n.disableAutoFetch===!0,N=n.pdfBug===!0,V=n.CanvasFactory||b0,B=n.FilterFactory||w0,q=n.enableHWA===!0,U=l?l.length:n.length??NaN,v=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!We&&!D,G=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:m===hu&&y===pu&&f&&b&&Gn(f,document.baseURI)&&Gn(b,document.baseURI);n.canvasFactory&&tl("`canvasFactory`-instance option, please use `CanvasFactory` instead."),n.filterFactory&&tl("`filterFactory`-instance option, please use `FilterFactory` instead.");const X=null;rv(h);const w={canvasFactory:new V({ownerDocument:R,enableHWA:q}),filterFactory:new B({docId:t,ownerDocument:R}),cMapReaderFactory:G?null:new m({baseUrl:f,isCompressed:g}),standardFontDataFactory:G?null:new y({baseUrl:b})};if(!u){const Q={verbosity:h,port:ei.workerPort};u=Q.port?ze.fromPort(Q):new ze(Q),e._worker=u}const ne={docId:t,apiVersion:"4.8.69",data:r,password:o,disableAutoFetch:M,rangeChunkSize:c,length:U,docBaseUrl:d,enableXfa:S,evaluatorOptions:{maxImageSize:A,disableFontFace:D,ignoreErrors:x,isEvalSupported:k,isOffscreenCanvasSupported:E,isChrome:_,canvasMaxAreaInBytes:P,fontExtraProperties:O,useSystemFonts:v,cMapUrl:G?f:null,standardFontDataUrl:G?b:null}},$={disableFontFace:D,fontExtraProperties:O,ownerDocument:R,pdfBug:N,styleElement:X,loadingParams:{disableAutoFetch:M,enableXfa:S}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Q=u.messageHandler.sendWithPromise("GetDocRequest",ne,r?[r.buffer]:null);let Y;if(l)Y=new Yv(l,{disableRange:I,disableStream:F});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");let Ae;We?Ae=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&Gn(i)?fl:l0:Ae=Gn(i)?fl:i0,Y=new Ae({url:i,length:U,httpHeaders:s,withCredentials:a,rangeChunkSize:c,disableRange:I,disableStream:F})}return Q.then(Ae=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Ee=new Xn(t,Ae,u.port),he=new T0(Ee,e,Y,$,w);e._transport=he,Ee.send("Ready",null)})}).catch(e._capability.reject),e}function _0(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(We&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function S0(n){if(We&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return nr(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function pl(n){return typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0}class ua{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${ua.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}let Au=class{constructor(e,t,i=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){ke("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class k0{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return fe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class E0{#e=null;#t=!1;constructor(e,t,i,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=r?new el:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new _u,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:s=!1}={}){return new di({viewBox:this.view,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return fe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:r=Ht.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:u=null,isEditing:h=!1}){this._stats?.time("Overall");const d=this._transport.getRenderingIntent(i,r,u,h),{renderingIntent:f,cacheKey:g}=d;this.#t=!1,this.#i(),o||=this._transport.getOptionalContentConfig(f);let m=this._intentStates.get(g);m||(m=Object.create(null),this._intentStates.set(g,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const b=!!(f&ot.PRINT);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d));const y=k=>{m.renderTasks.delete(x),(this._maybeCleanupAfterRender||b)&&(this.#t=!0),this.#n(!b),k?(x.capability.reject(k),this._abortOperatorList({intentState:m,reason:k instanceof Error?k:new Error(k)})):x.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},x=new An({callback:y,params:{canvasContext:e,viewport:t,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||=new Set).add(x);const A=x.task;return Promise.all([m.displayReadyCapability.promise,o]).then(([k,E])=>{if(this.destroyed){y();return}if(this._stats?.time("Rendering"),!(E.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");x.initializeGraphics({transparency:k,optionalContentConfig:E}),x.operatorListChanged()}).catch(y),A}getOperatorList({intent:e="display",annotationMode:t=Ht.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,i,r,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>li.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,r){function s(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??=l.lang,Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},r)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,this.#i(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#n(!1);return e&&t&&(this._stats&&=new el),t}#n(e=!1){if(this.#i(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},y0),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#i(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const i=this._intentStates.get(t);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let i=0,r=e.length;i<r;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:r}){const{map:s,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:r},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const u=()=>{l.read().then(({value:h,done:d})=>{if(d){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,c),u())},h=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const d of c.renderTasks)d.operatorListChanged();this.#n(!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(h);else if(c.opListReadCapability)c.opListReadCapability.reject(h);else throw h}})};u()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof Zs){let r=m0;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new pn(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,s]of this._intentStates)if(s===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class C0{#e=new Map;#t=Promise.resolve();postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[r]of this.#e)r.call(this,i)})}addEventListener(e,t,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:s}=i;if(s.aborted){ce("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);r=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}this.#e.set(t,r)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}class ze{static#e=0;static#t=!1;static#n;static{We&&(this.#t=!0,ei.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const r=new URL(t,i);return i.origin===r.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}}constructor({name:e=null,port:t=null,verbosity:i=sv()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(ze.#n?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(ze.#n||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return We?Promise.all([Vt.promise,this._readyCapability.promise]):this._readyCapability.promise}#i(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Xn("main","worker",e),this._messageHandler.on("ready",function(){}),this.#i()}_initialize(){if(ze.#t||ze.#s){this._setupFakeWorker();return}let{workerSrc:e}=ze;try{ze._isSameOrigin(window.location.href,e)||(e=ze._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Xn("main","worker",t),r=()=>{s.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;t.addEventListener("error",()=>{this._webWorker||r()},{signal:s.signal}),i.on("test",o=>{if(s.abort(),this.destroyed||!o){r();return}this._messageHandler=i,this._port=t,this._webWorker=t,this.#i()}),i.on("ready",o=>{if(s.abort(),this.destroyed){r();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{er("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){ze.#t||(ce("Setting up fake worker."),ze.#t=!0),ze._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new C0;this._port=t;const i=`fake${ze.#e++}`,r=new Xn(i+"_worker",i,t);e.setup(r,t),this._messageHandler=new Xn(i,i+"_worker",t),this.#i()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),ze.#n?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#n?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new ze(e)}static get workerSrc(){if(ei.workerSrc)return ei.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#s(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return fe(this,"_setupFakeWorkerGlobal",(async()=>this.#s?this.#s:(await import(this.workerSrc)).WorkerMessageHandler)())}}class T0{#e=new Map;#t=new Map;#n=new Map;#i=new Map;#s=null;constructor(e,t,i,r,s){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new _u,this.fontLoader=new kv({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#r(e,t=null){const i=this.#e.get(e);if(i)return i;const r=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,r),r}get annotationStorage(){return fe(this,"annotationStorage",new ra)}getRenderingIntent(e,t=Ht.ENABLE,i=null,r=!1,s=!1){let a=ot.DISPLAY,o=xs;switch(e){case"any":a=ot.ANY;break;case"display":break;case"print":a=ot.PRINT;break;default:ce(`getRenderingIntent - invalid intent: ${e}`)}const l=a&ot.PRINT&&i instanceof lu?i:this.annotationStorage;switch(t){case Ht.DISABLE:a+=ot.ANNOTATIONS_DISABLE;break;case Ht.ENABLE:break;case Ht.ENABLE_FORMS:a+=ot.ANNOTATIONS_FORMS;break;case Ht.ENABLE_STORAGE:a+=ot.ANNOTATIONS_STORAGE,o=l.serializable;break;default:ce(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(a+=ot.IS_EDITING),s&&(a+=ot.OPLIST);const{ids:c,hash:u}=l.modifiedIds,h=[a,o.hash,u];return{renderingIntent:a,cacheKey:h.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of this.#t.values())e.push(i._destroy());this.#t.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),_s.cleanup(),this._networkStream?.cancelAllRequests(new pn("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,r)=>{Ne(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},r.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){r.close();return}Ne(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{this._fullReader.cancel(s),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:s,contentLength:a}=this._fullReader;return(!r||!s)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:r,isRangeSupported:s,contentLength:a}}),e.on("GetRangeReader",(i,r)=>{Ne(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(i.begin,i.end);if(!s){r.close();return}r.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){r.close();return}Ne(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{s.cancel(a),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new k0(i,this))}),e.on("DocException",function(i){let r;switch(i.name){case"PasswordException":r=new ms(i.message,i.code);break;case"InvalidPDFException":r=new ru(i.message);break;case"MissingPDFException":r=new fn(i.message);break;case"UnexpectedResponseException":r=new tr(i.message,i.status);break;case"UnknownErrorException":r=new ys(i.message,i.details);break;default:ke("DocException - expected a valid Error.")}t._capability.reject(r)}),e.on("PasswordRequest",i=>{if(this.#s=Promise.withResolvers(),t.onPassword){const r=s=>{s instanceof Error?this.#s.reject(s):this.#s.resolve({password:s})};try{t.onPassword(r,i.code)}catch(s){this.#s.reject(s)}}else this.#s.reject(new ms(i.message,i.code));return this.#s.promise}),e.on("DataLoaded",i=>{t.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;this.#t.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,r,s])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":const{disableFontFace:a,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in s){const d=s.error;ce(`Error during font loading: ${d}`),this.commonObjs.resolve(i,d);break}const c=l&&globalThis.FontInspector?.enabled?(d,f)=>globalThis.FontInspector.fontAdded(d,f):null,u=new Ev(s,{disableFontFace:a,inspectFont:c});this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!o&&u.data&&(u.data=null),this.commonObjs.resolve(i,u)});break;case"CopyLocalImage":const{imageRef:h}=s;Ne(h,"The imageRef must be defined.");for(const d of this.#t.values())for(const[,f]of d.objs)if(f?.ref===h)return f.dataLen?(this.commonObjs.resolve(i,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,s);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([i,r,s,a])=>{if(this.destroyed)return;const o=this.#t.get(r);if(!o.objs.has(i)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(s){case"Image":o.objs.resolve(i,a),a?.dataLen>ev&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",i=>{this.destroyed||t.onProgress?.({loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ce("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=this.#n.get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#i.set(s.refStr,e);const a=new E0(t,s,this,this._params.pdfBug);return this.#t.set(t,a),a});return this.#n.set(t,r),r}getPageIndex(e){return pl(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#r("GetOptionalContentConfig").then(t=>new Xv(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new Wv(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),_s.cleanup()}}cachedPageNumber(e){if(!pl(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#i.get(t)??null}}const Ci=Symbol("INITIAL_DATA");class _u{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Ci}}get(e,t=null){if(t){const r=this.#t(e);return r.promise.then(()=>t(r.data)),null}const i=this.#e[e];if(!i||i.data===Ci)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=this.#e[e];return!!t&&t.data!==Ci}resolve(e,t=null){const i=this.#t(e);i.data=t,i.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Ci&&(yield[e,t])}}}class P0{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class An{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:i,commonObjs:r,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:h=!1,pageColors:d=null}){this.callback=e,this.params=t,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new P0(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(An.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");An.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:r,transform:s,background:a}=this.params;this.gfx=new Pn(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:r,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),An.#t.delete(this._canvas),this.callback(e||new Zs(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),An.#t.delete(this._canvas),this.callback())))}}const R0="4.8.69",I0="3634dab10";function gl(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Wn(n){return Math.max(0,Math.min(255,255*n))}class ml{static CMYK_G([e,t,i,r]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Wn(e),[e,e,e]}static G_HTML([e]){const t=gl(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Wn)}static RGB_HTML(e){return`#${e.map(gl).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,i+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,i,r]){return[Wn(1-Math.min(1,e+r)),Wn(1-Math.min(1,i+r)),Wn(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const r=1-e,s=1-t,a=1-i,o=Math.min(r,s,a);return["CMYK",r,s,a,o]}}class L0{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){ke("Abstract method `_createSVG` called.")}}class ha extends L0{_createSVG(e){return document.createElementNS(It,e)}}class Su{static setupStorage(e,t,i,r,s){const a=r.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{r.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;r.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:r,linkService:s}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${r}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&s.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){const t=e.annotationStorage,i=e.linkService,r=e.xfaHtml,s=e.intent||"display",a=document.createElement(r.name);r.attributes&&this.setAttributes({html:a,element:r,intent:s,linkService:i});const o=s!=="richText",l=e.div;if(l.append(a),e.viewport){const h=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=h}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(r.children.length===0){if(r.value){const h=document.createTextNode(r.value);a.append(h),o&&li.shouldBuildText(r.name)&&c.push(h)}return{textDivs:c}}const u=[[r,-1,a]];for(;u.length>0;){const[h,d,f]=u.at(-1);if(d+1===h.children.length){u.pop();continue}const g=h.children[++u.at(-1)[1]];if(g===null)continue;const{name:m}=g;if(m==="#text"){const y=document.createTextNode(g.value);c.push(y),f.append(y);continue}const b=g?.attributes?.xmlns?document.createElementNS(g.attributes.xmlns,m):document.createElement(m);if(f.append(b),g.attributes&&this.setAttributes({html:b,element:g,storage:t,intent:s,linkService:i}),g.children?.length>0)u.push([g,-1,b]);else if(g.value){const y=document.createTextNode(g.value);o&&li.shouldBuildText(m)&&c.push(y),b.append(y)}}for(const h of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))h.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const pi=1e3,D0=9,un=new WeakSet;function Ft(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class M0{static create(e){switch(e.data.annotationType){case Fe.LINK:return new ku(e);case Fe.TEXT:return new F0(e);case Fe.WIDGET:switch(e.data.fieldType){case"Tx":return new O0(e);case"Btn":return e.data.radioButton?new Eu(e):e.data.checkBox?new j0(e):new z0(e);case"Ch":return new B0(e);case"Sig":return new N0(e)}return new gn(e);case Fe.POPUP:return new Ss(e);case Fe.FREETEXT:return new Cu(e);case Fe.LINE:return new U0(e);case Fe.SQUARE:return new $0(e);case Fe.CIRCLE:return new q0(e);case Fe.POLYLINE:return new Tu(e);case Fe.CARET:return new W0(e);case Fe.INK:return new da(e);case Fe.POLYGON:return new V0(e);case Fe.HIGHLIGHT:return new Pu(e);case Fe.UNDERLINE:return new G0(e);case Fe.SQUIGGLY:return new X0(e);case Fe.STRIKEOUT:return new Y0(e);case Fe.STAMP:return new Ru(e);case Fe.FILEATTACHMENT:return new K0(e);default:return new Re(e)}}}class Re{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e?.str||t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Re._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#i(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#i(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#i(e){const{container:{style:t},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;i?.splice(0,4,...e);const{width:c,height:u}=Ft(e);t.left=`${100*(e[0]-o)/s}%`,t.top=`${100*(a-e[3]+l)/a}%`,r===0?(t.width=`${100*c/s}%`,t.height=`${100*u/a}%`):this.setRotation(r)}_createContainer(e){const{data:t,parent:{page:i,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof gn||(s.tabIndex=pi);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof Ss){const{rotation:m}=t;return!t.hasOwnCanvas&&m!==0&&this.setRotation(m,s),s}const{width:o,height:l}=Ft(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const m=t.borderStyle.horizontalCornerRadius,b=t.borderStyle.verticalCornerRadius;if(m>0||b>0){const x=`calc(${m}px * var(--scale-factor)) / calc(${b}px * var(--scale-factor))`;a.borderRadius=x}else if(this instanceof Eu){const x=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=x}switch(t.borderStyle.style){case qn.SOLID:a.borderStyle="solid";break;case qn.DASHED:a.borderStyle="dashed";break;case qn.BEVELED:ce("Unimplemented border style: beveled");break;case qn.INSET:ce("Unimplemented border style: inset");break;case qn.UNDERLINE:a.borderBottomStyle="solid";break}const y=t.borderColor||null;y?(this.#t=!0,a.borderColor=K.makeHexColor(y[0]|0,y[1]|0,y[2]|0)):a.borderWidth=0}const c=K.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:u,pageHeight:h,pageX:d,pageY:f}=r.rawDims;a.left=`${100*(c[0]-d)/u}%`,a.top=`${100*(c[1]-f)/h}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*o/u}%`,a.height=`${100*l/h}%`):this.setRotation(g,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims,{width:s,height:a}=Ft(this.data.rect);let o,l;e%180===0?(o=100*s/i,l=100*a/r):(o=100*a/i,l=100*s/r),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,r)=>{const s=r.detail[t],a=s[0],o=s.slice(1);r.target.style[i]=ml[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:ml[`${a}_rgb`](o)})};return fe(this,"_commonActions",{display:t=>{const{display:i}=t.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const r of Object.keys(t.detail))(e[r]||i[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[r,s]of Object.entries(t)){const a=i[r];if(a){const o={detail:{[r]:s},target:e};a(o),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,r,s]=this.data.rect.map(m=>Math.fround(m));if(e.length===8){const[m,b,y,x]=e.subarray(2,6);if(r===m&&s===b&&t===y&&i===x)return}const{style:a}=this.container;let o;if(this.#t){const{borderColor:m,borderWidth:b}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const l=r-t,c=s-i,{svgFactory:u}=this,h=u.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const d=u.createElement("defs");h.append(d);const f=u.createElement("clipPath"),g=`clippath_${this.data.id}`;f.setAttribute("id",g),f.setAttribute("clipPathUnits","objectBoundingBox"),d.append(f);for(let m=2,b=e.length;m<b;m+=8){const y=e[m],x=e[m+1],A=e[m+2],k=e[m+3],E=u.createElement("rect"),_=(A-t)/l,P=(s-x)/c,D=(y-A)/l,O=(x-k)/c;E.setAttribute("x",_),E.setAttribute("y",P),E.setAttribute("width",D),E.setAttribute("height",O),f.append(E),o?.push(`<rect vector-effect="non-scaling-stroke" x="${_}" y="${P}" width="${D}" height="${O}"/>`)}this.#t&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(h),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=this.#n=new Ss({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){ke("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:s,id:a,exportValues:o}of r){if(s===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!un.has(c)){ce(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const r of document.getElementsByName(e)){const{exportValue:s}=r,a=r.getAttribute("data-element-id");a!==t&&un.has(r)&&i.push({id:a,exportValue:s,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class ku extends Re{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(i,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(i,e.action),r=!0):e.attachment?(this.#t(i,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(this.#n(i,e.setOCGState),r=!0):e.dest?(this._bindLink(i,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),r=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,i=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(t.actions)){const s=i.get(r);s&&(e[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){ce('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{i?.();const{fields:r,refs:s,include:a}=t,o=[];if(r.length!==0||s.length!==0){const u=new Set(s);for(const h of r){const d=this._fieldObjects[h]||[];for(const{id:f}of d)u.add(f)}for(const h of Object.values(this._fieldObjects))for(const d of h)u.has(d.id)===a&&o.push(d)}else for(const u of Object.values(this._fieldObjects))o.push(...u);const l=this.annotationStorage,c=[];for(const u of o){const{id:h}=u;switch(c.push(h),u.type){case"text":{const f=u.defaultValue||"";l.setValue(h,{value:f});break}case"checkbox":case"radiobutton":{const f=u.defaultValue===u.exportValues;l.setValue(h,{value:f});break}case"combobox":case"listbox":{const f=u.defaultValue||"";l.setValue(h,{value:f});break}default:continue}const d=document.querySelector(`[data-element-id="${h}"]`);if(d){if(!un.has(d)){ce(`_bindResetFormAction - element not allowed: ${h}`);continue}}else continue;d.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}}class F0 extends Re{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class gn extends Re{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Qe.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,r,s){i.includes("mouse")?e.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a)}})})}_setEventListeners(e,t,i,r){for(const[s,a]of i)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,s,a,r),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":K.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||D0,s=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),u=Math.round(c/(Dr*r))||1,h=c/u;a=Math.min(r,l(h/Dr))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(r,l(c/Dr))}s.fontSize=`calc(${a}px * var(--scale-factor))`,s.color=K.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class O0 extends gn{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,r){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),s.setValue(a.id,{[r]:i})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let s=r.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&s.length>a&&(s=s.slice(0,a));let o=r.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const l={userValue:s,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=o??s,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",o??s),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),un.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=pi,this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",u=>{e.setValue(t,{value:u.target.value}),this.setPropertyOnSiblings(i,"value",u.target.value,"value"),l.formattedValue=null}),i.addEventListener("resetform",u=>{const h=this.data.defaultFieldValue??"";i.value=l.userValue=h,l.formattedValue=null});let c=u=>{const{formattedValue:h}=l;h!=null&&(u.target.value=h),u.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",h=>{if(l.focused)return;const{target:d}=h;l.userValue&&(d.value=l.userValue),l.lastCommittedValue=d.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),i.addEventListener("updatefromsandbox",h=>{this.showElementAndHideCanvas(h.target);const d={value(f){l.userValue=f.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),f.target.value=l.userValue},formattedValue(f){const{formattedValue:g}=f.detail;l.formattedValue=g,g!=null&&f.target!==document.activeElement&&(f.target.value=g),e.setValue(t,{formattedValue:g})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{const{charLimit:g}=f.detail,{target:m}=f;if(g===0){m.removeAttribute("maxLength");return}m.setAttribute("maxLength",g);let b=l.userValue;!b||b.length<=g||(b=b.slice(0,g),m.value=l.userValue=b,e.setValue(t,{value:b}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:1,selStart:m.selectionStart,selEnd:m.selectionEnd}}))}};this._dispatchEventFromSandbox(d,h)}),i.addEventListener("keydown",h=>{l.commitKey=1;let d=-1;if(h.key==="Escape"?d=0:h.key==="Enter"&&!this.data.multiLine?d=2:h.key==="Tab"&&(l.commitKey=3),d===-1)return;const{value:f}=h.target;l.lastCommittedValue!==f&&(l.lastCommittedValue=f,l.userValue=f,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:d,selStart:h.target.selectionStart,selEnd:h.target.selectionEnd}}))});const u=c;c=null,i.addEventListener("blur",h=>{if(!l.focused||!h.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:d}=h.target;l.userValue=d,l.lastCommittedValue!==d&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:d,willCommit:!0,commitKey:l.commitKey,selStart:h.target.selectionStart,selEnd:h.target.selectionEnd}}),u(h)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",h=>{l.lastCommittedValue=null;const{data:d,target:f}=h,{value:g,selectionStart:m,selectionEnd:b}=f;let y=m,x=b;switch(h.inputType){case"deleteWordBackward":{const A=g.substring(0,m).match(/\w*[^\w]*$/);A&&(y-=A[0].length);break}case"deleteWordForward":{const A=g.substring(m).match(/^[^\w]*\w*/);A&&(x+=A[0].length);break}case"deleteContentBackward":m===b&&(y-=1);break;case"deleteContentForward":m===b&&(x+=1);break}h.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,change:d||"",willCommit:!1,selStart:y,selEnd:x}})}),this._setEventListeners(i,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],h=>h.target.value)}if(c&&i.addEventListener("blur",c),this.data.comb){const h=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${h}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class N0 extends gn{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class j0 extends gn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return un.add(s),s.setAttribute("data-element-id",i),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=pi,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const u=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=u),e.setValue(c.id,{value:u})}e.setValue(i,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Eu extends gn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(i,{value:r})),r)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(un.add(s),s.setAttribute("data-element-id",i),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.tabIndex=pi,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))e.setValue(c.id,{value:!1});e.setValue(i,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const u=a===c.detail.value;for(const h of this._getElementsByName(c.target.name)){const d=u&&h.id===i;h.domElement&&(h.domElement.checked=d),e.setValue(h.id,{value:d})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class z0 extends ku{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class B0 extends gn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");un.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=pi;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",u=>{const h=this.data.defaultFieldValue;for(const d of r.options)d.selected=d.value===h});for(const u of this.data.options){const h=document.createElement("option");h.textContent=u.displayValue,h.value=u.exportValue,i.value.includes(u.exportValue)&&(h.setAttribute("selected",!0),s=!1),r.append(h)}let a=null;if(s){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),r.prepend(u),a=()=>{u.remove(),r.removeEventListener("input",a),a=null},r.addEventListener("input",a)}const o=u=>{const h=u?"value":"textContent",{options:d,multiple:f}=r;return f?Array.prototype.filter.call(d,g=>g.selected).map(g=>g[h]):d.selectedIndex===-1?null:d[d.selectedIndex][h]};let l=o(!1);const c=u=>{const h=u.target.options;return Array.prototype.map.call(h,d=>({displayValue:d.textContent,exportValue:d.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",u=>{const h={value(d){a?.();const f=d.detail.value,g=new Set(Array.isArray(f)?f:[f]);for(const m of r.options)m.selected=g.has(m.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(d){r.multiple=!0},remove(d){const f=r.options,g=d.detail.remove;f[g].selected=!1,r.remove(g),f.length>0&&Array.prototype.findIndex.call(f,b=>b.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},clear(d){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(d){const{index:f,displayValue:g,exportValue:m}=d.detail.insert,b=r.children[f],y=document.createElement("option");y.textContent=g,y.value=m,b?b.before(y):r.append(y),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},items(d){const{items:f}=d.detail;for(;r.length!==0;)r.remove(0);for(const g of f){const{displayValue:m,exportValue:b}=g,y=document.createElement("option");y.textContent=m,y.value=b,r.append(y)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(d)}),l=o(!1)},indices(d){const f=new Set(d.detail.indices);for(const g of d.target.options)g.selected=f.has(g.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(d){d.target.disabled=!d.detail.editable}};this._dispatchEventFromSandbox(h,u)}),r.addEventListener("input",u=>{const h=o(!0),d=o(!1);e.setValue(t,{value:h}),u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:d,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):r.addEventListener("input",function(u){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Ss extends Re{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:Re._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new H0({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${Js}${i}`).join(",")),this.container}}class H0{#e=this.#F.bind(this);#t=this.#T.bind(this);#n=this.#k.bind(this);#i=this.#v.bind(this);#s=null;#r=null;#l=null;#c=null;#u=null;#o=null;#h=null;#a=!1;#d=null;#p=null;#f=null;#y=null;#m=null;#g=null;#b=!1;constructor({container:e,color:t,elements:i,titleObj:r,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:c,parentRect:u,open:h}){this.#r=e,this.#m=r,this.#l=a,this.#y=o,this.#o=l,this.#s=t,this.#f=c,this.#h=u,this.#u=i,this.#c=au.toDateObject(s),this.trigger=i.flatMap(d=>d.getElementsToTriggerPopup());for(const d of this.trigger)d.addEventListener("click",this.#i),d.addEventListener("mouseenter",this.#n),d.addEventListener("mouseleave",this.#t),d.classList.add("popupTriggerArea");for(const d of i)d.container?.addEventListener("keydown",this.#e);this.#r.hidden=!0,h&&this.#v()}render(){if(this.#d)return;const e=this.#d=document.createElement("div");if(e.className="popup",this.#s){const s=e.style.outlineColor=K.makeHexColor(...this.#s);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:e.style.backgroundColor=K.makeHexColor(...this.#s.map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=this.#m,e.append(t),this.#c){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),t.append(s)}const r=this.#w;if(r)Su.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#l);e.append(s)}this.#r.append(e)}get#w(){const e=this.#y,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#y.html||null}get#E(){return this.#w?.attributes?.style?.fontSize||0}get#_(){return this.#w?.attributes?.style?.color||null}#S(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:this.#_,fontSize:this.#E?`calc(${this.#E}px * var(--scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:r});return i}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let s=0,a=r.length;s<a;++s){const o=r[s];i.append(document.createTextNode(o)),s<a-1&&i.append(document.createElement("br"))}return i}#F(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#a)&&this.#v()}updateEdited({rect:e,popupContent:t}){this.#g||={contentsObj:this.#l,richText:this.#y},e&&(this.#p=null),t&&(this.#y=this.#S(t),this.#l=null),this.#d?.remove(),this.#d=null}resetEdited(){this.#g&&({contentsObj:this.#l,richText:this.#y}=this.#g,this.#g=null,this.#d?.remove(),this.#d=null,this.#p=null)}#C(){if(this.#p!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:r,pageY:s}}}=this.#o;let a=!!this.#h,o=a?this.#h:this.#f;for(const g of this.#u)if(!o||K.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const l=K.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),u=a?o[2]-o[0]+5:0,h=l[0]+u,d=l[1];this.#p=[100*(h-r)/t,100*(d-s)/i];const{style:f}=this.#r;f.left=`${this.#p[0]}%`,f.top=`${this.#p[1]}%`}#v(){this.#a=!this.#a,this.#a?(this.#k(),this.#r.addEventListener("click",this.#i),this.#r.addEventListener("keydown",this.#e)):(this.#T(),this.#r.removeEventListener("click",this.#i),this.#r.removeEventListener("keydown",this.#e))}#k(){this.#d||this.render(),this.isVisible?this.#a&&this.#r.classList.add("focused"):(this.#C(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#T(){this.#r.classList.remove("focused"),!(this.#a||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#b=this.isVisible,this.#b&&(this.#r.hidden=!0)}maybeShow(){this.#b&&(this.#d||this.#k(),this.#b=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class Cu extends Re{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=oe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class U0 extends Re{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:i}=Ft(e.rect),r=this.svgFactory.create(t,i,!0),s=this.#e=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),r.append(s),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class $0 extends Re{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:i}=Ft(e.rect),r=this.svgFactory.create(t,i,!0),s=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",s/2),a.setAttribute("y",s/2),a.setAttribute("width",t-s),a.setAttribute("height",i-s),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class q0 extends Re{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:i}=Ft(e.rect),r=this.svgFactory.create(t,i,!0),s=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",t/2),a.setAttribute("cy",i/2),a.setAttribute("rx",t/2-s/2),a.setAttribute("ry",i/2-s/2),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Tu extends Re{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:i,popupRef:r}}=this;if(!t)return this.container;const{width:s,height:a}=Ft(e),o=this.svgFactory.create(s,a,!0);let l=[];for(let u=0,h=t.length;u<h;u+=2){const d=t[u]-e[0],f=e[3]-t[u+1];l.push(`${d},${f}`)}l=l.join(" ");const c=this.#e=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",l),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class V0 extends Tu{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class W0 extends Re{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class da extends Re{#e=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?oe.HIGHLIGHT:oe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,inkLists:t,borderStyle:i,popupRef:r}}=this,{width:s,height:a}=Ft(e),o=this.svgFactory.create(s,a,!0);for(const l of t){let c=[];for(let h=0,d=l.length;h<d;h+=2){const f=l[h]-e[0],g=e[3]-l[h+1];c.push(`${f},${g}`)}c=c.join(" ");const u=this.svgFactory.createElement(this.svgElementName);this.#e.push(u),u.setAttribute("points",c),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),o.append(u)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(o),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Pu extends Re{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=oe.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class G0 extends Re{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class X0 extends Re{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Y0 extends Re{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Ru extends Re{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=oe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class K0 extends Re{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let i;t.hasAppearance||t.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#t.bind(this)),this.#e=i;const{isMac:r}=Qe.platform;return e.addEventListener("keydown",s=>{s.key==="Enter"&&(r?s.metaKey:s.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let Q0=class{#e=null;#t=null;#n=new Map;#i=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:r,page:s,viewport:a,structTreeLayer:o}){this.div=e,this.#e=t,this.#t=i,this.#i=o||null,this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#n.size>0}async#s(e,t){const i=e.firstChild||e,r=i.id=`${Js}${t}`,s=await this.#i?.getAriaAttributes(r);if(s)for(const[a,o]of s)i.setAttribute(a,o);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,i,!1)}async render(e){const{annotations:t}=e,i=this.div;cn(i,this.viewport);const r=new Map,s={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new ha,annotationStorage:e.annotationStorage||new ra,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const o=a.annotationType===Fe.POPUP;if(o){const u=r.get(a.id);if(!u)continue;s.elements=u}else{const{width:u,height:h}=Ft(a.rect);if(u<=0||h<=0)continue}s.data=a;const l=M0.create(s);if(!l.isRenderable)continue;if(!o&&a.popupRef){const u=r.get(a.popupRef);u?u.push(l):r.set(a.popupRef,[l])}const c=l.render();a.hidden&&(c.style.visibility="hidden"),await this.#s(c,a.id),l._isEditable&&(this.#n.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#r()}update({viewport:e}){const t=this.div;this.viewport=e,cn(t,{rotation:e.rotation}),this.#r(),t.hidden=!1}#r(){if(!this.#t)return;const e=this.div;for(const[t,i]of this.#t){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:s}=r;s?s.nodeName==="CANVAS"?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):r.append(i)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}};const Ti=/\r\n?|\n/g;class Oe extends ee{#e;#t="";#n=`${this.id}-editor`;#i=null;#s;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Oe.prototype,t=s=>s.isEmpty(),i=qt.TRANSLATE_SMALL,r=qt.TRANSLATE_BIG;return fe(this,"_keyboardManager",new fi([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}static _type="freetext";static _editorType=oe.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||Oe._defaultColor||ee._defaultLineColor,this.#s=e.fontSize||Oe._defaultFontSize}static initialize(e,t){ee.initialize(e,t);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case te.FREETEXT_SIZE:Oe._defaultFontSize=t;break;case te.FREETEXT_COLOR:Oe._defaultColor=t;break}}updateParams(e,t){switch(e){case te.FREETEXT_SIZE:this.#r(t);break;case te.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[te.FREETEXT_SIZE,Oe._defaultFontSize],[te.FREETEXT_COLOR,Oe._defaultColor||ee._defaultLineColor]]}get propertiesToUpdate(){return[[te.FREETEXT_SIZE,this.#s],[te.FREETEXT_COLOR,this.#e]]}#r(e){const t=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#s)*this.parentScale),this.#s=r,this.#u()},i=this.#s;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){const t=r=>{this.#e=this.editorDiv.style.color=r},i=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Oe._internalPadding*e,-(Oe._internalPadding+this.#s)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(oe.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#c(){const e=[];this.editorDiv.normalize();let t=null;for(const i of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(e.push(Oe.#o(i)),t=i);return e.join(`
`)}#u(){const[e,t]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:s}=this,a=s.style.display,o=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",r.div.append(this.div),i=s.getBoundingClientRect(),s.remove(),s.style.display=a,s.classList.toggle("hidden",o)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/t):(this.width=i.height/e,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#c().trimEnd();if(e===t)return;const i=r=>{if(this.#t=r,!r){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(e)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Oe._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#s}px * var(--scale-factor))`,i.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Vi(this,this.div,["dblclick","keydown"]),this.width){const[r,s]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[o,l]=this.getInitialTranslation();[o,l]=this.pageTranslationToScreen(o,l);const[c,u]=this.pageDimensions,[h,d]=this.pageTranslation;let f,g;switch(this.rotation){case 0:f=e+(a[0]-h)/c,g=t+this.height-(a[1]-d)/u;break;case 90:f=e+(a[0]-h)/c,g=t-(a[1]-d)/u,[o,l]=[l,-o];break;case 180:f=e-this.width+(a[0]-h)/c,g=t-(a[1]-d)/u,[o,l]=[-o,-l];break;case 270:f=e+(a[0]-h-this.height*u)/c,g=t+(a[1]-d-this.width*c)/u,[o,l]=[-l,o];break}this.setAt(f*r,g*s,o,l)}else this.setAt(e*r,t*s,this.width*r,this.height*s);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#o(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Ti,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:i}=t;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const r=Oe.#d(t.getData("text")||"").replaceAll(Ti,`
`);if(!r)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const a=s.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:o,startOffset:l}=a,c=[],u=[];if(o.nodeType===Node.TEXT_NODE){const f=o.parentElement;if(u.push(o.nodeValue.slice(l).replaceAll(Ti,"")),f!==this.editorDiv){let g=c;for(const m of this.editorDiv.childNodes){if(m===f){g=u;continue}g.push(Oe.#o(m))}}c.push(o.nodeValue.slice(0,l).replaceAll(Ti,""))}else if(o===this.editorDiv){let f=c,g=0;for(const m of this.editorDiv.childNodes)g++===l&&(f=u),f.push(Oe.#o(m))}this.#t=`${c.join(`
`)}${r}${u.join(`
`)}`,this.#h();const h=new Range;let d=c.reduce((f,g)=>f+g.length,0);for(const{firstChild:f}of this.editorDiv.childNodes)if(f.nodeType===Node.TEXT_NODE){const g=f.nodeValue.length;if(d<=g){h.setStart(f,d),h.setEnd(f,d);break}d-=g}s.removeAllRanges(),s.addRange(h)}#h(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#a(){return this.#t.replaceAll(" "," ")}static#d(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,i){let r=null;if(e instanceof Cu){const{data:{defaultAppearanceData:{fontSize:a,fontColor:o},rect:l,rotation:c,id:u,popupRef:h},textContent:d,textPosition:f,parent:{page:{pageNumber:g}}}=e;if(!d||d.length===0)return null;r=e={annotationType:oe.FREETEXT,color:Array.from(o),fontSize:a,value:d.join(`
`),position:f,pageIndex:g-1,rect:l.slice(0),rotation:c,id:u,deleted:!1,popupRef:h}}const s=await super.deserialize(e,t,i);return s.#s=e.fontSize,s.#e=K.makeHexColor(...e.color),s.#t=Oe.#d(e.value),s.annotationElementId=e.id||null,s._initialData=r,s}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Oe._internalPadding*this.parentScale,i=this.getRect(t,t),r=ee._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),s={annotationType:oe.FREETEXT,color:r,fontSize:this.#s,value:this.#a(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?s:this.annotationElementId&&!this.#p(s)?null:(s.id=this.annotationElementId,s)}#p(e){const{value:t,fontSize:i,color:r,pageIndex:s}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==i||e.color.some((a,o)=>a!==r[o])||e.pageIndex!==s}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:i}=t;i.fontSize=`calc(${this.#s}px * var(--scale-factor))`,i.color=this.#e,t.replaceChildren();for(const s of this.#t.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),t.append(a)}const r=Oe._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class Iu{toSVGPath(){ke("Abstract method `toSVGPath` must be implemented.")}get box(){ke("Abstract getter `box` must be implemented.")}serialize(e,t){ke("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){ke("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){ke("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}}class nn{#e;#t=[];#n;#i;#s=[];#r=new Float64Array(18);#l;#c;#u;#o;#h;#a;#d=[];static#p=8;static#f=2;static#y=nn.#p+nn.#f;constructor({x:e,y:t},i,r,s,a,o=0){this.#e=i,this.#a=s*r,this.#i=a,this.#r.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=o,this.#o=nn.#p*r,this.#u=nn.#y*r,this.#h=r,this.#d.push(e,t)}isEmpty(){return isNaN(this.#r[8])}#m(){const e=this.#r.subarray(4,6),t=this.#r.subarray(16,18),[i,r,s,a]=this.#e;return[(this.#l+(e[0]-t[0])/2-i)/s,(this.#c+(e[1]-t[1])/2-r)/a,(this.#l+(t[0]-e[0])/2-i)/s,(this.#c+(t[1]-e[1])/2-r)/a]}add({x:e,y:t}){this.#l=e,this.#c=t;const[i,r,s,a]=this.#e;let[o,l,c,u]=this.#r.subarray(8,12);const h=e-c,d=t-u,f=Math.hypot(h,d);if(f<this.#u)return!1;const g=f-this.#o,m=g/f,b=m*h,y=m*d;let x=o,A=l;o=c,l=u,c+=b,u+=y,this.#d?.push(e,t);const k=-y/g,E=b/g,_=k*this.#a,P=E*this.#a;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([c+_,u+P],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([c-_,u-P],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([o+_,l+P],2),this.#s.push(NaN,NaN,NaN,NaN,(o+_-i)/s,(l+P-r)/a),this.#r.set([o-_,l-P],14),this.#t.push(NaN,NaN,NaN,NaN,(o-_-i)/s,(l-P-r)/a)),this.#r.set([x,A,o,l,c,u],6),!this.isEmpty()):(this.#r.set([x,A,o,l,c,u],6),Math.abs(Math.atan2(A-l,x-o)-Math.atan2(y,b))<Math.PI/2?([o,l,c,u]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((o+c)/2-i)/s,((l+u)/2-r)/a),[o,l,x,A]=this.#r.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((x+o)/2-i)/s,((A+l)/2-r)/a),!0):([x,A,o,l,c,u]=this.#r.subarray(0,6),this.#s.push(((x+5*o)/6-i)/s,((A+5*l)/6-r)/a,((5*o+c)/6-i)/s,((5*l+u)/6-r)/a,((o+c)/2-i)/s,((l+u)/2-r)/a),[c,u,o,l,x,A]=this.#r.subarray(12,18),this.#t.push(((x+5*o)/6-i)/s,((A+5*l)/6-r)/a,((5*o+c)/6-i)/s,((5*l+u)/6-r)/a,((o+c)/2-i)/s,((l+u)/2-r)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#s,t=this.#t;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#g();const i=[];i.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);this.#w(i);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return this.#b(i),i.join(" ")}#g(){const[e,t,i,r]=this.#e,[s,a,o,l]=this.#m();return`M${(this.#r[2]-e)/i} ${(this.#r[3]-t)/r} L${(this.#r[4]-e)/i} ${(this.#r[5]-t)/r} L${s} ${a} L${o} ${l} L${(this.#r[16]-e)/i} ${(this.#r[17]-t)/r} L${(this.#r[14]-e)/i} ${(this.#r[15]-t)/r} Z`}#b(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#w(e){const[t,i,r,s]=this.#e,a=this.#r.subarray(4,6),o=this.#r.subarray(16,18),[l,c,u,h]=this.#m();e.push(`L${(a[0]-t)/r} ${(a[1]-i)/s} L${l} ${c} L${u} ${h} L${(o[0]-t)/r} ${(o[1]-i)/s}`)}newFreeDrawOutline(e,t,i,r,s,a){return new Lu(e,t,i,r,s,a)}getOutlines(){const e=this.#s,t=this.#t,i=this.#r,[r,s,a,o]=this.#e,l=new Float64Array((this.#d?.length??0)+2);for(let h=0,d=l.length-2;h<d;h+=2)l[h]=(this.#d[h]-r)/a,l[h+1]=(this.#d[h+1]-s)/o;if(l[l.length-2]=(this.#l-r)/a,l[l.length-1]=(this.#c-s)/o,isNaN(i[6])&&!this.isEmpty())return this.#E(l);const c=new Float64Array(this.#s.length+24+this.#t.length);let u=e.length;for(let h=0;h<u;h+=2){if(isNaN(e[h])){c[h]=c[h+1]=NaN;continue}c[h]=e[h],c[h+1]=e[h+1]}u=this.#S(c,u);for(let h=t.length-6;h>=6;h-=6)for(let d=0;d<6;d+=2){if(isNaN(t[h+d])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=t[h+d],c[u+1]=t[h+d+1],u+=2}return this.#_(c,u),this.newFreeDrawOutline(c,l,this.#e,this.#h,this.#n,this.#i)}#E(e){const t=this.#r,[i,r,s,a]=this.#e,[o,l,c,u]=this.#m(),h=new Float64Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-i)/s,(t[3]-r)/a,NaN,NaN,NaN,NaN,(t[4]-i)/s,(t[5]-r)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(t[16]-i)/s,(t[17]-r)/a,NaN,NaN,NaN,NaN,(t[14]-i)/s,(t[15]-r)/a],0),this.newFreeDrawOutline(h,e,this.#e,this.#h,this.#n,this.#i)}#_(e,t){const i=this.#t;return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6}#S(e,t){const i=this.#r.subarray(4,6),r=this.#r.subarray(16,18),[s,a,o,l]=this.#e,[c,u,h,d]=this.#m();return e.set([NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l],t),t+=24}}class Lu extends Iu{#e;#t=null;#n;#i;#s;#r;#l;constructor(e,t,i,r,s,a){super(),this.#l=e,this.#s=t,this.#e=i,this.#r=r,this.#n=s,this.#i=a,this.#o(a);const{x:o,y:l,width:c,height:u}=this.#t;for(let h=0,d=e.length;h<d;h+=2)e[h]=(e[h]-o)/c,e[h+1]=(e[h+1]-l)/u;for(let h=0,d=t.length;h<d;h+=2)t[h]=(t[h]-o)/c,t[h+1]=(t[h+1]-l)/u}toSVGPath(){const e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,i=this.#l.length;t<i;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,i,r],s){const a=i-e,o=r-t;let l,c;switch(s){case 0:l=this.#c(this.#l,e,r,a,-o),c=this.#c(this.#s,e,r,a,-o);break;case 90:l=this.#u(this.#l,e,t,a,o),c=this.#u(this.#s,e,t,a,o);break;case 180:l=this.#c(this.#l,i,t,-a,o),c=this.#c(this.#s,i,t,-a,o);break;case 270:l=this.#u(this.#l,i,r,-a,-o),c=this.#u(this.#s,i,r,-a,-o);break}return{outline:Array.from(l),points:[Array.from(c)]}}#c(e,t,i,r,s){const a=new Float64Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*r,a[o+1]=i+e[o+1]*s;return a}#u(e,t,i,r,s){const a=new Float64Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*r,a[o+1]=i+e[o]*s;return a}#o(e){const t=this.#l;let i=t[4],r=t[5],s=i,a=r,o=i,l=r,c=i,u=r;const h=e?Math.max:Math.min;for(let b=6,y=t.length;b<y;b+=6){if(isNaN(t[b]))s=Math.min(s,t[b+4]),a=Math.min(a,t[b+5]),o=Math.max(o,t[b+4]),l=Math.max(l,t[b+5]),u<t[b+5]?(c=t[b+4],u=t[b+5]):u===t[b+5]&&(c=h(c,t[b+4]));else{const x=K.bezierBoundingBox(i,r,...t.slice(b,b+6));s=Math.min(s,x[0]),a=Math.min(a,x[1]),o=Math.max(o,x[2]),l=Math.max(l,x[3]),u<x[3]?(c=x[2],u=x[3]):u===x[3]&&(c=h(c,x[2]))}i=t[b+4],r=t[b+5]}const d=s-this.#n,f=a-this.#n,g=o-s+2*this.#n,m=l-a+2*this.#n;this.#t={x:d,y:f,width:g,height:m,lastPoint:[c,u]}}get box(){return this.#t}newOutliner(e,t,i,r,s,a=0){return new nn(e,t,i,r,s,a)}getNewOutline(e,t){const{x:i,y:r,width:s,height:a}=this.#t,[o,l,c,u]=this.#e,h=s*c,d=a*u,f=i*c+o,g=r*u+l,m=this.newOutliner({x:this.#s[0]*h+f,y:this.#s[1]*d+g},this.#e,this.#r,e,this.#i,t??this.#n);for(let b=2;b<this.#s.length;b+=2)m.add({x:this.#s[b]*h+f,y:this.#s[b+1]*d+g});return m.getOutlines()}get mustRemoveSelfIntersections(){return!0}}class yl{#e;#t=[];#n=[];constructor(e,t=0,i=0,r=!0){let s=1/0,a=-1/0,o=1/0,l=-1/0;const c=10**-4;for(const{x:b,y,width:x,height:A}of e){const k=Math.floor((b-t)/c)*c,E=Math.ceil((b+x+t)/c)*c,_=Math.floor((y-t)/c)*c,P=Math.ceil((y+A+t)/c)*c,D=[k,_,P,!0],O=[E,_,P,!1];this.#t.push(D,O),s=Math.min(s,k),a=Math.max(a,E),o=Math.min(o,_),l=Math.max(l,P)}const u=a-s+2*i,h=l-o+2*i,d=s-i,f=o-i,g=this.#t.at(r?-1:-2),m=[g[0],g[2]];for(const b of this.#t){const[y,x,A]=b;b[0]=(y-d)/u,b[1]=(x-f)/h,b[2]=(A-f)/h}this.#e={x:d,y:f,width:u,height:h,lastPoint:m}}getOutlines(){this.#t.sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of this.#t)t[3]?(e.push(...this.#c(t)),this.#r(t)):(this.#l(t),e.push(...this.#c(t)));return this.#i(e)}#i(e){const t=[],i=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const r=[];let s;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,u,h]=a;i.delete(a);let d=o,f=l;for(s=[o,c],r.push(s);;){let g;if(i.has(u))g=u;else if(i.has(h))g=h;else break;i.delete(g),[o,l,c,u,h]=g,d!==o&&(s.push(d,f,o,f===l?l:c),d=o),f=f===l?c:l}s.push(d,f)}return new J0(r,this.#e)}#s(e){const t=this.#n;let i=0,r=t.length-1;for(;i<=r;){const s=i+r>>1,a=t[s][0];if(a===e)return s;a<e?i=s+1:r=s-1}return r+1}#r([,e,t]){const i=this.#s(e);this.#n.splice(i,0,[e,t])}#l([,e,t]){const i=this.#s(e);for(let r=i;r<this.#n.length;r++){const[s,a]=this.#n[r];if(s!==e)break;if(s===e&&a===t){this.#n.splice(r,1);return}}for(let r=i-1;r>=0;r--){const[s,a]=this.#n[r];if(s!==e)break;if(s===e&&a===t){this.#n.splice(r,1);return}}}#c(e){const[t,i,r]=e,s=[[t,i,r]],a=this.#s(r);for(let o=0;o<a;o++){const[l,c]=this.#n[o];for(let u=0,h=s.length;u<h;u++){const[,d,f]=s[u];if(!(c<=d||f<=l)){if(d>=l){if(f>c)s[u][1]=c;else{if(h===1)return[];s.splice(u,1),u--,h--}continue}s[u][2]=l,f>c&&s.push([t,c,f])}}}return s}}class J0 extends Iu{#e;#t;constructor(e,t){super(),this.#t=e,this.#e=t}toSVGPath(){const e=[];for(const t of this.#t){let[i,r]=t;e.push(`M${i} ${r}`);for(let s=2;s<t.length;s+=2){const a=t[s],o=t[s+1];a===i?(e.push(`V${o}`),r=o):o===r&&(e.push(`H${a}`),i=a)}e.push("Z")}return e.join(" ")}serialize([e,t,i,r],s){const a=[],o=i-e,l=r-t;for(const c of this.#t){const u=new Array(c.length);for(let h=0;h<c.length;h+=2)u[h]=e+c[h]*o,u[h+1]=r-c[h+1]*l;a.push(u)}return a}get box(){return this.#e}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}class ks extends nn{newFreeDrawOutline(e,t,i,r,s,a){return new Z0(e,t,i,r,s,a)}get classNamesForDrawing(){return["highlight","free"]}}class Z0 extends Lu{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(e,t,i,r,s,a=0){return new ks(e,t,i,r,s,a)}}class dt{#e=null;#t=null;#n;#i=null;#s=!1;#r=!1;#l=null;#c;#u=null;#o=null;#h;static#a=null;static get _keyboardManager(){return fe(this,"_keyboardManager",new fi([[["Escape","mac+Escape"],dt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],dt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],dt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],dt.prototype._moveToPrevious],[["Home","mac+Home"],dt.prototype._moveToBeginning],[["End","mac+End"],dt.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#r=!1,this.#h=te.HIGHLIGHT_COLOR,this.#l=e):(this.#r=!0,this.#h=te.HIGHLIGHT_DEFAULT_COLOR),this.#o=e?._uiManager||t,this.#c=this.#o._eventBus,this.#n=e?.color||this.#o?.highlightColors.values().next().value||"#FFFF98",dt.#a||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#o._signal;e.addEventListener("click",this.#y.bind(this),{signal:t}),e.addEventListener("keydown",this.#f.bind(this),{signal:t});const i=this.#t=document.createElement("span");return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=this.#n,e.append(i),e}renderMainDropdown(){const e=this.#i=this.#d();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#d(){const e=document.createElement("div"),t=this.#o._signal;e.addEventListener("contextmenu",pt,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,r]of this.#o.highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",r),s.title=i,s.setAttribute("data-l10n-id",dt.#a[i]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=r,s.setAttribute("aria-selected",r===this.#n),s.addEventListener("click",this.#p.bind(this,r),{signal:t}),e.append(s)}return e.addEventListener("keydown",this.#f.bind(this),{signal:t}),e}#p(e,t){t.stopPropagation(),this.#c.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#y(e);return}const t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#g){this.#y(e);return}if(e.target===this.#e){this.#i.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#i?.firstChild||e.target===this.#e){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#y(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#g){this.#y(e);return}this.#i.firstChild?.focus()}_moveToEnd(e){if(!this.#g){this.#y(e);return}this.#i.lastChild?.focus()}#f(e){dt._keyboardManager.exec(this,e)}#y(e){if(this.#g){this.hideDropdown();return}if(this.#s=e.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#o.combinedSignal(this.#u)})),this.#i){this.#i.classList.remove("hidden");return}const t=this.#i=this.#d();this.#e.append(t)}#m(e){this.#i?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#u?.abort(),this.#u=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#g){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#i)return;const t=this.#o.highlightColors.values();for(const i of this.#i.children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#i?.remove(),this.#i=null}}class Pe extends ee{#e=null;#t=0;#n;#i=null;#s=null;#r=null;#l=null;#c=0;#u=null;#o=null;#h=null;#a=!1;#d=null;#p;#f=null;#y="";#m;#g="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=oe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Pe.prototype;return fe(this,"_keyboardManager",new fi([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Pe._defaultColor,this.#m=e.thickness||Pe._defaultThickness,this.#p=e.opacity||Pe._defaultOpacity,this.#n=e.boxes||null,this.#g=e.methodOfCreation||"",this.#y=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#a=!0,this.#w(e),this.#C()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#c=e.focusOffset,this.#b(),this.#C(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#a?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#g}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#b(){const e=new yl(this.#n,.001);this.#o=e.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#o.box;const t=new yl(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=t.getOutlines();const{lastPoint:i}=this.#r.box;this.#d=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#w({highlightOutlines:e,highlightId:t,clipPathId:i}){this.#o=e;const r=1.5;if(this.#r=e.getNewOutline(this.#m/2+r,.0025),t>=0)this.#h=t,this.#i=i,this.parent.drawLayer.finalizeLine(t,e),this.#f=this.parent.drawLayer.drawOutline(this.#r);else if(this.parent){const u=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#h,e),this.parent.drawLayer.updateBox(this.#h,Pe.#v(this.#o.box,(u-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#f,this.#r),this.parent.drawLayer.updateBox(this.#f,Pe.#v(this.#r.box,u))}const{x:s,y:a,width:o,height:l}=e.box;switch(this.rotation){case 0:this.x=s,this.y=a,this.width=o,this.height=l;break;case 90:{const[u,h]=this.parentDimensions;this.x=a,this.y=1-s,this.width=o*h/u,this.height=l*u/h;break}case 180:this.x=1-s,this.y=1-a,this.width=o,this.height=l;break;case 270:{const[u,h]=this.parentDimensions;this.x=1-a,this.y=s,this.width=o*h/u,this.height=l*u/h;break}}const{lastPoint:c}=this.#r.box;this.#d=[(c[0]-s)/o,(c[1]-a)/l]}static initialize(e,t){ee.initialize(e,t),Pe._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case te.HIGHLIGHT_DEFAULT_COLOR:Pe._defaultColor=t;break;case te.HIGHLIGHT_THICKNESS:Pe._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#d}updateParams(e,t){switch(e){case te.HIGHLIGHT_COLOR:this.#E(t);break;case te.HIGHLIGHT_THICKNESS:this.#_(t);break}}static get defaultPropertiesToUpdate(){return[[te.HIGHLIGHT_DEFAULT_COLOR,Pe._defaultColor],[te.HIGHLIGHT_THICKNESS,Pe._defaultThickness]]}get propertiesToUpdate(){return[[te.HIGHLIGHT_COLOR,this.color||Pe._defaultColor],[te.HIGHLIGHT_THICKNESS,this.#m||Pe._defaultThickness],[te.HIGHLIGHT_FREE,this.#a]]}#E(e){const t=(s,a)=>{this.color=s,this.parent?.drawLayer.changeColor(this.#h,s),this.#s?.updateColor(s),this.#p=a,this.parent?.drawLayer.changeOpacity(this.#h,a)},i=this.color,r=this.#p;this.addCommands({cmd:t.bind(this,e,Pe._defaultOpacity),undo:t.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#_(e){const t=this.#m,i=r=>{this.#m=r,this.#S(r)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#s=new dt({editor:this}),e.addColorPicker(this.#s)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#P())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#P())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#F(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#C(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#F():e&&(this.#C(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#S(e){if(!this.#a)return;this.#w({highlightOutlines:this.#o.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,i]=this.parentDimensions;this.setDims(this.width*t,this.height*i)}#F(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#f),this.#f=null)}#C(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#i}=e.drawLayer.draw(this.#o,this.color,this.#p),this.#f=e.drawLayer.drawOutline(this.#r),this.#u&&(this.#u.style.clipPath=this.#i))}static#v({x:e,y:t,width:i,height:r},s){switch(s){case 90:return{x:1-t-r,y:e,width:r,height:i};case 180:return{x:1-e-i,y:1-t-r,width:i,height:r};case 270:return{x:t,y:1-e-i,width:r,height:i}}return{x:e,y:t,width:i,height:r}}rotate(e){const{drawLayer:t}=this.parent;let i;this.#a?(e=(e-this.rotation+360)%360,i=Pe.#v(this.#o.box,e)):i=Pe.#v(this,e),t.rotate(this.#h,e),t.rotate(this.#f,e),t.updateBox(this.#h,i),t.updateBox(this.#f,Pe.#v(this.#r.box,e))}render(){if(this.div)return this.div;const e=super.render();this.#y&&(e.setAttribute("aria-label",this.#y),e.setAttribute("role","mark")),this.#a?e.classList.add("free"):this.div.addEventListener("keydown",this.#k.bind(this),{signal:this._uiManager._signal});const t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#i;const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),Vi(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(this.#f,"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(this.#f,"hovered")}#k(e){Pe._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#c)}select(){super.select(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"hovered"),this.parent?.drawLayer.addClass(this.#f,"selected"))}unselect(){super.unselect(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"selected"),this.#a||this.#T(!1))}get _mustFixPosition(){return!this.#a}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(this.#h,e),this.parent.drawLayer.show(this.#f,e))}#P(){return this.#a?this.rotation:0}#L(){if(this.#a)return null;const[e,t]=this.pageDimensions,[i,r]=this.pageTranslation,s=this.#n,a=new Float32Array(s.length*8);let o=0;for(const{x:l,y:c,width:u,height:h}of s){const d=l*e+i,f=(1-c-h)*t+r;a[o]=a[o+4]=d,a[o+1]=a[o+3]=f,a[o+2]=a[o+6]=d+u*e,a[o+5]=a[o+7]=f+h*t,o+=8}return a}#A(e){return this.#o.serialize(e,this.#P())}static startHighlighting(e,t,{target:i,x:r,y:s}){const{x:a,y:o,width:l,height:c}=i.getBoundingClientRect(),u=new AbortController,h=e.combinedSignal(u),d=g=>{g.preventDefault(),g.stopPropagation()},f=g=>{u.abort(),this.#D(e,g)};window.addEventListener("blur",f,{signal:h}),window.addEventListener("pointerup",f,{signal:h}),window.addEventListener("pointerdown",d,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",pt,{signal:h}),i.addEventListener("pointermove",this.#x.bind(this,e),{signal:h}),this._freeHighlight=new ks({x:r,y:s},[a,o,l,c],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static#x(e,t){this._freeHighlight.add(t)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#D(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,i){let r=null;if(e instanceof Pu){const{data:{quadPoints:g,rect:m,rotation:b,id:y,color:x,opacity:A,popupRef:k},parent:{page:{pageNumber:E}}}=e;r=e={annotationType:oe.HIGHLIGHT,color:Array.from(x),opacity:A,quadPoints:g,boxes:null,pageIndex:E-1,rect:m.slice(0),rotation:b,id:y,deleted:!1,popupRef:k}}else if(e instanceof da){const{data:{inkLists:g,rect:m,rotation:b,id:y,color:x,borderStyle:{rawWidth:A},popupRef:k},parent:{page:{pageNumber:E}}}=e;r=e={annotationType:oe.HIGHLIGHT,color:Array.from(x),thickness:A,inkLists:g,boxes:null,pageIndex:E-1,rect:m.slice(0),rotation:b,id:y,deleted:!1,popupRef:k}}const{color:s,quadPoints:a,inkLists:o,opacity:l}=e,c=await super.deserialize(e,t,i);c.color=K.makeHexColor(...s),c.#p=l||1,o&&(c.#m=e.thickness),c.annotationElementId=e.id||null,c._initialData=r;const[u,h]=c.pageDimensions,[d,f]=c.pageTranslation;if(a){const g=c.#n=[];for(let m=0;m<a.length;m+=8)g.push({x:(a[m]-d)/u,y:1-(a[m+1]-f)/h,width:(a[m+2]-a[m])/u,height:(a[m+1]-a[m+5])/h});c.#b(),c.#C(),c.rotate(c.rotation)}else if(o){c.#a=!0;const g=o[0],m={x:g[0]-d,y:h-(g[1]-f)},b=new ks(m,[0,0,u,h],1,c.#m/2,!0,.001);for(let A=0,k=g.length;A<k;A+=2)m.x=g[A]-d,m.y=h-(g[A+1]-f),b.add(m);const{id:y,clipPathId:x}=t.drawLayer.draw(b,c.color,c._defaultOpacity,!0);c.#w({highlightOutlines:b.getOutlines(),highlightId:y,clipPathId:x}),c.#C()}return c}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),i=ee._colorManager.convert(this.color),r={annotationType:oe.HIGHLIGHT,color:i,opacity:this.#p,thickness:this.#m,quadPoints:this.#L(),outlines:this.#A(t),pageIndex:this.pageIndex,rect:t,rotation:this.#P(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#M(r)?null:(r.id=this.annotationElementId,r)}#M(e){const{color:t}=this._initialData;return e.color.some((i,r)=>i!==t[r])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Be extends ee{#e=0;#t=0;#n=null;#i=new Path2D;#s=!1;#r=null;#l=!1;#c=!1;#u=null;#o=null;#h=0;#a=0;#d=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=oe.INK;constructor(e){super({...e,name:"inkEditor"}),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,t){ee.initialize(e,t)}static updateDefaultParams(e,t){switch(e){case te.INK_THICKNESS:Be._defaultThickness=t;break;case te.INK_COLOR:Be._defaultColor=t;break;case te.INK_OPACITY:Be._defaultOpacity=t/100;break}}updateParams(e,t){switch(e){case te.INK_THICKNESS:this.#p(t);break;case te.INK_COLOR:this.#f(t);break;case te.INK_OPACITY:this.#y(t);break}}static get defaultPropertiesToUpdate(){return[[te.INK_THICKNESS,Be._defaultThickness],[te.INK_COLOR,Be._defaultColor||ee._defaultLineColor],[te.INK_OPACITY,Math.round(Be._defaultOpacity*100)]]}get propertiesToUpdate(){return[[te.INK_THICKNESS,this.thickness||Be._defaultThickness],[te.INK_COLOR,this.color||Be._defaultColor||ee._defaultLineColor],[te.INK_OPACITY,Math.round(100*(this.opacity??Be._defaultOpacity))]]}#p(e){const t=r=>{this.thickness=r,this.#R()},i=this.thickness;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#f(e){const t=r=>{this.color=r,this.#v()},i=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#y(e){const t=r=>{this.opacity=r,this.#v()};e/=100;const i=this.opacity;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:te.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#L(),this.#A()),this.isAttachedToDOM||(this.parent.add(this),this.#x()),this.#R()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#n&&(clearTimeout(this.#n),this.#n=null),this.#u?.disconnect(),this.#u=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,t]=this.parentDimensions,i=this.width*e,r=this.height*t;this.setDimensions(i,r)}enableEditMode(){this.#s||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.#k())}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.#T())}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#m(){const{parentRotation:e,parentDimensions:[t,i]}=this;switch(e){case 90:return[0,i,i,t];case 180:return[t,i,t,i];case 270:return[t,0,i,t];default:return[0,0,t,i]}}#g(){const{ctx:e,color:t,opacity:i,thickness:r,parentScale:s,scaleFactor:a}=this;e.lineWidth=r*s/a,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${vv(i)}`}#b(e,t){this.canvas.addEventListener("contextmenu",pt,{signal:this._uiManager._signal}),this.#T(),this.#r=new AbortController;const i=this._uiManager.combinedSignal(this.#r);this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:i}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:i}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:i}),this.isEditing=!0,this.#c||(this.#c=!0,this.#x(),this.thickness||=Be._defaultThickness,this.color||=Be._defaultColor||ee._defaultLineColor,this.opacity??=Be._defaultOpacity),this.currentPath.push([e,t]),this.#l=!1,this.#g(),this.#d=()=>{this.#S(),this.#d&&window.requestAnimationFrame(this.#d)},window.requestAnimationFrame(this.#d)}#w(e,t){const[i,r]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===i&&t===r)return;const s=this.currentPath;let a=this.#i;if(s.push([e,t]),this.#l=!0,s.length<=2){a.moveTo(...s[0]),a.lineTo(e,t);return}s.length===3&&(this.#i=a=new Path2D,a.moveTo(...s[0])),this.#F(a,...s.at(-3),...s.at(-2),e,t)}#E(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);this.#i.lineTo(...e)}#_(e,t){this.#d=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#w(e,t),this.#E();let i;if(this.currentPath.length!==1)i=this.#C();else{const l=[e,t];i=[[l,l.slice(),l.slice(),l]]}const r=this.#i,s=this.currentPath;this.currentPath=[],this.#i=new Path2D;const a=()=>{this.allRawPaths.push(s),this.paths.push(i),this.bezierPath2D.push(r),this._uiManager.rebuild(this)},o=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#L(),this.#A()),this.#R())};this.addCommands({cmd:a,undo:o,mustExec:!0})}#S(){if(!this.#l)return;this.#l=!1;const e=Math.ceil(this.thickness*this.parentScale),t=this.currentPath.slice(-3),i=t.map(a=>a[0]),r=t.map(a=>a[1]);Math.min(...i)-e,Math.max(...i)+e,Math.min(...r)-e,Math.max(...r)+e;const{ctx:s}=this;s.save(),s.clearRect(0,0,this.canvas.width,this.canvas.height);for(const a of this.bezierPath2D)s.stroke(a);s.stroke(this.#i),s.restore()}#F(e,t,i,r,s,a,o){const l=(t+r)/2,c=(i+s)/2,u=(r+a)/2,h=(s+o)/2;e.bezierCurveTo(l+2*(r-l)/3,c+2*(s-c)/3,u+2*(r-u)/3,h+2*(s-h)/3,u,h)}#C(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const t=[];let i,[r,s]=e[0];for(i=1;i<e.length-2;i++){const[d,f]=e[i],[g,m]=e[i+1],b=(d+g)/2,y=(f+m)/2,x=[r+2*(d-r)/3,s+2*(f-s)/3],A=[b+2*(d-b)/3,y+2*(f-y)/3];t.push([[r,s],x,A,[b,y]]),[r,s]=[b,y]}const[a,o]=e[i],[l,c]=e[i+1],u=[r+2*(a-r)/3,s+2*(o-s)/3],h=[l+2*(a-l)/3,c+2*(o-c)/3];return t.push([[r,s],u,h,[l,c]]),t}#v(){if(this.isEmpty()){this.#M();return}this.#g();const{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#M();for(const i of this.bezierPath2D)t.stroke(i)}commit(){this.#s||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#s=!0,this.div.classList.add("disabled"),this.#R(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}#k(){if(this.#o)return;this.#o=new AbortController;const e=this._uiManager.combinedSignal(this.#o);this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})}#T(){this.pointerdownAC?.abort(),this.pointerdownAC=null}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||this.#s||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#b(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#w(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#P(e)}canvasPointerleave(e){this.#P(e)}#P(e){this.#r?.abort(),this.#r=null,this.#k(),this.#n&&clearTimeout(this.#n),this.#n=setTimeout(()=>{this.#n=null,this.canvas.removeEventListener("contextmenu",pt)},10),this.#_(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#L(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#A(){this.#u=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),this.#u.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#u?.disconnect(),this.#u=null},{once:!0})}get isResizable(){return!this.isEmpty()&&this.#s}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,r,s,a]=this.#m();if(this.setAt(i,r,0,0),this.setDims(s,a),this.#L(),this.width){const[o,l]=this.parentDimensions;this.setAspectRatio(this.width*o,this.height*l),this.setAt(e*o,t*l,this.width*o,this.height*l),this.#c=!0,this.#x(),this.setDims(this.width*o,this.height*l),this.#v(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#A(),this.div}#x(){if(!this.#c)return;const[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#M()}setDimensions(e,t){const i=Math.round(e),r=Math.round(t);if(this.#h===i&&this.#a===r)return;this.#h=i,this.#a=r,this.canvas.style.visibility="hidden";const[s,a]=this.parentDimensions;this.width=e/s,this.height=t/a,this.fixAndSetPosition(),this.#s&&this.#D(e,t),this.#x(),this.#v(),this.canvas.style.visibility="visible",this.fixDims()}#D(e,t){const i=this.#H(),r=(e-i)/this.#t,s=(t-i)/this.#e;this.scaleFactor=Math.min(r,s)}#M(){const e=this.#H()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#O(e){const t=new Path2D;for(let i=0,r=e.length;i<r;i++){const[s,a,o,l]=e[i];i===0&&t.moveTo(...s),t.bezierCurveTo(a[0],a[1],o[0],o[1],l[0],l[1])}return t}static#U(e,t,i){const[r,s,a,o]=t;switch(i){case 0:for(let l=0,c=e.length;l<c;l+=2)e[l]+=r,e[l+1]=o-e[l+1];break;case 90:for(let l=0,c=e.length;l<c;l+=2){const u=e[l];e[l]=e[l+1]+r,e[l+1]=u+s}break;case 180:for(let l=0,c=e.length;l<c;l+=2)e[l]=a-e[l],e[l+1]+=s;break;case 270:for(let l=0,c=e.length;l<c;l+=2){const u=e[l];e[l]=a-e[l+1],e[l+1]=o-u}break;default:throw new Error("Invalid rotation")}return e}static#z(e,t,i){const[r,s,a,o]=t;switch(i){case 0:for(let l=0,c=e.length;l<c;l+=2)e[l]-=r,e[l+1]=o-e[l+1];break;case 90:for(let l=0,c=e.length;l<c;l+=2){const u=e[l];e[l]=e[l+1]-s,e[l+1]=u-r}break;case 180:for(let l=0,c=e.length;l<c;l+=2)e[l]=a-e[l],e[l+1]-=s;break;case 270:for(let l=0,c=e.length;l<c;l+=2){const u=e[l];e[l]=o-e[l+1],e[l+1]=a-u}break;default:throw new Error("Invalid rotation")}return e}#N(e,t,i,r){const s=[],a=this.thickness/2,o=e*t+a,l=e*i+a;for(const c of this.paths){const u=[],h=[];for(let d=0,f=c.length;d<f;d++){const[g,m,b,y]=c[d];if(g[0]===y[0]&&g[1]===y[1]&&f===1){const S=e*g[0]+o,R=e*g[1]+l;u.push(S,R),h.push(S,R);break}const x=e*g[0]+o,A=e*g[1]+l,k=e*m[0]+o,E=e*m[1]+l,_=e*b[0]+o,P=e*b[1]+l,D=e*y[0]+o,O=e*y[1]+l;d===0&&(u.push(x,A),h.push(x,A)),u.push(k,E,_,P,D,O),h.push(k,E),d===f-1&&h.push(D,O)}s.push({bezier:Be.#U(u,r,this.rotation),points:Be.#U(h,r,this.rotation)})}return s}#j(){let e=1/0,t=-1/0,i=1/0,r=-1/0;for(const s of this.paths)for(const[a,o,l,c]of s){const u=K.bezierBoundingBox(...a,...o,...l,...c);e=Math.min(e,u[0]),i=Math.min(i,u[1]),t=Math.max(t,u[2]),r=Math.max(r,u[3])}return[e,i,t,r]}#H(){return this.#s?Math.ceil(this.thickness*this.parentScale):0}#R(e=!1){if(this.isEmpty())return;if(!this.#s){this.#v();return}const t=this.#j(),i=this.#H();this.#t=Math.max(ee.MIN_SIZE,t[2]-t[0]),this.#e=Math.max(ee.MIN_SIZE,t[3]-t[1]);const r=Math.ceil(i+this.#t*this.scaleFactor),s=Math.ceil(i+this.#e*this.scaleFactor),[a,o]=this.parentDimensions;this.width=r/a,this.height=s/o,this.setAspectRatio(r,s);const l=this.translationX,c=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#x(),this.#v(),this.#h=r,this.#a=s,this.setDims(r,s);const u=e?i/this.scaleFactor/2:0;this.translate(l-this.translationX-u,c-this.translationY-u)}static async deserialize(e,t,i){if(e instanceof da)return null;const r=await super.deserialize(e,t,i);r.thickness=e.thickness,r.color=K.makeHexColor(...e.color),r.opacity=e.opacity;const[s,a]=r.pageDimensions,o=r.width*s,l=r.height*a,c=r.parentScale,u=e.thickness/2;r.#s=!0,r.#h=Math.round(o),r.#a=Math.round(l);const{paths:h,rect:d,rotation:f}=e;for(let{bezier:m}of h){m=Be.#z(m,d,f);const b=[];r.paths.push(b);let y=c*(m[0]-u),x=c*(m[1]-u);for(let k=2,E=m.length;k<E;k+=6){const _=c*(m[k]-u),P=c*(m[k+1]-u),D=c*(m[k+2]-u),O=c*(m[k+3]-u),S=c*(m[k+4]-u),R=c*(m[k+5]-u);b.push([[y,x],[_,P],[D,O],[S,R]]),y=S,x=R}const A=this.#O(b);r.bezierPath2D.push(A)}const g=r.#j();return r.#t=Math.max(ee.MIN_SIZE,g[2]-g[0]),r.#e=Math.max(ee.MIN_SIZE,g[3]-g[1]),r.#D(o,l),r}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),t=ee._colorManager.convert(this.ctx.strokeStyle);return{annotationType:oe.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#N(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}class fa extends ee{#e=null;#t=null;#n=null;#i=null;#s=null;#r="";#l=null;#c=null;#u=null;#o=!1;#h=!1;static _type="stamp";static _editorType=oe.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#i=e.bitmapUrl,this.#s=e.bitmapFile}static initialize(e,t){ee.initialize(e,t)}static get supportedTypes(){return fe(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return fe(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(oe.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#a(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#o=e.isSvg),e.file&&(this.#r=e.file.name),this.#f()}#d(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:s,height:a}=e||this.copyCanvas(null,null,!0).imageData,o=await i.guess({name:"altText",request:{data:r,width:s,height:a,channels:r.length/(s*a)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");const l=o.output;return await this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}#p(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(i=>this.#a(i,!0)).finally(()=>this.#d());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(i).then(r=>this.#a(r)).finally(()=>this.#d());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(i).then(r=>this.#a(r)).finally(()=>this.#d());return}const e=document.createElement("input");e.type="file",e.accept=fa.supportedTypesStr;const t=this._uiManager._signal;this.#n=new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#a(r)}i()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:t})}).finally(()=>this.#d()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#c?.disconnect(),this.#c=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#p();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#i||this.#s||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#f():this.#p(),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(e*i,t*r,this.width*i,this.height*r)}return this.div}#f(){const{div:e}=this;let{width:t,height:i}=this.#e;const[r,s]=this.pageDimensions,a=.75;if(this.width)t=this.width*r,i=this.height*s;else if(t>a*r||i>a*s){const u=Math.min(a*r/t,a*s/i);t*=u,i*=u}const[o,l]=this.parentDimensions;this.setDims(t*o/r,i*l/s),this._uiManager.enableWaiting(!1);const c=this.#l=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(t,i),this.#w(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&c.setAttribute("aria-label",this.#r)}copyCanvas(e,t,i=!1){e||(e=224);const{width:r,height:s}=this.#e,a=new bs;let o=this.#e,l=r,c=s,u=null;if(t){if(r>t||s>t){const _=Math.min(t/r,t/s);l=Math.floor(r*_),c=Math.floor(s*_)}u=document.createElement("canvas");const d=u.width=Math.ceil(l*a.sx),f=u.height=Math.ceil(c*a.sy);this.#o||(o=this.#m(d,f));const g=u.getContext("2d");g.filter=this._uiManager.hcmFilter;let m="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(m="#8f8f9d",b="#42414d");const y=15,x=y*a.sx,A=y*a.sy,k=new OffscreenCanvas(x*2,A*2),E=k.getContext("2d");E.fillStyle=m,E.fillRect(0,0,x*2,A*2),E.fillStyle=b,E.fillRect(0,0,x,A),E.fillRect(x,A,x,A),g.fillStyle=g.createPattern(k,"repeat"),g.fillRect(0,0,d,f),g.drawImage(o,0,0,o.width,o.height,0,0,d,f)}let h=null;if(i){let d,f;if(a.symmetric&&o.width<e&&o.height<e)d=o.width,f=o.height;else if(o=this.#e,r>e||s>e){const b=Math.min(e/r,e/s);d=Math.floor(r*b),f=Math.floor(s*b),this.#o||(o=this.#m(d,f))}const m=new OffscreenCanvas(d,f).getContext("2d",{willReadFrequently:!0});m.drawImage(o,0,0,o.width,o.height,0,0,d,f),h={width:d,height:f,data:m.getImageData(0,0,d,f).data}}return{canvas:u,width:l,height:c,imageData:h}}#y(e,t){const[i,r]=this.parentDimensions;this.width=e/i,this.height=t/r,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#u!==null&&clearTimeout(this.#u);const s=200;this.#u=setTimeout(()=>{this.#u=null,this.#g(e,t)},s)}#m(e,t){const{width:i,height:r}=this.#e;let s=i,a=r,o=this.#e;for(;s>2*e||a>2*t;){const l=s,c=a;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const u=new OffscreenCanvas(s,a);u.getContext("2d").drawImage(o,0,0,l,c,0,0,s,a),o=u.transferToImageBitmap()}return o}#g(e,t){const i=new bs,r=Math.ceil(e*i.sx),s=Math.ceil(t*i.sy),a=this.#l;if(!a||a.width===r&&a.height===s)return;a.width=r,a.height=s;const o=this.#o?this.#e:this.#m(r,s),l=a.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(o,0,0,o.width,o.height,0,0,r,s)}getImageForAltText(){return this.#l}#b(e){if(e){if(this.#o){const r=this._uiManager.imageManager.getSvgUrl(this.#t);if(r)return r}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#o){const[t,i]=this.pageDimensions,r=Math.round(this.width*t*Dn.PDF_TO_CSS_UNITS),s=Math.round(this.height*i*Dn.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,s);return a.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,r,s),a.transferToImageBitmap()}return structuredClone(this.#e)}#w(){this._uiManager._signal&&(this.#c=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.#y(t.width,t.height)}),this.#c.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#c?.disconnect(),this.#c=null},{once:!0}))}static async deserialize(e,t,i){let r=null;if(e instanceof Ru){const{data:{rect:g,rotation:m,id:b,structParent:y,popupRef:x},container:A,parent:{page:{pageNumber:k}}}=e,E=A.querySelector("canvas"),_=i.imageManager.getFromCanvas(A.id,E);E.remove();const P=(await t._structTree.getAriaAttributes(`${Js}${b}`))?.get("aria-label")||"";r=e={annotationType:oe.STAMP,bitmapId:_.id,bitmap:_.bitmap,pageIndex:k-1,rect:g.slice(0),rotation:m,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:P},isSvg:!1,structParent:y,popupRef:x}}const s=await super.deserialize(e,t,i),{rect:a,bitmap:o,bitmapUrl:l,bitmapId:c,isSvg:u,accessibilityData:h}=e;c&&i.imageManager.isValidId(c)?(s.#t=c,o&&(s.#e=o)):s.#i=l,s.#o=u;const[d,f]=s.pageDimensions;return s.width=(a[2]-a[0])/d,s.height=(a[3]-a[1])/f,s.annotationElementId=e.id||null,h&&(s.altTextData=h),s._initialData=r,s.#h=!!r,s}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:oe.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#o,structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=this.#b(!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:s}=this.serializeAltText(!1);if(!r&&s&&(i.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const o=this.#E(i);if(o.isSame)return null;o.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,t===null)return i;t.stamps||=new Map;const a=this.#o?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:a,serialized:i}),i.bitmap=this.#b(!1);else if(this.#o){const o=t.stamps.get(this.#t);a>o.area&&(o.area=a,o.serialized.bitmap.close(),o.serialized.bitmap=this.#b(!1))}return i}#E(e){const{rect:t,pageIndex:i,accessibilityData:{altText:r}}=this._initialData,s=e.rect.every((l,c)=>Math.abs(l-t[c])<1),a=e.pageIndex===i,o=(e.accessibilityData?.alt||"")===r;return{isSame:s&&a&&o,isSameAltText:o}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class Lt{#e;#t=!1;#n=null;#i=null;#s=null;#r=new Map;#l=!1;#c=!1;#u=!1;#o=null;#h=null;#a;static _initialized=!1;static#d=new Map([Oe,Be,fa,Pe].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:r,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:u}){const h=[...Lt.#d.values()];if(!Lt._initialized){Lt._initialized=!0;for(const d of h)d.initialize(u,e)}e.registerEditorTypes(h),this.#a=e,this.pageIndex=t,this.div=i,this.#e=s,this.#n=a,this.viewport=c,this.#o=l,this.drawLayer=o,this._structTree=r,this.#a.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===oe.NONE}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#g(),e){case oe.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case oe.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case oe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of Lt.#d.values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#o?.div}addInkEditorIfNeeded(e){if(this.#a.getMode()!==oe.INK)return;if(!e){for(const i of this.#r.values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of this.#r.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#a.removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!this.#n)return;const t=this.#n.getEditableAnnotations();for(const i of t){if(i.hide(),this.#a.isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}}disable(){this.#u=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of this.#r.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#n){const r=this.#n.getEditableAnnotations();for(const s of r){const{id:a}=s.data;if(this.#a.isDeletedAnnotationElement(a))continue;let o=t.get(a);if(o){o.resetAnnotationElement(s),o.show(!1),s.show();continue}o=e.get(a),o&&(this.#a.addChangedExistingAnnotation(o),o.renderAnnotationElement(s)&&o.show(!1)),s.show()}}this.#g(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of Lt.#d.values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#u=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#o?.div&&!this.#h){this.#h=new AbortController;const e=this.#a.combinedSignal(this.#h);this.#o.div.addEventListener("pointerdown",this.#p.bind(this),{signal:e}),this.#o.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#o?.div&&this.#h&&(this.#h.abort(),this.#h=null,this.#o.div.classList.remove("highlighting"))}#p(e){this.#a.unselectAll();const{target:t}=e;if(t===this.#o.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#o.div.contains(t)){const{isMac:i}=Qe.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#a.showAllEditors("highlight",!0,!0),this.#o.div.classList.add("free"),this.toggleDrawing(),Pe.startHighlighting(this,this.#a.direction==="ltr",{target:this.#o.div,x:e.x,y:e.y}),this.#o.div.addEventListener("pointerup",()=>{this.#o.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),e.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const e=this.#a.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:e})}disableClick(){this.#i?.abort(),this.#i=null}attach(e){this.#r.set(e.id,e);const{annotationElementId:t}=e;t&&this.#a.isDeletedAnnotationElement(t)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#r.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#u&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1,this.#c||this.addInkEditorIfNeeded(!1)}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),ee.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),this.#a.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#s&&(e._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return this.#a.getId()}get#f(){return Lt.#d.get(this.#a.getMode())}combinedSignal(e){return this.#a.combinedSignal(e)}#y(e){const t=this.#f;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#f?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#a.updateToolbar(e),this.#a.updateMode(e);const{offsetX:i,offsetY:r}=this.#m(),s=this.getNextId(),a=this.#y({parent:this,id:s,x:i,y:r,uiManager:this.#a,isCentered:!0,...t});a&&this.add(a)}async deserialize(e){return await Lt.#d.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}createAndAddNewEditor(e,t,i={}){const r=this.getNextId(),s=this.#y({parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:t,...i});return s&&this.add(s),s}#m(){const{x:e,y:t,width:i,height:r}=this.div.getBoundingClientRect(),s=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+r),c=(s+o)/2-e,u=(a+l)/2-t,[h,d]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:h,offsetY:d}}addNewEditor(){this.createAndAddNewEditor(this.#m(),!0)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}unselect(e){this.#a.unselect(e)}pointerup(e){const{isMac:t}=Qe.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&this.#l){if(this.#l=!1,!this.#t){this.#t=!0;return}if(this.#a.getMode()===oe.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(this.#a.getMode()===oe.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:t}=Qe.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;this.#l=!0;const i=this.#a.getActive();this.#t=!i||i.isEmpty()}findNewParent(e,t,i){const r=this.#a.findParent(t,i);return r===null||r===this?!1:(r.changeParent(e),!0)}destroy(){this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const e of this.#r.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#r.clear(),this.#a.removeLayer(this)}#g(){this.#c=!0;for(const e of this.#r.values())e.isEmpty()&&e.remove();this.#c=!1}render({viewport:e}){this.viewport=e,cn(this.div,e);for(const t of this.#a.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#a.commitOrRemove(),this.#g();const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,cn(this.div,{rotation:i}),t!==i)for(const r of this.#r.values())r.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#a.viewParameters.realScale}}class $e{#e=null;#t=0;#n=new Map;#i=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(const t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return fe(this,"_svgFactory",new ha)}static#s(e,{x:t=0,y:i=0,width:r=1,height:s=1}={}){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*r}%`,a.height=`${100*s}%`}#r(e){const t=$e._svgFactory.create(1,1,!0);return this.#e.append(t),t.setAttribute("aria-hidden",!0),$e.#s(t,e),t}#l(e,t){const i=$e._svgFactory.createElement("clipPath");e.append(i);const r=`clip_${t}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const s=$e._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),r}draw(e,t,i,r=!1){const s=this.#t++,a=this.#r(e.box);a.classList.add(...e.classNamesForDrawing);const o=$e._svgFactory.createElement("defs");a.append(o);const l=$e._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",c),l.setAttribute("d",e.toSVGPath()),r&&this.#i.set(s,l);const u=this.#l(o,c),h=$e._svgFactory.createElement("use");return a.append(h),a.setAttribute("fill",t),a.setAttribute("fill-opacity",i),h.setAttribute("href",`#${c}`),this.#n.set(s,a),{id:s,clipPathId:`url(#${u})`}}drawOutline(e){const t=this.#t++,i=this.#r(e.box);i.classList.add(...e.classNamesForOutlining);const r=$e._svgFactory.createElement("defs");i.append(r);const s=$e._svgFactory.createElement("path");r.append(s);const a=`path_p${this.pageIndex}_${t}`;s.setAttribute("id",a),s.setAttribute("d",e.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let o;if(e.mustRemoveSelfIntersections){const u=$e._svgFactory.createElement("mask");r.append(u),o=`mask_p${this.pageIndex}_${t}`,u.setAttribute("id",o),u.setAttribute("maskUnits","objectBoundingBox");const h=$e._svgFactory.createElement("rect");u.append(h),h.setAttribute("width","1"),h.setAttribute("height","1"),h.setAttribute("fill","white");const d=$e._svgFactory.createElement("use");u.append(d),d.setAttribute("href",`#${a}`),d.setAttribute("stroke","none"),d.setAttribute("fill","black"),d.setAttribute("fill-rule","nonzero"),d.classList.add("mask")}const l=$e._svgFactory.createElement("use");i.append(l),l.setAttribute("href",`#${a}`),o&&l.setAttribute("mask",`url(#${o})`);const c=l.cloneNode();return i.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.#n.set(t,i),t}finalizeLine(e,t){const i=this.#i.get(e);this.#i.delete(e),this.updateBox(e,t.box),i.setAttribute("d",t.toSVGPath())}updateLine(e,t){this.#n.get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}updatePath(e,t){this.#i.get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){$e.#s(this.#n.get(e),t)}show(e,t){this.#n.get(e).classList.toggle("hidden",!t)}rotate(e,t){this.#n.get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){this.#n.get(e).setAttribute("fill",t)}changeOpacity(e,t){this.#n.get(e).setAttribute("fill-opacity",t)}addClass(e,t){this.#n.get(e).classList.add(t)}removeClass(e,t){this.#n.get(e).classList.remove(t)}getSVGRoot(e){return this.#n.get(e)}remove(e){this.#i.delete(e),this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(const e of this.#n.values())e.remove();this.#n.clear(),this.#i.clear()}}var eA=re.AbortException,tA=re.AnnotationEditorLayer,nA=re.AnnotationEditorParamsType,iA=re.AnnotationEditorType,rA=re.AnnotationEditorUIManager,Du=re.AnnotationLayer,Mu=re.AnnotationMode,sA=re.ColorPicker,aA=re.DOMSVGFactory,oA=re.DrawLayer,lA=re.FeatureTest,pa=re.GlobalWorkerOptions,cA=re.ImageKind,uA=re.InvalidPDFException,hA=re.MissingPDFException,dA=re.OPS,fA=re.OutputScale,pA=re.PDFDataRangeTransport,gA=re.PDFDateString,mA=re.PDFWorker,yA=re.PasswordResponses,bA=re.PermissionFlag,xA=re.PixelsPerInch,wA=re.RenderingCancelledException,Fu=re.TextLayer,vA=re.UnexpectedResponseException,AA=re.Util,_A=re.VerbosityLevel,SA=re.XfaLayer,kA=re.build,EA=re.createValidAbsoluteUrl,CA=re.fetchData,Ou=re.getDocument,TA=re.getFilenameFromUrl,PA=re.getPdfFilenameFromUrl,RA=re.getXfaPageViewport,IA=re.isDataScheme,LA=re.isPdfFile,DA=re.noContextMenu,MA=re.normalizeUnicode,FA=re.setLayerDimensions,OA=re.shadow,NA=re.version;const jA=Object.freeze(Object.defineProperty({__proto__:null,AbortException:eA,AnnotationEditorLayer:tA,AnnotationEditorParamsType:nA,AnnotationEditorType:iA,AnnotationEditorUIManager:rA,AnnotationLayer:Du,AnnotationMode:Mu,ColorPicker:sA,DOMSVGFactory:aA,DrawLayer:oA,FeatureTest:lA,GlobalWorkerOptions:pa,ImageKind:cA,InvalidPDFException:uA,MissingPDFException:hA,OPS:dA,OutputScale:fA,PDFDataRangeTransport:pA,PDFDateString:gA,PDFWorker:mA,PasswordResponses:yA,PermissionFlag:bA,PixelsPerInch:xA,RenderingCancelledException:wA,TextLayer:Fu,UnexpectedResponseException:vA,Util:AA,VerbosityLevel:_A,XfaLayer:SA,build:kA,createValidAbsoluteUrl:EA,fetchData:CA,getDocument:Ou,getFilenameFromUrl:TA,getPdfFilenameFromUrl:PA,getXfaPageViewport:RA,isDataScheme:IA,isPdfFile:LA,noContextMenu:DA,normalizeUnicode:MA,setLayerDimensions:FA,shadow:OA,version:NA},Symbol.toStringTag,{value:"Module"}));var je=function(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||Array.prototype.slice.call(e))},zA=["onCopy","onCut","onPaste"],BA=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],HA=["onFocus","onBlur"],UA=["onInput","onInvalid","onReset","onSubmit"],$A=["onLoad","onError"],qA=["onKeyDown","onKeyPress","onKeyUp"],VA=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],WA=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],GA=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],XA=["onSelect"],YA=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],KA=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],QA=["onScroll"],JA=["onWheel"],ZA=["onAnimationStart","onAnimationEnd","onAnimationIteration"],e_=["onTransitionEnd"],t_=["onToggle"],n_=["onChange"],i_=je(je(je(je(je(je(je(je(je(je(je(je(je(je(je(je(je(je([],zA,!0),BA,!0),HA,!0),UA,!0),$A,!0),qA,!0),VA,!0),WA,!0),GA,!0),XA,!0),YA,!0),KA,!0),QA,!0),JA,!0),ZA,!0),e_,!0),n_,!0),t_,!0);function Nu(n,e){var t={};return i_.forEach(function(i){var r=n[i];r&&(e?t[i]=function(s){return r(s,e(i))}:t[i]=r)}),t}function gi(n){var e=!1,t=new Promise(function(i,r){n.then(function(s){return!e&&i(s)}).catch(function(s){return!e&&r(s)})});return{promise:t,cancel:function(){e=!0}}}function ju(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(e=0;e<r;e++)n[e]&&(t=ju(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function ar(){for(var n,e,t=0,i="",r=arguments.length;t<r;t++)(n=arguments[t])&&(e=ju(n))&&(i&&(i+=" "),i+=e);return i}var r_="Invariant failed";function we(n,e){if(!n)throw new Error(r_)}var zr,bl;function s_(){if(bl)return zr;bl=1;var n=function(){};return zr=n,zr}var a_=s_();const qe=Rs(a_);var xl=Object.prototype.hasOwnProperty;function wl(n,e,t){for(t of n.keys())if(Rn(t,e))return t}function Rn(n,e){var t,i,r;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((i=n.length)===e.length)for(;i--&&Rn(n[i],e[i]););return i===-1}if(t===Set){if(n.size!==e.size)return!1;for(i of n)if(r=i,r&&typeof r=="object"&&(r=wl(e,r),!r)||!e.has(r))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(i of n)if(r=i[0],r&&typeof r=="object"&&(r=wl(e,r),!r)||!Rn(i[1],e.get(r)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((i=n.byteLength)===e.byteLength)for(;i--&&n.getInt8(i)===e.getInt8(i););return i===-1}if(ArrayBuffer.isView(n)){if((i=n.byteLength)===e.byteLength)for(;i--&&n[i]===e[i];);return i===-1}if(!t||typeof n=="object"){i=0;for(t in n)if(xl.call(n,t)&&++i&&!xl.call(e,t)||!(t in e)||!Rn(n[t],e[t]))return!1;return Object.keys(e).length===i}}return n!==n&&e!==e}const zu=T.createContext(null);function In({children:n,type:e}){return p.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:n})}const o_="noopener noreferrer nofollow";class l_{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return we(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){we(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{we(this.pdfDocument),we(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{we(Array.isArray(t));const i=t[0];new Promise(r=>{we(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(s=>{r(s)}).catch(()=>{we(!1)}):typeof i=="number"?r(i):we(!1)}).then(r=>{const s=r+1;we(this.pdfViewer),we(s>=1&&s<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:r,pageNumber:s})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;we(this.pdfViewer),we(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,i){e.href=t,e.rel=this.externalLinkRel||o_,e.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const vl={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},or=typeof window<"u",Bu=or&&window.location.protocol==="file:";function c_(n){return typeof n<"u"}function Jt(n){return c_(n)&&n!==null}function u_(n){return typeof n=="string"}function h_(n){return n instanceof ArrayBuffer}function d_(n){return we(or),n instanceof Blob}function Es(n){return u_(n)&&/^data:/.test(n)}function Al(n){we(Es(n));const[e="",t=""]=n.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function f_(){return or&&window.devicePixelRatio||1}const Hu="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function _l(){qe(!Bu,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${Hu}`)}function p_(){qe(!Bu,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${Hu}`)}function hn(n){n?.cancel&&n.cancel()}function Cs(n,e){return Object.defineProperty(n,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function g_(n){return n.name==="RenderingCancelledException"}function m_(n){return new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return t(new Error("Error while reading a file."));e(i.result)},i.onerror=r=>{if(!r.target)return t(new Error("Error while reading a file."));const{error:s}=r.target;if(!s)return t(new Error("Error while reading a file."));switch(s.code){case s.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case s.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case s.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},i.readAsArrayBuffer(n)})}function y_(n,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function Mn(){return T.useReducer(y_,{value:void 0,error:void 0})}var b_=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(i.next(u))}catch(h){a(h)}}function l(u){try{c(i.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):r(u.value).then(o,l)}c((i=i.apply(n,e||[])).next())})},Sl=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};const{PDFDataRangeTransport:x_}=jA,w_=(n,e)=>{switch(e){case vl.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");n(t);break}case vl.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");n(t);break}}};function kl(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const v_=T.forwardRef(function(e,t){var{children:i,className:r,error:s="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:u,loading:h="Loading PDF…",noData:d="No PDF file specified.",onItemClick:f,onLoadError:g,onLoadProgress:m,onLoadSuccess:b,onPassword:y=w_,onSourceError:x,onSourceSuccess:A,options:k,renderMode:E,rotate:_}=e,P=Sl(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[D,O]=Mn(),{value:S,error:R}=D,[I,F]=Mn(),{value:M,error:N}=I,V=T.useRef(new l_),B=T.useRef([]),q=T.useRef(void 0),U=T.useRef(void 0);l&&l!==q.current&&kl(l)&&(qe(!Rn(l,q.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),q.current=l),k&&k!==U.current&&(qe(!Rn(k,U.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),U.current=k);const v=T.useRef({scrollPageIntoView:de=>{const{dest:_e,pageNumber:Te,pageIndex:j=Te-1}=de;if(f){f({dest:_e,pageIndex:j,pageNumber:Te});return}const W=B.current[j];if(W){W.scrollIntoView();return}qe(!1,`An internal link leading to page ${Te} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});T.useImperativeHandle(t,()=>({linkService:V,pages:B,viewer:v}),[]);function G(){A&&A()}function X(){R&&(qe(!1,R.toString()),x&&x(R))}function w(){O({type:"RESET"})}T.useEffect(w,[l,O]);const ne=T.useCallback(()=>b_(this,void 0,void 0,function*(){if(!l)return null;if(typeof l=="string")return Es(l)?{data:Al(l)}:(_l(),{url:l});if(l instanceof x_)return{range:l};if(h_(l))return{data:l};if(or&&d_(l))return{data:yield m_(l)};if(we(typeof l=="object"),we(kl(l)),"url"in l&&typeof l.url=="string"){if(Es(l.url)){const{url:de}=l,_e=Sl(l,["url"]),Te=Al(de);return Object.assign({data:Te},_e)}_l()}return l}),[l]);T.useEffect(()=>{const de=gi(ne());return de.promise.then(_e=>{O({type:"RESOLVE",value:_e})}).catch(_e=>{O({type:"REJECT",error:_e})}),()=>{hn(de)}},[ne,O]),T.useEffect(()=>{if(!(typeof S>"u")){if(S===!1){X();return}G()}},[S]);function $(){M&&(b&&b(M),B.current=new Array(M.numPages),V.current.setDocument(M))}function Q(){N&&(qe(!1,N.toString()),g&&g(N))}T.useEffect(function(){F({type:"RESET"})},[F,S]),T.useEffect(function(){if(!S)return;const _e=k?Object.assign(Object.assign({},S),k):S,Te=Ou(_e);m&&(Te.onProgress=m),y&&(Te.onPassword=y);const j=Te,W=j.promise.then(ye=>{F({type:"RESOLVE",value:ye})}).catch(ye=>{j.destroyed||F({type:"REJECT",error:ye})});return()=>{W.finally(()=>j.destroy())}},[k,F,S]),T.useEffect(()=>{if(!(typeof M>"u")){if(M===!1){Q();return}$()}},[M]),T.useEffect(function(){V.current.setViewer(v.current),V.current.setExternalLinkRel(a),V.current.setExternalLinkTarget(o)},[a,o]);const Y=T.useCallback((de,_e)=>{B.current[de]=_e},[]),Ae=T.useCallback(de=>{delete B.current[de]},[]),Ee=T.useMemo(()=>({imageResourcesPath:u,linkService:V.current,onItemClick:f,pdf:M,registerPage:Y,renderMode:E,rotate:_,unregisterPage:Ae}),[u,f,M,Y,E,_,Ae]),he=T.useMemo(()=>Nu(P,()=>M),[P,M]);function se(){return p.jsx(zu.Provider,{value:Ee,children:i})}function Je(){return l?M==null?p.jsx(In,{type:"loading",children:typeof h=="function"?h():h}):M===!1?p.jsx(In,{type:"error",children:typeof s=="function"?s():s}):se():p.jsx(In,{type:"no-data",children:typeof d=="function"?d():d})}return p.jsx("div",Object.assign({className:ar("react-pdf__Document",r),ref:c,style:{"--scale-factor":"1"}},he,{children:Je()}))});function Uu(){return T.useContext(zu)}function $u(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.filter(Boolean);if(t.length<=1){var i=t[0];return i||null}return function(s){t.forEach(function(a){typeof a=="function"?a(s):a&&(a.current=s)})}}const qu=T.createContext(null),Vu={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},A_=/^H(\d+)$/;function __(n){return n in Vu}function lr(n){return"children"in n}function Wu(n){return lr(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function S_(n){const e={};if(lr(n)){const{role:t}=n,i=t.match(A_);if(i)e.role="heading",e["aria-level"]=Number(i[1]);else if(__(t)){const r=Vu[t];r&&(e.role=r)}}return e}function Gu(n){const e={};if(lr(n)){if(n.alt!==void 0&&(e["aria-label"]=n.alt),n.lang!==void 0&&(e.lang=n.lang),Wu(n)){const[t]=n.children;if(t){const i=Gu(t);return Object.assign(Object.assign({},e),i)}}}else"id"in n&&(e["aria-owns"]=n.id);return e}function k_(n){return n?Object.assign(Object.assign({},S_(n)),Gu(n)):null}function Xu({className:n,node:e}){const t=T.useMemo(()=>k_(e),[e]),i=T.useMemo(()=>!lr(e)||Wu(e)?null:e.children.map((r,s)=>p.jsx(Xu,{node:r},s)),[e]);return p.jsx("span",Object.assign({className:n},t,{children:i}))}function cr(){return T.useContext(qu)}function E_(){const n=cr();we(n);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=n,[i,r]=Mn(),{value:s,error:a}=i,{customTextRenderer:o,page:l}=n;function c(){s&&t&&t(s)}function u(){a&&(qe(!1,a.toString()),e&&e(a))}return T.useEffect(function(){r({type:"RESET"})},[r,l]),T.useEffect(function(){if(o||!l)return;const d=gi(l.getStructTree()),f=d;return d.promise.then(g=>{r({type:"RESOLVE",value:g})}).catch(g=>{r({type:"REJECT",error:g})}),()=>hn(f)},[o,l,r]),T.useEffect(()=>{if(s!==void 0){if(s===!1){u();return}c()}},[s]),s?p.jsx(Xu,{className:"react-pdf__Page__structTree structTree",node:s}):null}const El=Mu;function C_(n){const e=cr();we(e);const t=Object.assign(Object.assign({},e),n),{_className:i,canvasBackground:r,devicePixelRatio:s=f_(),onRenderError:a,onRenderSuccess:o,page:l,renderForms:c,renderTextLayer:u,rotate:h,scale:d}=t,{canvasRef:f}=n;we(l);const g=T.useRef(null);function m(){l&&o&&o(Cs(l,d))}function b(k){g_(k)||(qe(!1,k.toString()),a&&a(k))}const y=T.useMemo(()=>l.getViewport({scale:d*s,rotation:h}),[s,l,h,d]),x=T.useMemo(()=>l.getViewport({scale:d,rotation:h}),[l,h,d]);T.useEffect(function(){if(!l)return;l.cleanup();const{current:E}=g;if(!E)return;E.width=y.width,E.height=y.height,E.style.width=`${Math.floor(x.width)}px`,E.style.height=`${Math.floor(x.height)}px`,E.style.visibility="hidden";const _={annotationMode:c?El.ENABLE_FORMS:El.ENABLE,canvasContext:E.getContext("2d",{alpha:!1}),viewport:y};r&&(_.background=r);const P=l.render(_),D=P;return P.promise.then(()=>{E.style.visibility="",m()}).catch(b),()=>hn(D)},[r,l,c,y,x]);const A=T.useCallback(()=>{const{current:k}=g;k&&(k.width=0,k.height=0)},[]);return T.useEffect(()=>A,[A]),p.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:$u(f,g),style:{display:"block",userSelect:"none"},children:u?p.jsx(E_,{}):null})}function T_(n){return"str"in n}function P_(){const n=cr();we(n);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:i,onRenderTextLayerError:r,onRenderTextLayerSuccess:s,page:a,pageIndex:o,pageNumber:l,rotate:c,scale:u}=n;we(a);const[h,d]=Mn(),{value:f,error:g}=h,m=T.useRef(null);qe(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function b(){f&&i&&i(f)}function y(){g&&(qe(!1,g.toString()),t&&t(g))}T.useEffect(function(){d({type:"RESET"})},[a,d]),T.useEffect(function(){if(!a)return;const D=gi(a.getTextContent()),O=D;return D.promise.then(S=>{d({type:"RESOLVE",value:S})}).catch(S=>{d({type:"REJECT",error:S})}),()=>hn(O)},[a,d]),T.useEffect(()=>{if(f!==void 0){if(f===!1){y();return}b()}},[f]);const x=T.useCallback(()=>{s&&s()},[s]),A=T.useCallback(P=>{qe(!1,P.toString()),r&&r(P)},[r]);function k(){const P=m.current;P&&P.classList.add("selecting")}function E(){const P=m.current;P&&P.classList.remove("selecting")}const _=T.useMemo(()=>a.getViewport({scale:u,rotation:c}),[a,c,u]);return T.useLayoutEffect(function(){if(!a||!f)return;const{current:D}=m;if(!D)return;D.innerHTML="";const O=a.streamTextContent({includeMarkedContent:!0}),S={container:D,textContentSource:O,viewport:_},R=new Fu(S),I=R;return R.render().then(()=>{const F=document.createElement("div");F.className="endOfContent",D.append(F);const M=D.querySelectorAll('[role="presentation"]');if(e){let N=0;f.items.forEach((V,B)=>{if(!T_(V))return;const q=M[N];if(!q)return;const U=e(Object.assign({pageIndex:o,pageNumber:l,itemIndex:B},V));q.innerHTML=U,N+=V.str&&V.hasEOL?2:1})}x()}).catch(A),()=>hn(I)},[e,A,x,a,o,l,f,_]),p.jsx("div",{className:ar("react-pdf__Page__textContent","textLayer"),onMouseUp:E,onMouseDown:k,ref:m})}function R_(){const n=Uu(),e=cr();we(e);const t=Object.assign(Object.assign({},n),e),{imageResourcesPath:i,linkService:r,onGetAnnotationsError:s,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:l,page:c,pdf:u,renderForms:h,rotate:d,scale:f=1}=t;we(u),we(c),we(r);const[g,m]=Mn(),{value:b,error:y}=g,x=T.useRef(null);qe(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function A(){b&&a&&a(b)}function k(){y&&(qe(!1,y.toString()),s&&s(y))}T.useEffect(function(){m({type:"RESET"})},[m,c]),T.useEffect(function(){if(!c)return;const O=gi(c.getAnnotations()),S=O;return O.promise.then(R=>{m({type:"RESOLVE",value:R})}).catch(R=>{m({type:"REJECT",error:R})}),()=>{hn(S)}},[m,c]),T.useEffect(()=>{if(b!==void 0){if(b===!1){k();return}A()}},[b]);function E(){l&&l()}function _(D){qe(!1,`${D}`),o&&o(D)}const P=T.useMemo(()=>c.getViewport({scale:f,rotation:d}),[c,d,f]);return T.useEffect(function(){if(!u||!c||!r||!b)return;const{current:O}=x;if(!O)return;const S=P.clone({dontFlip:!0}),R={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:O,l10n:null,page:c,structTreeLayer:null,viewport:S},I={annotations:b,annotationStorage:u.annotationStorage,div:O,imageResourcesPath:i,linkService:r,page:c,renderForms:h,viewport:S};O.innerHTML="";try{new Du(R).render(I),E()}catch(F){_(F)}return()=>{}},[b,i,r,c,u,h,P]),p.jsx("div",{className:ar("react-pdf__Page__annotations","annotationLayer"),ref:x})}var I_=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};const Cl=1;function L_(n){const e=Uu(),t=Object.assign(Object.assign({},e),n),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:r=!0,canvasBackground:s,canvasRef:a,children:o,className:l,customRenderer:c,customTextRenderer:u,devicePixelRatio:h,error:d="Failed to load the page.",height:f,inputRef:g,loading:m="Loading page…",noData:b="No page specified.",onGetAnnotationsError:y,onGetAnnotationsSuccess:x,onGetStructTreeError:A,onGetStructTreeSuccess:k,onGetTextError:E,onGetTextSuccess:_,onLoadError:P,onLoadSuccess:D,onRenderAnnotationLayerError:O,onRenderAnnotationLayerSuccess:S,onRenderError:R,onRenderSuccess:I,onRenderTextLayerError:F,onRenderTextLayerSuccess:M,pageIndex:N,pageNumber:V,pdf:B,registerPage:q,renderAnnotationLayer:U=!0,renderForms:v=!1,renderMode:G="canvas",renderTextLayer:X=!0,rotate:w,scale:ne=Cl,unregisterPage:$,width:Q}=t,Y=I_(t,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Ae,Ee]=Mn(),{value:he,error:se}=Ae,Je=T.useRef(null);we(B);const de=Jt(V)?V-1:N??null,_e=V??(Jt(N)?N+1:null),Te=w??(he?he.rotate:null),j=T.useMemo(()=>{if(!he)return null;let H=1;const Z=ne??Cl;if(Q||f){const le=he.getViewport({scale:1,rotation:Te});Q?H=Q/le.width:f&&(H=f/le.height)}return Z*H},[f,he,Te,ne,Q]);T.useEffect(function(){return()=>{Jt(de)&&r&&$&&$(de)}},[r,B,de,$]);function W(){if(D){if(!he||!j)return;D(Cs(he,j))}if(r&&q){if(!Jt(de)||!Je.current)return;q(de,Je.current)}}function ye(){se&&(qe(!1,se.toString()),P&&P(se))}T.useEffect(function(){Ee({type:"RESET"})},[Ee,B,de]),T.useEffect(function(){if(!B||!_e)return;const Z=gi(B.getPage(_e)),le=Z;return Z.promise.then(me=>{Ee({type:"RESOLVE",value:me})}).catch(me=>{Ee({type:"REJECT",error:me})}),()=>hn(le)},[Ee,B,_e]),T.useEffect(()=>{if(he!==void 0){if(he===!1){ye();return}W()}},[he,j]);const be=T.useMemo(()=>he&&Jt(de)&&_e&&Jt(Te)&&Jt(j)?{_className:i,canvasBackground:s,customTextRenderer:u,devicePixelRatio:h,onGetAnnotationsError:y,onGetAnnotationsSuccess:x,onGetStructTreeError:A,onGetStructTreeSuccess:k,onGetTextError:E,onGetTextSuccess:_,onRenderAnnotationLayerError:O,onRenderAnnotationLayerSuccess:S,onRenderError:R,onRenderSuccess:I,onRenderTextLayerError:F,onRenderTextLayerSuccess:M,page:he,pageIndex:de,pageNumber:_e,renderForms:v,renderTextLayer:X,rotate:Te,scale:j}:null,[i,s,u,h,y,x,A,k,E,_,O,S,R,I,F,M,he,de,_e,v,X,Te,j]),ge=T.useMemo(()=>Nu(Y,()=>he&&(j?Cs(he,j):void 0)),[Y,he,j]),Me=`${de}@${j}/${Te}`;function ct(){switch(G){case"custom":return we(c),p.jsx(c,{},`${Me}_custom`);case"none":return null;case"canvas":default:return p.jsx(C_,{canvasRef:a},`${Me}_canvas`)}}function Ze(){return X?p.jsx(P_,{},`${Me}_text`):null}function Nn(){return U?p.jsx(R_,{},`${Me}_annotations`):null}function ur(){return p.jsxs(qu.Provider,{value:be,children:[ct(),Ze(),Nn(),o]})}function L(){return _e?B===null||he===void 0||he===null?p.jsx(In,{type:"loading",children:typeof m=="function"?m():m}):B===!1||he===!1?p.jsx(In,{type:"error",children:typeof d=="function"?d():d}):ur():p.jsx(In,{type:"no-data",children:typeof b=="function"?b():b})}return p.jsx("div",Object.assign({className:ar(i,l),"data-page-number":_e,ref:$u(g,Je),style:{"--scale-factor":`${j}`,backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},ge,{children:L()}))}p_();pa.workerSrc="pdf.worker.mjs";pa.workerSrc=new URL("/assets/pdf.worker.min-GB3t0DcA.mjs",import.meta.url).toString();const D_=({pdfPath:n,pageNumber:e,boundingPolygons:t})=>{const i=T.useRef(null),[r,s]=T.useState(null),a=T.useMemo(()=>{try{const u=JSON.parse(t),h=u.filter(d=>{if(d.length<3)return!1;const f=d.map(x=>x.x),g=d.map(x=>x.y),m=Math.max(...f)-Math.min(...f),b=Math.max(...g)-Math.min(...g);return m*b<.4});return h.length===0&&u.length>0?u.map(f=>{const g=f.map(A=>A.x),m=f.map(A=>A.y),b=Math.max(...g)-Math.min(...g),y=Math.max(...m)-Math.min(...m),x=b*y;return{polygon:f,area:x}}).sort((f,g)=>f.area-g.area).slice(0,3).map(f=>f.polygon):h.slice(0,5)}catch(u){return console.error("Failed to parse boundingPolygons:",u),[]}},[t]),o=({width:u,height:h})=>{s({width:u,height:h})},l=T.useCallback((u,h=0)=>{if(r&&i.current){const d=i.current,f=d.getContext("2d");if(f){const g=Math.max(.2,.8-h*.15);f.fillStyle=`rgba(0, 123, 255, ${g})`,f.strokeStyle="rgba(0, 123, 255, 0.8)",f.lineWidth=2,f.beginPath();const m=d.width/r.width,b=d.height/r.height;u.forEach((y,x)=>{const A=y.x*m*74,k=y.y*b*72;x===0?f.moveTo(A,k):f.lineTo(A,k)}),f.closePath(),f.fill(),f.stroke()}}},[r]),c=T.useCallback(()=>{if(!i.current||!r)return;const u=i.current,h=u.getContext("2d");h&&(h.clearRect(0,0,u.width,u.height),requestAnimationFrame(()=>{a.forEach((d,f)=>{l(d,f)})}))},[i,r,a,l]);return T.useEffect(()=>{c()},[c,r,a]),T.useEffect(()=>{const u=()=>{if(i.current&&r){const h=i.current.parentElement;if(h){const{width:d,height:f}=h.getBoundingClientRect();i.current.style.width=`${d}px`,i.current.style.height=`${f}px`,c()}}};return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[c,r]),p.jsx("div",{className:"pdf-highlighter",children:p.jsxs("div",{className:"pdf-highlighter-inner",children:[p.jsx(v_,{file:n,children:p.jsx(L_,{renderTextLayer:!1,pageNumber:e,renderAnnotationLayer:!1,onLoadSuccess:o})}),r&&p.jsx("canvas",{ref:i,width:r.width,height:r.height,className:"pdf-overlay"})]})})},Yu=({show:n,toggle:e,citation:t})=>{const[i,r]=T.useState("");return T.useEffect(()=>{t.is_image||Sp(t.title).then(s=>{r(s)})},[t]),p.jsxs(Li,{size:"medium",position:"end",separator:!0,open:n,onOpenChange:e,className:"citation-drawer",children:[p.jsx(Rl,{children:p.jsx(Il,{action:p.jsx(xe,{appearance:"subtle","aria-label":"Close",icon:p.jsx(Ll,{}),onClick:e}),children:t.is_image?"Image Citation":"Citation"})}),p.jsx(Dl,{children:p.jsx("div",{className:"citation-content",children:t.is_image&&t.image_url?p.jsxs("div",{className:"image-citation-container",children:[p.jsx("img",{src:t.image_url,alt:t.title||"Citation image",style:{maxWidth:"100%",height:"auto",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},onError:s=>{console.error("Failed to load image:",t.image_url),s.target.style.display="none"}}),p.jsxs("div",{style:{marginTop:"12px",fontSize:"14px",color:"#666"},children:[p.jsx("strong",{children:"Source:"})," ",t.title]}),t.locationMetadata?.pageNumber&&p.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:[p.jsx("strong",{children:"Page:"})," ",t.locationMetadata.pageNumber]})]}):t.is_image?p.jsxs("div",{className:"image-citation-fallback",children:[p.jsxs("p",{style:{color:"#999",fontStyle:"italic"},children:["Image citation: ",t.title]}),p.jsx("p",{style:{color:"#666",fontSize:"14px"},children:"Image preview unavailable"})]}):p.jsxs(p.Fragment,{children:[t.show_image&&t.image_url&&p.jsxs("div",{className:"linked-image-container",style:{marginBottom:"16px"},children:[p.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:"600",color:"#333"},children:"Referenced Figure:"}),p.jsx("img",{src:t.image_url,alt:`Figure referenced in ${t.title}`,style:{maxWidth:"100%",height:"auto",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid #e0e0e0"},onError:s=>{console.error("Failed to load linked image:",t.image_url),s.target.style.display="none"}})]}),i&&p.jsx(D_,{pdfPath:i,pageNumber:t.locationMetadata?.pageNumber||1,boundingPolygons:t.locationMetadata?.boundingPolygons}),t.text?p.jsx("p",{children:t.text}):null]})})}),p.jsx(Lh,{children:p.jsx(xe,{appearance:"primary",onClick:e,children:"Close"})})]})},M_=({imageCitations:n,textCitations:e,highlightedCitation:t})=>{const[i,r]=Mt.useState(!1),[s,a]=Mt.useState(),o=(l,c)=>c?c.length<=l?c:c.substring(0,l)+"...":"";return p.jsxs(p.Fragment,{children:[p.jsx("div",{children:!!(e.length||n.length)&&p.jsxs(p.Fragment,{children:[p.jsx(Dh,{className:"citations-title",block:!0,children:"Citations"}),p.jsxs("div",{className:"citations",children:[!!e.length&&e.map((l,c)=>p.jsx(Aa,{className:"citation-interaction",appearance:t===`${l.content_id}`?"brand":"filled",children:p.jsx(_a,{secondaryText:`Page ${l.locationMetadata?.pageNumber||1}${l.show_image?" • Contains Figure":""}`,onClick:()=>{r(!0),a(l)},icon:l.show_image?p.jsx(Mh,{}):p.jsx(Fh,{}),children:o(40,l.text||l.title)})},c)),!!n.length&&n.map((l,c)=>p.jsx(Aa,{className:"citation-interaction",appearance:t===`${l.content_id}`?"brand":"filled",children:p.jsx(_a,{secondaryText:l.is_image?`Image - Page ${l.locationMetadata?.pageNumber||1}`:`Page ${l.locationMetadata?.pageNumber||1}`,onClick:()=>{r(!0),a(l)},icon:p.jsx(Oh,{className:"citation-image-icon"}),children:o(40,l.title)})},c))]})]})}),s&&p.jsx(Yu,{show:i,toggle:()=>r(!1),citation:s,onClose:()=>r(!1)})]})},F_=({processingStepMsg:n,darkMode:e=!1})=>{const[t,i]=Mt.useState();return p.jsx(p.Fragment,{children:p.jsxs(Di,{children:[p.jsx("div",{className:"timeline-container",children:Object.keys(n).map(r=>p.jsxs(p.Fragment,{children:[p.jsxs("a",{children:["Request: ",r]}),n[r]?.map((s,a)=>p.jsxs("div",{className:"timeline-item",children:[p.jsx("div",{className:"timeline-icon",children:a+1}),p.jsxs("div",{className:"timeline-content",children:[p.jsxs("div",{className:"timeline-section-title",children:[p.jsx(Nh,{children:s.processingStep.title}),s.processingStep.type!==ps.Text&&p.jsx(Sa,{disableButtonEnhancement:!0,children:p.jsx(xe,{appearance:"subtle",icon:p.jsx(jh,{}),onClick:()=>i(JSON.stringify(s.processingStep.content,null,2))})})]}),s.processingStep.type===ps.Text?p.jsx(Bt,{block:!0,children:s.processingStep.content}):p.jsxs(p.Fragment,{children:[p.jsx(ka,{className:"content-editor",height:"200px",defaultLanguage:"json",defaultValue:JSON.stringify(s.processingStep.content,null,2),theme:e?"vs-dark":"vs"}),Array.isArray(s.processingStep.content)&&p.jsxs("div",{className:"image-container",children:[p.jsx(zh,{className:"image-title",children:"Images passed to LLM"})," ",p.jsx("br",{}),p.jsx("div",{className:"image-grid",children:s.processingStep.content.flatMap(o=>o.content).filter(o=>o?.type==="image_url").map(o=>p.jsx("img",{className:"image-item",src:o.image_url.url,alt:"Filtered"},o.image_url.url)).length>0?s.processingStep.content.flatMap(o=>o.content).filter(o=>o?.type==="image_url").map(o=>p.jsx("img",{className:"image-item",src:o.image_url.url,alt:"Filtered"},o.image_url.url)):p.jsx(Xe,{children:"None"})})]})]})]})]},a))]}))}),p.jsx(Mi,{className:"editor-dialog",children:p.jsxs(Fi,{children:[p.jsx(Oi,{children:p.jsx(ka,{height:"700px",defaultLanguage:"json",defaultValue:t||"",theme:e?"vs-dark":"vs"})}),p.jsx(Ni,{children:p.jsx(Sa,{disableButtonEnhancement:!0,children:p.jsx(xe,{appearance:"secondary",children:"Close"})})})]})})]})})},O_=({processingStepMsg:n,showProcessingSteps:e,toggleEditor:t,darkMode:i=!1})=>p.jsxs(Li,{size:"medium",position:"end",separator:!0,open:e,onOpenChange:t,children:[p.jsx(Rl,{children:p.jsx(Il,{action:p.jsx(xe,{appearance:"subtle","aria-label":"Close",icon:p.jsx(Ll,{}),onClick:t}),children:"Processing Steps"})}),p.jsx(Dl,{children:p.jsx(F_,{processingStepMsg:n,darkMode:i})})]}),N_=({thread:n,processingStepMsg:e,darkMode:t=!1})=>{const[i,r]=T.useState(!1),[s,a]=T.useState(""),[o,l]=T.useState(),[c,u]=T.useState(!1),[h,d]=T.useState(),[f,g]=T.useState(new Set),[m,b]=T.useState(new Set),[y,x]=T.useState(new Set),[A,k]=T.useState(!1),E=T.useRef(null),_={};T.useEffect(()=>{E.current&&E.current.scrollTo({top:E.current.scrollHeight,behavior:"smooth"})},[n]),T.useEffect(()=>{if(n.length>0){const U=n[n.length-1];if(U&&U.role===an.Assistant&&U.type===He.Answer){k(!0);const v=setTimeout(()=>k(!1),1e3);return()=>clearTimeout(v)}}},[n]);const P=Object.values(n.reduce((U,v)=>(U[v.request_id]||(U[v.request_id]=[]),U[v.request_id]?.push(v),U),{})),D=/\[([^\]]+)\]/g,O=T.useRef(new Map),S=T.useRef(1);T.useEffect(()=>{n.length===0&&(O.current=new Map,S.current=1)},[n.length]);const R=(U,v)=>G=>{const X=[...U,...v],w=ne=>{const $=X.find(Q=>Q.content_id===ne);$&&(d($),u(!0))};return Mt.Children.map(G,ne=>typeof ne=="string"?ne.split(D).map(($,Q)=>{if(Q%2===0)return $;if(Q%2===1){let Y=O.current.get($);return Y||(Y=S.current,O.current.set($,Y),S.current++),p.jsx("span",{onMouseLeave:()=>l(void 0),onMouseEnter:()=>l($),onClick:()=>w($),className:"citation-link",style:{cursor:"pointer"},children:p.jsx(ni,{size:"tiny",color:"brand",appearance:"tint",className:"citation-badge-modern",children:Y})},`${$}-${Q}`)}return null}):ne)},I=U=>{console.log("DEBUG: Looking for processing steps for message:",U.request_id),console.log("DEBUG: Available processing step keys:",Object.keys(e));const v=e?.[U.request_id];if(v&&v.length>0)return console.log("DEBUG: Found exact match for",U.request_id),v;const G=parseInt(U.request_id);if(!isNaN(G)){for(const[w,ne]of Object.entries(e))if(ne&&ne.length>0){const $=parseInt(w);if(!isNaN($)){const Q=Math.abs(G-$);if(console.log(`DEBUG: Comparing ${G} vs ${$}, diff: ${Q}`),Q<3e4)return console.log("DEBUG: Found close timestamp match"),ne}}}const X=Object.keys(e);if(X.length>0){const w=X[X.length-1];if(w&&e[w]&&e[w]?.length>0)return console.log("DEBUG: Using latest processing steps as fallback"),e[w]||null}return console.log("DEBUG: No processing steps found"),null},F=U=>{const v=e[U];if(v&&v.length>0)return{[U]:v};const G=n.find(X=>X.request_id===U);if(G){const X=I(G);if(X)return{[U]:X}}return{[U]:v||[]}},M=U=>{const v=_[U]||"";navigator.clipboard.writeText(v).catch(G=>{console.error("Failed to copy text: ",G)}),g(G=>new Set(G).add(U)),setTimeout(()=>{g(G=>{const X=new Set(G);return X.delete(U),X})},2e3)},N=U=>{b(v=>{const G=new Set(v);return G.has(U)?G.delete(U):(G.add(U),x(X=>{const w=new Set(X);return w.delete(U),w})),G})},V=U=>{x(v=>{const G=new Set(v);return G.has(U)?G.delete(U):(G.add(U),b(X=>{const w=new Set(X);return w.delete(U),w})),G})},B=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),q=U=>U.role===an.User?p.jsx(Kh,{}):U.type===He.Error?p.jsx(Qh,{}):U.type===He.Info?p.jsx(Jh,{}):p.jsx(Zh,{});return p.jsxs("div",{className:"professional-chat-container-modern",children:[p.jsx("div",{className:"chat-workspace-modern",ref:E,children:n.length===0?p.jsxs("div",{className:"empty-state-modern",children:[p.jsx("h2",{children:"Ready to explore your data?"}),p.jsx("p",{children:"Ask me anything about your uploaded documents."})]}):p.jsx("div",{className:"chat-content-modern",children:P.map((U,v)=>{const G=U.filter($=>$.type!==He.Citation),X=U.filter($=>$.type===He.Citation),w=X.length>0?X[0]?.imageCitations||[]:[],ne=X.length>0?X[0]?.textCitations||[]:[];return p.jsx("div",{className:"conversation-group-modern",children:G.map(($,Q)=>{$.type===He.Answer&&(_[$.request_id]=$.answerPartial?.answer||"");const Y=$.role===an.User,Ae=f.has($.request_id),Ee=m.has($.request_id),he=y.has($.request_id);return p.jsxs("div",{className:`message-container-modern ${Y?"user-message-container":"assistant-message-container"}`,children:[p.jsx("div",{className:"message-avatar-modern",children:p.jsx(Bh,{icon:q($),size:40,color:Y?"brand":"colorful",className:`avatar-modern ${Y?"user-avatar":"assistant-avatar"}`})}),p.jsxs("div",{className:"message-content-wrapper-modern",children:[p.jsx("div",{className:"message-header-modern",children:p.jsxs("div",{className:"message-author-info",children:[p.jsx(ie,{weight:"semibold",className:"author-name",children:Y?"You":"AI Assistant"}),p.jsxs("div",{className:"message-meta",children:[p.jsxs(Xe,{className:"timestamp",children:[p.jsx(Hh,{className:"clock-icon"}),B()]}),!Y&&$.type===He.Answer&&p.jsx(ni,{color:"success",appearance:"tint",size:"small",className:"status-badge",children:"AI Response"})]})]})}),p.jsxs(Ut,{className:`message-card-modern ${Y?"user-card":"assistant-card"}`,children:[p.jsxs(rn,{className:"message-body-modern",children:[$.type===He.Message&&p.jsx(Bt,{className:"message-text",children:$.message}),$.type===He.Answer&&p.jsxs("div",{className:"answer-content-modern",style:Y?{color:"white"}:{},children:[p.jsx(jb,{components:{p:({children:se})=>p.jsx(Bt,{className:"markdown-paragraph",style:Y?{color:"white"}:{},children:R(ne,w)(se)}),h1:({children:se})=>p.jsx(en,{className:"markdown-h1",style:Y?{color:"white"}:{},children:se}),h2:({children:se})=>p.jsx(Uh,{className:"markdown-h2",style:Y?{color:"white"}:{},children:se}),h3:({children:se})=>p.jsx(ie,{weight:"semibold",className:"markdown-h3",style:Y?{color:"white"}:{},children:se}),li:({children:se})=>p.jsx(Bt,{className:"markdown-li",style:Y?{color:"white"}:{},children:R(ne,w)(se)}),strong:({children:se})=>p.jsx(ie,{weight:"bold",style:Y?{color:"white"}:{},children:se}),em:({children:se})=>p.jsx(ie,{italic:!0,style:Y?{color:"white"}:{},children:se}),code:({children:se})=>p.jsx("code",{className:"inline-code",children:se}),pre:({children:se})=>p.jsx("pre",{className:"code-block",children:se}),blockquote:({children:se})=>p.jsx("div",{className:"blockquote-modern",children:se})},remarkPlugins:[Qw],children:$.answerPartial?.answer}),w.length>0&&p.jsx("div",{className:"inline-images-container",style:{marginTop:"16px",marginBottom:"12px"},children:p.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px"},children:w.filter(se=>se.image_url).map((se,Je)=>p.jsxs("div",{className:"inline-image-item",style:{maxWidth:"300px",borderRadius:"8px",overflow:"hidden",border:"1px solid var(--colorNeutralStroke2)",backgroundColor:"var(--colorNeutralBackground1)"},children:[p.jsx("img",{src:se.image_url,alt:se.title||"Referenced image",style:{width:"100%",height:"auto",display:"block"},onError:de=>{const _e=de.target;_e.style.display="none"}}),se.title&&p.jsx("div",{style:{padding:"8px"},children:p.jsx(Xe,{style:{color:"var(--colorNeutralForeground2)"},children:se.title})})]},`inline-image-${Je}`))})}),$.answerPartial?.answer&&$.answerPartial.answer.toLowerCase().includes("cannot answer")&&I($)&&p.jsx("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:"var(--colorNeutralBackground3)",borderRadius:"4px",border:"1px solid var(--colorNeutralStroke2)"},children:p.jsx(Xe,{style:{fontStyle:"italic",color:"var(--colorNeutralForeground2)"},children:'💡 Click the "Steps" button below to see what data was retrieved and how the AI processed your query.'})}),A&&Q===U.length-1&&p.jsxs("div",{className:"typing-indicator",children:[p.jsx(kn,{size:"tiny"}),p.jsx(Xe,{children:"Processing..."})]})]}),$.type===He.Error&&p.jsx(ii,{intent:"error",className:"error-message-modern",children:p.jsx(Bt,{children:$.message||"An error occurred."})}),$.type===He.Info&&p.jsx(ii,{intent:"info",className:"info-message-modern",children:p.jsx(Bt,{children:$.message})})]}),$.type===He.Answer&&p.jsx(Hr,{className:"message-footer-modern",children:p.jsx("div",{className:"message-actions-modern",children:p.jsx("div",{className:"feedback-actions",children:p.jsx(Zt,{content:"View processing steps",relationship:"label",children:(()=>{const se=I($),Je=!se;return console.log(`Steps button for ${$.request_id}: hasSteps=${!!se}, disabled=${Je}`),p.jsx(xe,{size:"small",icon:p.jsx($h,{}),appearance:$.answerPartial?.answer&&$.answerPartial.answer.toLowerCase().includes("cannot answer")?"primary":"subtle",className:"action-button",disabled:Je,onClick:()=>{const de=I($);console.log("Steps button clicked for message:",$.request_id),console.log("Found processing steps:",de?de.length:0),r(!0),a($.request_id)},children:"Steps"})})()})})})}),$.type===He.Answer&&(w.length>0||ne.length>0)&&p.jsxs(Hr,{className:"message-footer-modern",children:[p.jsxs("div",{className:"message-actions-modern",children:[p.jsxs("div",{className:"primary-actions",children:[p.jsx(Zt,{content:Ae?"Copied!":"Copy response",relationship:"label",children:p.jsx(xe,{size:"small",icon:Ae?p.jsx(qh,{}):p.jsx(Vh,{}),appearance:"subtle",className:`action-button ${Ae?"copied":""}`,onClick:()=>M($.request_id),children:Ae?"Copied":"Copy"})}),p.jsx(Zt,{content:"Share response",relationship:"label",children:p.jsx(xe,{size:"small",icon:p.jsx(Wh,{}),appearance:"subtle",className:"action-button",children:"Share"})})]}),p.jsxs("div",{className:"feedback-actions",children:[p.jsx(Zt,{content:Ee?"Remove like":"Like response",relationship:"label",children:p.jsx(xe,{size:"small",icon:p.jsx(Gh,{}),appearance:"subtle",className:`feedback-button ${Ee?"liked":""}`,onClick:()=>N($.request_id)})}),p.jsx(Zt,{content:he?"Remove dislike":"Dislike response",relationship:"label",children:p.jsx(xe,{size:"small",icon:p.jsx(Xh,{}),appearance:"subtle",className:`feedback-button ${he?"disliked":""}`,onClick:()=>V($.request_id)})}),p.jsx(Zt,{content:"More options",relationship:"label",children:p.jsx(xe,{size:"small",icon:p.jsx(Yh,{}),appearance:"subtle",className:"action-button"})})]})]}),(w.length>0||ne.length>0)&&p.jsxs(p.Fragment,{children:[p.jsx(Ii,{className:"citations-divider"}),p.jsx("div",{className:"citations-section",children:p.jsx(M_,{imageCitations:w,textCitations:ne,...o&&{highlightedCitation:o}})})]})]})]})]})]},`${v}-${Q}`)})},v)})})}),p.jsx(O_,{showProcessingSteps:i,processingStepMsg:F(s),darkMode:t,toggleEditor:()=>{r(!i)}}),c&&h&&p.jsx(Yu,{citation:h,onClose:()=>{u(!1),d(void 0)},show:!1,toggle:function(){throw new Error("Function not implemented.")}})]})};class Ts extends T.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.props.onError?.(e,t)}handleRetry=()=>{this.setState({hasError:!1,error:void 0})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:p.jsxs(Ut,{style:{padding:"24px",margin:"16px",textAlign:"center"},children:[p.jsx(ed,{style:{color:"var(--colorPaletteRedForeground1)",marginBottom:"16px"}}),p.jsx(en,{style:{marginBottom:"12px"},children:"Something went wrong"}),p.jsx(Bt,{style:{marginBottom:"16px",color:"var(--colorNeutralForeground2)"},children:"We encountered an unexpected error. Please try refreshing the page or contact support if the problem persists."}),!1,p.jsx(xe,{appearance:"primary",icon:p.jsx(td,{}),onClick:this.handleRetry,children:"Try Again"})]}):this.props.children}}const Ku=T.createContext(void 0);function j_({children:n}){const[e,t]=T.useState(()=>{const s=localStorage.getItem("theme");return s?s==="dark":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches});T.useEffect(()=>{localStorage.setItem("theme",e?"dark":"light")},[e]),T.useEffect(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)"),a=o=>{localStorage.getItem("theme")||t(o.matches)};return s.addEventListener("change",a),()=>s.removeEventListener("change",a)},[]);const r={darkMode:e,setDarkMode:t,toggleTheme:()=>{t(!e)}};return p.jsx(Ku.Provider,{value:r,children:n})}function z_(){const n=T.useContext(Ku);if(!n)throw new Error("useTheme must be used within a ThemeProvider");return n}function B_(n){const[e,t]=T.useState(),[i,r]=T.useState([]),[s,a]=T.useState({}),[o,l]=T.useState(),[c,u]=T.useState(!1),h=async()=>{l({})},d=async g=>{u(!0);const m=new Date().getTime().toString();try{e||t(m);const b=i.filter(y=>y.role==="user"||y.role==="assistant").map(y=>({role:y.role,content:[{text:y.role==="assistant"?y.answerPartial?.answer:y.message,type:"text"}]}));r(y=>[...y,{request_id:m,type:He.Message,message:g,role:an.User}]),h(),await Ap(g,m,b,n,y=>{if(y.event==="processing_step")a(x=>{const A=JSON.parse(y.data),k={...x};return k[A.request_id]=[...x[A.request_id]||[],A],k});else if(y.event==="[END]")u(!1);else{const x=JSON.parse(y.data);x.type=y.event,r(A=>{const k=A.findIndex(_=>_.message_id===x.message_id),E=k!==-1?[...A]:[...A,x];return k!==-1&&(E[k]=x),E.sort((_,P)=>new Date(_.request_id).getTime()-new Date(P.request_id).getTime()),h(),E})}},y=>{console.error("Chat stream error:",y);const x=y instanceof Error?y.message:"Chat request failed",A=x.includes("timed out")||x.includes("timeout");r(k=>[...k,{request_id:m,type:He.Error,message:A?"Request timed out. Large documents may need more time to process. Please try again or contact support.":"Chat request failed. Please try again.",role:an.Assistant}]),u(!1)})}catch(b){console.error("Chat error:",b);const y=b instanceof Error?b.message:"An unexpected error occurred",x=y.includes("timed out")||y.includes("timeout");r(A=>[...A,{request_id:m,type:He.Error,message:x?"Request timed out. Large documents may need more time to process. Please try again or contact support.":"An unexpected error occurred. Please try again.",role:an.Assistant}])}finally{u(!1)}},f=()=>{t(void 0),r([])};return T.useEffect(()=>{h()},[n]),{chatId:e,thread:i,processingStepsMessage:s,chats:o,isLoading:c,handleQuery:d,onNewChat:f}}function H_(){const[n,e]=T.useState({use_semantic_ranker:!1,chunk_count:10,openai_api_mode:nu.ChatCompletions,use_streaming:!0,use_knowledge_agent:!0,recency_preference_days:90,query_complexity:"medium",preferred_document_types:[],enable_post_processing_boost:!0,additional_filters:[],use_hybrid_search:!1,use_query_rewriting:!1,use_scoring_profile:!0,scoring_profile_name:"freshness_and_type_boost",vector_weight:.5,rrf_k_parameter:60,semantic_ranking_threshold:2,enable_vector_filters:!1,vector_filter_mode:"preFilter",query_rewrite_count:3}),[t,i]=T.useState([]);return T.useEffect(()=>{(async()=>{const s=await _p();i(s)})()},[]),{config:n,setConfig:e,indexes:t}}function U_(){const{config:n,setConfig:e,indexes:t}=H_(),{thread:i,processingStepsMessage:r,chats:s,isLoading:a,handleQuery:o,onNewChat:l}=B_(n),{darkMode:c,setDarkMode:u}=z_(),[h,d]=T.useState(!1),[f,g]=T.useState("chat"),m=b=>{g(b),b==="chat"&&!i.length&&!h&&d(!1)};return p.jsx(nd,{theme:c?id:rd,children:p.jsxs("div",{className:"container",children:[p.jsx(Mf,{darkMode:c,toggleMode:u}),p.jsx(dp,{selectedTab:f,onTabSelect:m}),p.jsx("div",{className:"content-wrapper",children:f==="chat"?p.jsxs(p.Fragment,{children:[p.jsx(ap,{config:n,indexes:t,setConfig:e,onNewChat:l,chats:Object.values(s||{})}),p.jsxs("div",{className:"content",children:[i.length||h?p.jsx(p.Fragment,{children:i.length?p.jsx(N_,{thread:i,processingStepMsg:r,darkMode:c}):null}):p.jsx(p.Fragment,{children:p.jsxs("div",{className:"intro-card",children:[p.jsx(sd,{block:!0,align:"center",children:vp}),p.jsx("br",{}),p.jsx(Xe,{style:{fontWeight:"bold"},block:!0,align:"center",children:"Choose an example to start with..."}),p.jsx(up,{handleQuery:(b,y)=>{y?d(!0):o(b)}})]})}),p.jsx("div",{className:"search-footer",children:p.jsx(hp,{onSearch:o,isLoading:a})})]})]}):f==="upload"?p.jsx(Ts,{children:p.jsx(Ep,{})}):f==="admin"?p.jsx(Ts,{children:p.jsx(Cp,{})}):null})]})})}function $_(){return p.jsx(Ts,{children:p.jsx(j_,{children:p.jsx(U_,{})})})}_t.addDefaultLocale(If);const q_=()=>p.jsx(T.StrictMode,{children:p.jsx($_,{})});Df.createRoot(document.getElementById("root")).render(p.jsx(q_,{}));
//# sourceMappingURL=index-AmOIRRD3.js.map
